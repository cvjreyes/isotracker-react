{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Modal from'react-awesome-modal';import'./uploadProcInst.css';import Alert from'@material-ui/lab/Alert';import Collapse from'@material-ui/core/Collapse';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UploadProcInst=/*#__PURE__*/function(_Component){_inherits(UploadProcInst,_Component);var _super=_createSuper(UploadProcInst);function UploadProcInst(props){var _this;_classCallCheck(this,UploadProcInst);_this=_super.call(this,props);_this.onFileChange=function(event){_this.setState({file:event.target.files[0]});};_this.state={visible:false,file:null,role:_this.props.role,user:_this.props.currentUser,error:false};_this.id=props.id;return _this;}_createClass(UploadProcInst,[{key:\"accept\",value:function(){var _accept=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var file,body,options;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!this.state.file){_context.next=17;break;}if(!(this.id[0]+'.pdf'===this.state.file.name)){_context.next=16;break;}file=new FormData();file.append('file',this.state.file);body={file:this.state.file.name,action:\"accept\",user:this.state.user,role:this.state.role};options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};if(!(this.state.role===\"Process\")){_context.next=11;break;}_context.next=9;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadProc\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\n_this2.setState({file:null,error:false});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/process\",options).then(function(response){_this2.closeModal();_this2.props.update();_this2.props.success();});}).catch(function(error){return console.log(error);});case 9:_context.next=14;break;case 11:if(!(this.state.role===\"Instrument\")){_context.next=14;break;}_context.next=14;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadInst\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\n_this2.setState({file:null,error:false});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrument\",options).then(function(response){_this2.closeModal();_this2.props.update();_this2.props.success();});}).catch(function(error){return console.log(error);});case 14:_context.next=17;break;case 16:this.setState({error:true});case 17:case\"end\":return _context.stop();}}},_callee,this);}));function accept(){return _accept.apply(this,arguments);}return accept;}()},{key:\"deny\",value:function(){var _deny=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this3=this;var file,body,options;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!this.state.file){_context2.next=17;break;}if(!(this.id[0]+'.pdf'===this.state.file.name)){_context2.next=16;break;}file=new FormData();file.append('file',this.state.file);body={file:this.state.file.name,action:\"deny\",user:this.state.user,role:this.state.role};options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};if(!(this.state.role===\"Process\")){_context2.next=11;break;}_context2.next=9;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadProc\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\n_this3.setState({file:null,error:false});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/process\",options).then(function(response){_this3.closeModal();_this3.props.update();_this3.props.success();});}).catch(function(error){return console.log(error);});case 9:_context2.next=14;break;case 11:if(!(this.state.role===\"Instrument\")){_context2.next=14;break;}_context2.next=14;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadInst\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\n_this3.setState({file:null,error:false});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrument\",options).then(function(response){_this3.closeModal();_this3.props.update();_this3.props.success();});}).catch(function(error){return console.log(error);});case 14:_context2.next=17;break;case 16:this.setState({error:true});case 17:case\"end\":return _context2.stop();}}},_callee2,this);}));function deny(){return _deny.apply(this,arguments);}return deny;}()},{key:\"openModal\",value:function openModal(){this.setState({visible:true});}},{key:\"closeModal\",value:function closeModal(){this.setState({visible:false});}},{key:\"render\",value:function render(){var _this4=this;return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"button\",value:\"UPLOAD\",className:\"btn btn-warning\",style:{fontSize:\"12px\",padding:\"2px 5px 2px 5px\",backgroundColor:\"#B0E0E6\",borderColor:\"#B0E0E6\",width:\"100px\",float:\"left\",marginRight:\"5px\"},onClick:function onClick(){return _this4.openModal();}}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Modal,{visible:this.state.visible,width:\"650\",height:\"430\",effect:\"fadeInUp\",onClickAway:function onClickAway(){return _this4.closeModal();},children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this4.closeModal();},style:{marginTop:\"5px\",fontSize:\"16px\",position:\"absolute\",right:\"10px\",backgroundColor:\"transparent\",border:\"None\"},children:\"X\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"popUpP__container\",children:[/*#__PURE__*/_jsx(\"center\",{className:\"popUpP__title\",children:/*#__PURE__*/_jsx(\"h1\",{children:this.id})}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"div\",{class:\"form-group\",children:/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:this.onFileChange,className:\"inputFile__container\",id:\"exampleFormControlFile1\"}),/*#__PURE__*/_jsx(Collapse,{in:this.state.error,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",style:{left:\"180px\",position:\"absolute\"},children:\"The file doesn't match the isometric!\"})})]})})})]}),/*#__PURE__*/_jsx(\"center\",{className:\"popUpP__warning__title\",children:\"***WARNING!*** This action may replace the current appended file. Take appropiate cautions.\"}),/*#__PURE__*/_jsx(\"center\",{className:\"popUpP__warning__subtitle\",children:\"If you are not sure of this action, click cancel and contact your supervisor.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"popUpP__buttons__container\",children:[/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-success\",onClick:function onClick(){return _this4.accept();},style:{marginRight:\"40px\",fontSize:\"16px\",width:\"200px\"},children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-danger\",onClick:function onClick(){return _this4.deny();},style:{marginRight:\"5px\",fontSize:\"16px\",width:\"200px\"},children:\"Deny\"})]})]})})]});}}]);return UploadProcInst;}(Component);export{UploadProcInst as default};","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/src/components/uploadProcInst/uploadProcInst.js"],"names":["React","Component","Modal","Alert","Collapse","UploadProcInst","props","onFileChange","event","setState","file","target","files","state","visible","role","user","currentUser","error","id","name","FormData","append","body","action","options","method","headers","JSON","stringify","fetch","process","env","REACT_APP_SERVER","REACT_APP_NODE_PORT","then","response","closeModal","update","success","catch","console","log","fontSize","padding","backgroundColor","borderColor","width","float","marginRight","openModal","marginTop","position","right","border","left","accept","deny"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Modal from 'react-awesome-modal';\r\nimport './uploadProcInst.css'\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Collapse from '@material-ui/core/Collapse'\r\n\r\nexport default class UploadProcInst extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            visible : false,\r\n            file : null,\r\n            role: this.props.role,\r\n            user: this.props.currentUser,\r\n            error: false\r\n        }\r\n        this.id = props.id;\r\n\r\n    }\r\n   \r\n    onFileChange = event => {\r\n\r\n        this.setState({ file: event.target.files[0]});\r\n    };\r\n\r\n    async accept(){\r\n        if(this.state.file){\r\n            if(this.id[0] + '.pdf' === this.state.file.name){\r\n                const file  = new FormData(); \r\n                file.append('file', this.state.file); \r\n                \r\n                const body = {\r\n                    file: this.state.file.name,\r\n                    action: \"accept\",\r\n                    user: this.state.user,\r\n                    role: this.state.role\r\n                }\r\n    \r\n                const options = {\r\n                    method: \"POST\",\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\"\r\n                    },\r\n                    body: JSON.stringify(body)\r\n                }\r\n\r\n                if(this.state.role === \"Process\"){\r\n                    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadProc\", {\r\n                    // content-type header should not be specified!\r\n                    method: 'POST',\r\n                    body: file,\r\n                    })\r\n                    .then(response => {\r\n                        // Do something with the successful response\r\n                        this.setState({\r\n                            file: null,\r\n                            error: false\r\n                        })\r\n                        fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/process\", options)\r\n                            .then(response => {\r\n        \r\n                                this.closeModal()\r\n                                this.props.update()\r\n                                this.props.success()\r\n                            })            \r\n                            \r\n                    })\r\n                    .catch(error => console.log(error)\r\n                    );\r\n                }else if(this.state.role === \"Instrument\"){\r\n                    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadInst\", {\r\n                        // content-type header should not be specified!\r\n                        method: 'POST',\r\n                        body: file,\r\n                        })\r\n                        .then(response => {\r\n                            // Do something with the successful response\r\n                            this.setState({\r\n                                file: null,\r\n                                error: false\r\n                            })\r\n                            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrument\", options)\r\n                                .then(response => {\r\n            \r\n                                    this.closeModal()\r\n                                    this.props.update()\r\n                                    this.props.success()\r\n                                })            \r\n                                \r\n                        })\r\n                        .catch(error => console.log(error)\r\n                        );\r\n                }\r\n        \r\n                \r\n            }else{\r\n                this.setState({error: true})\r\n            }\r\n            \r\n        }\r\n        \r\n    }\r\n\r\n    async deny(){\r\n        if(this.state.file){\r\n            if(this.id[0] + '.pdf' === this.state.file.name){\r\n                const file  = new FormData(); \r\n                file.append('file', this.state.file); \r\n                \r\n                const body = {\r\n                    file: this.state.file.name,\r\n                    action: \"deny\",\r\n                    user: this.state.user,\r\n                    role: this.state.role\r\n                }\r\n    \r\n                const options = {\r\n                    method: \"POST\",\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\"\r\n                    },\r\n                    body: JSON.stringify(body)\r\n                }\r\n\r\n                if(this.state.role === \"Process\"){\r\n                    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadProc\", {\r\n                    // content-type header should not be specified!\r\n                    method: 'POST',\r\n                    body: file,\r\n                    })\r\n                    .then(response => {\r\n                        // Do something with the successful response\r\n                        this.setState({\r\n                            file: null,\r\n                            error: false\r\n                        })\r\n                        fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/process\", options)\r\n                            .then(response => {\r\n        \r\n                                this.closeModal()\r\n                                this.props.update()\r\n                                this.props.success()\r\n                            })            \r\n                            \r\n                    })\r\n                    .catch(error => console.log(error)\r\n                    );\r\n                }else if(this.state.role === \"Instrument\"){\r\n                    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadInst\", {\r\n                        // content-type header should not be specified!\r\n                        method: 'POST',\r\n                        body: file,\r\n                        })\r\n                        .then(response => {\r\n                            // Do something with the successful response\r\n                            this.setState({\r\n                                file: null,\r\n                                error: false\r\n                            })\r\n                            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrument\", options)\r\n                                .then(response => {\r\n            \r\n                                    this.closeModal()\r\n                                    this.props.update()\r\n                                    this.props.success()\r\n                                })            \r\n                                \r\n                        })\r\n                        .catch(error => console.log(error)\r\n                        );\r\n                }\r\n        \r\n                \r\n            }else{\r\n                this.setState({error: true})\r\n            }\r\n            \r\n        }\r\n    }\r\n\r\n    openModal() {      \r\n        this.setState({\r\n            visible : true,\r\n        });\r\n    }\r\n\r\n    closeModal() {\r\n        this.setState({\r\n            visible : false,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <section>\r\n                <input type=\"button\"  value=\"UPLOAD\" className=\"btn btn-warning\"  style={{fontSize:\"12px\", padding:\"2px 5px 2px 5px\", backgroundColor:\"#B0E0E6\", borderColor:\"#B0E0E6\", width:\"100px\", float:\"left\", marginRight:\"5px\"}} onClick={() => this.openModal()} />\r\n                <div>\r\n                    <Modal visible={this.state.visible} width=\"650\" height=\"430\" effect=\"fadeInUp\" onClickAway={() => this.closeModal()}>\r\n                    <button onClick={() => this.closeModal()} style={{marginTop:\"5px\", fontSize:\"16px\", position:\"absolute\", right:\"10px\", backgroundColor:\"transparent\", border:\"None\"}}>X</button>\r\n\r\n                        <div className=\"popUpP__container\" >\r\n\r\n                            <center className=\"popUpP__title\"><h1>{this.id}</h1></center>\r\n                            <form>\r\n                                <div class=\"form-group\">\r\n                                    <center>\r\n                                        <input type=\"file\" onChange={this.onFileChange} className=\"inputFile__container\" id=\"exampleFormControlFile1\"></input>\r\n                                        <Collapse in={this.state.error}>\r\n                                            <Alert severity=\"error\" style={{left: \"180px\",position: \"absolute\"}}\r\n                                            >\r\n                                            The file doesn't match the isometric!\r\n\r\n                                            </Alert>\r\n                                        </Collapse>\r\n                                    </center>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                        <center className=\"popUpP__warning__title\">***WARNING!*** This action may replace the current appended file. Take appropiate cautions.</center>\r\n                        <center className=\"popUpP__warning__subtitle\">If you are not sure of this action, click cancel and contact your supervisor.</center>\r\n                        <div className=\"popUpP__buttons__container\">\r\n                            <button class=\"btn btn-sm btn-success\" onClick={() => this.accept()} style={{marginRight:\"40px\", fontSize:\"16px\", width:\"200px\"}}>Accept</button>\r\n                            <button class=\"btn btn-sm btn-danger\" onClick={() => this.deny()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"200px\"}}>Deny</button>\r\n                        </div>\r\n                    </Modal>\r\n                </div>\r\n            </section>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}