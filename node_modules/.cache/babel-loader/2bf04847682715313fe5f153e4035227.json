{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import'./changePassword.css';import TechnipLogo from\"../../assets/images/technip.png\";import IsoTrackerLogo from\"../../assets/images/IsoTracker.svg\";import FullTrackerLogo from\"../../assets/images/3dtracker.png\";import Eye from\"../../assets/images/eye.png\";import GreenCircle from\"../../assets/images/green_circle.png\";import BlueCircle from\"../../assets/images/blue_circle.png\";import{useHistory}from\"react-router\";import AlertF from\"../../components/alert/alert\";//Página de home con el menú para ir a las aplicaciones de isotracker\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CryptoJS=require(\"crypto-js\");var SecureStorage=require(\"secure-web-storage\");var SECRET_KEY='sanud2ha8shd72h';var secureStorage=new SecureStorage(localStorage,{hash:function hash(key){key=CryptoJS.SHA256(key,SECRET_KEY);return key.toString();},encrypt:function encrypt(data){data=CryptoJS.AES.encrypt(data,SECRET_KEY);data=data.toString();return data;},decrypt:function decrypt(data){data=CryptoJS.AES.decrypt(data,SECRET_KEY);data=data.toString(CryptoJS.enc.Utf8);return data;}});var ChangePasswordPage=function ChangePasswordPage(){document.title=process.env.REACT_APP_APP_NAMEPROJ;document.body.style.zoom=0.8;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),password=_useState2[0],setPassword=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),newPassword=_useState4[0],setNewPassword=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),confPassword=_useState6[0],setConfPassword=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),passwordShown1=_useState8[0],setPasswordShown1=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),passwordShown2=_useState10[0],setPasswordShown2=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),passwordShown3=_useState12[0],setPasswordShown3=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),blankError=_useState14[0],setBlankError=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),wrongPassError=_useState16[0],setWrongPassError=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),notCoincideError=_useState18[0],setNotCoincideError=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),successful=_useState20[0],setSuccessful=_useState20[1];var history=useHistory();var handelChangePassword=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var body,options;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setWrongPassError(false);setBlankError(false);setConfPassword(false);body={email:secureStorage.getItem('user'),password:password};options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};if(!(password===null||newPassword===null||confPassword===null||password===\"\"||newPassword===\"\"||confPassword===\"\")){_context3.next=9;break;}setBlankError(true);_context3.next=11;break;case 9:_context3.next=11;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/api/user/getPassword\",options).then(function(response){return response.json();}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(json){var _body,_options;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(json.password===\"incorrect\")){_context2.next=4;break;}setWrongPassError(true);_context2.next=12;break;case 4:if(!(newPassword===confPassword)){_context2.next=11;break;}_body={email:secureStorage.getItem('user'),newPassword:newPassword};_options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(_body)};_context2.next=9;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/user/changePassword\",_options).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setSuccessful(true);case 2:_context.next=4;return localStorage.clear();case 4:setTimeout(function(){history.replace(\"/\"+process.env.REACT_APP_PROJECT+\"/\");},2000);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref3.apply(this,arguments);};}()).catch(function(err){return console.log(err);});case 9:_context2.next=12;break;case 11:setNotCoincideError(true);case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}());case 11:case\"end\":return _context3.stop();}}},_callee3);}));return function handelChangePassword(){return _ref.apply(this,arguments);};}();var togglePassword1=function togglePassword1(){setPasswordShown1(!passwordShown1);};var togglePassword2=function togglePassword2(){setPasswordShown2(!passwordShown2);};var togglePassword3=function togglePassword3(){setPasswordShown3(!passwordShown3);};var cancel=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:history.goBack();case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function cancel(){return _ref4.apply(this,arguments);};}();var logo=null;if(process.env.REACT_APP_PROGRESS===\"0\"){logo=IsoTrackerLogo;}else{logo=FullTrackerLogo;}return/*#__PURE__*/_jsxs(\"body\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success \".concat(blankError?'alert-shown':'alert-hidden'),onTransitionEnd:function onTransitionEnd(){return setBlankError(false);},children:/*#__PURE__*/_jsx(AlertF,{type:\"error\",subtext:\"At least one field is blank!\",change:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success \".concat(wrongPassError?'alert-shown':'alert-hidden'),onTransitionEnd:function onTransitionEnd(){return setWrongPassError(false);},children:/*#__PURE__*/_jsx(AlertF,{type:\"error\",subtext:\"The current password is not correct!\",change:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success \".concat(notCoincideError?'alert-shown':'alert-hidden'),onTransitionEnd:function onTransitionEnd(){return setNotCoincideError(false);},children:/*#__PURE__*/_jsx(AlertF,{type:\"error\",subtext:\"The passwords don't match!\",change:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success \".concat(successful?'alert-shown':'alert-hidden'),onTransitionEnd:function onTransitionEnd(){return setSuccessful(false);},children:/*#__PURE__*/_jsx(AlertF,{type:\"success\",change:true,text:\"Password changed successfully!\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"background\",children:[/*#__PURE__*/_jsx(\"img\",{src:TechnipLogo,alt:\"technipLogo\",className:\"technipLogo__image\"}),/*#__PURE__*/_jsx(\"img\",{src:GreenCircle,alt:\"greenCircle\",className:\"greenCircle__image\"}),/*#__PURE__*/_jsx(\"img\",{src:BlueCircle,alt:\"blueCircle\",className:\"blueCircle__image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"login__form\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"isoTrackerLogo\",className:\"isoTrackerLogo__image\"}),/*#__PURE__*/_jsx(\"text\",{className:\"welcome__text\",style:{width:\"250px\"},children:\"Change password\"}),/*#__PURE__*/_jsx(\"text\",{className:\"enter__text\",children:\"Please, enter your current password, current password confirmation and new password.\"}),/*#__PURE__*/_jsx(\"text\",{className:\"email__label\",style:{width:\"120px\"},children:\"Current password\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"current__password__input\",type:passwordShown1?\"text\":\"password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"img\",{onClick:togglePassword1,src:Eye,alt:\"eye\",className:\"current__password__eye__image\"})]}),/*#__PURE__*/_jsx(\"text\",{className:\"password__label\",style:{width:\"220px\"},children:\"New password\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"conf__password__input\",type:passwordShown2?\"text\":\"password\",onChange:function onChange(e){return setConfPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"img\",{onClick:togglePassword2,src:Eye,alt:\"eye\",className:\"conf__password__eye__image\"})]}),/*#__PURE__*/_jsx(\"text\",{className:\"new__password__label\",style:{width:\"160px\"},children:\"Confirm new password\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"new__password__input\",type:passwordShown3?\"text\":\"password\",onChange:function onChange(e){return setNewPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"img\",{onClick:togglePassword3,src:Eye,alt:\"eye\",className:\"new__password__eye__image\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login__buttons\",style:{top:\"420px\"},children:[/*#__PURE__*/_jsx(\"button\",{className:\"login__button\",onClick:handelChangePassword,children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel__button\",onClick:cancel,children:\"Cancel\"})]})]})]})]});};export default ChangePasswordPage;","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/src/pages/changePassword/changePassword.js"],"names":["React","useState","TechnipLogo","FullTrackerLogo","Eye","GreenCircle","BlueCircle","useHistory","AlertF","CryptoJS","require","SecureStorage","SECRET_KEY","secureStorage","localStorage","hash","key","SHA256","toString","encrypt","data","AES","decrypt","enc","Utf8","ChangePasswordPage","document","title","process","env","REACT_APP_APP_NAMEPROJ","body","style","zoom","password","setPassword","newPassword","setNewPassword","confPassword","setConfPassword","passwordShown1","setPasswordShown1","passwordShown2","setPasswordShown2","passwordShown3","setPasswordShown3","blankError","setBlankError","wrongPassError","setWrongPassError","notCoincideError","setNotCoincideError","successful","setSuccessful","history","handelChangePassword","email","getItem","options","method","headers","JSON","stringify","fetch","REACT_APP_SERVER","REACT_APP_NODE_PORT","then","response","json","clear","setTimeout","replace","REACT_APP_PROJECT","catch","err","console","log","togglePassword1","togglePassword2","togglePassword3","cancel","goBack","logo","REACT_APP_PROGRESS","IsoTrackerLogo","width","e","target","value","top"],"mappings":"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","sourcesContent":["import React, { useState} from 'react'\r\nimport './changePassword.css';\r\nimport TechnipLogo from \"../../assets/images/technip.png\"\r\nimport IsoTrackerLogo from \"../../assets/images/IsoTracker.svg\"\r\nimport FullTrackerLogo from \"../../assets/images/3dtracker.png\"\r\nimport Eye from \"../../assets/images/eye.png\"\r\nimport GreenCircle from \"../../assets/images/green_circle.png\"\r\nimport BlueCircle from \"../../assets/images/blue_circle.png\"\r\nimport {useHistory} from \"react-router\";\r\nimport AlertF from \"../../components/alert/alert\"\r\n\r\n\r\n//Página de home con el menú para ir a las aplicaciones de isotracker\r\n\r\nconst CryptoJS = require(\"crypto-js\");\r\nconst SecureStorage = require(\"secure-web-storage\");\r\nvar SECRET_KEY = 'sanud2ha8shd72h';\r\n\r\n \r\nvar secureStorage = new SecureStorage(localStorage, {\r\n    hash: function hash(key) {\r\n        key = CryptoJS.SHA256(key, SECRET_KEY);\r\n \r\n        return key.toString();\r\n    },\r\n    encrypt: function encrypt(data) {\r\n        data = CryptoJS.AES.encrypt(data, SECRET_KEY);\r\n \r\n        data = data.toString();\r\n \r\n        return data;\r\n    },\r\n    decrypt: function decrypt(data) {\r\n        data = CryptoJS.AES.decrypt(data, SECRET_KEY);\r\n \r\n        data = data.toString(CryptoJS.enc.Utf8);\r\n \r\n        return data;\r\n    }\r\n});\r\n\r\nconst ChangePasswordPage = () =>{\r\n    document.title= process.env.REACT_APP_APP_NAMEPROJ\r\n    document.body.style.zoom = 0.8\r\n\r\n    const [password, setPassword] = useState(null);\r\n    const [newPassword, setNewPassword] = useState(null);\r\n    const [confPassword, setConfPassword] = useState(null);\r\n    \r\n    const [passwordShown1, setPasswordShown1] = useState(false);\r\n    const [passwordShown2, setPasswordShown2] = useState(false); \r\n    const [passwordShown3, setPasswordShown3] = useState(false);\r\n\r\n    const [blankError, setBlankError] = useState(false);\r\n    const [wrongPassError, setWrongPassError] = useState(false);\r\n    const [notCoincideError, setNotCoincideError] = useState(false);\r\n    const [successful, setSuccessful] = useState(false);\r\n    const history = useHistory();\r\n\r\n    const handelChangePassword = async() =>{\r\n        setWrongPassError(false)\r\n        setBlankError(false)\r\n        setConfPassword(false)\r\n        const body = {\r\n            email: secureStorage.getItem('user'),\r\n            password: password\r\n        }\r\n        const options = {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(body)\r\n        }\r\n        if(password === null || newPassword === null || confPassword === null || password === \"\" || newPassword === \"\" || confPassword === \"\"){\r\n            setBlankError(true)\r\n        }else{\r\n            await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/api/user/getPassword\", options)\r\n            .then(response => response.json())\r\n            .then(async json =>{\r\n                if(json.password === \"incorrect\"){\r\n                    setWrongPassError(true)\r\n                }else{\r\n                    if(newPassword === confPassword){\r\n                        const body = {\r\n                            email: secureStorage.getItem('user'),\r\n                            newPassword: newPassword\r\n                        }\r\n                        const options = {\r\n                            method: \"POST\",\r\n                            headers: {\r\n                                \"Content-Type\": \"application/json\"\r\n                            },\r\n                            body: JSON.stringify(body)\r\n                        }\r\n                        await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/user/changePassword\", options)\r\n                        .then(async response => {\r\n                            await setSuccessful(true)\r\n                            await localStorage.clear();\r\n                            setTimeout(()=> {history.replace(\"/\"+process.env.REACT_APP_PROJECT+\"/\")}, 2000)\r\n                        })\r\n                        .catch(err=> console.log(err))\r\n                    }else{\r\n                        setNotCoincideError(true)\r\n                    }\r\n                }\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    const togglePassword1 = () => {\r\n        setPasswordShown1(!passwordShown1);\r\n    };\r\n\r\n    const togglePassword2 = () => {\r\n        setPasswordShown2(!passwordShown2);\r\n    };\r\n\r\n    const togglePassword3 = () => {\r\n        setPasswordShown3(!passwordShown3);\r\n    };\r\n\r\n    const cancel = async() =>{\r\n        history.goBack()\r\n    }\r\n\r\n\r\n    let logo = null\r\n\r\n    if(process.env.REACT_APP_PROGRESS === \"0\"){\r\n        logo = IsoTrackerLogo\r\n    }else{\r\n        logo = FullTrackerLogo\r\n    }\r\n\r\n    return(\r\n        <body>\r\n            <div\r\n            className={`alert alert-success ${blankError ? 'alert-shown' : 'alert-hidden'}`}\r\n            onTransitionEnd={() => setBlankError(false)}\r\n            >\r\n                <AlertF type=\"error\" subtext=\"At least one field is blank!\" change={true}/>\r\n            </div>\r\n            <div\r\n            className={`alert alert-success ${wrongPassError ? 'alert-shown' : 'alert-hidden'}`}\r\n            onTransitionEnd={() => setWrongPassError(false)}\r\n            >\r\n                <AlertF type=\"error\" subtext=\"The current password is not correct!\" change={true}/>\r\n            </div>\r\n            <div\r\n            className={`alert alert-success ${notCoincideError ? 'alert-shown' : 'alert-hidden'}`}\r\n            onTransitionEnd={() => setNotCoincideError(false)}\r\n            >\r\n                <AlertF type=\"error\" subtext=\"The passwords don't match!\" change={true}/>\r\n            </div>\r\n            <div\r\n            className={`alert alert-success ${successful ? 'alert-shown' : 'alert-hidden'}`}\r\n            onTransitionEnd={() => setSuccessful(false)}\r\n            >\r\n                <AlertF type=\"success\" change={true} text=\"Password changed successfully!\"/>\r\n            </div>\r\n\r\n            \r\n            \r\n        <div className=\"background\">\r\n            <img src={TechnipLogo} alt=\"technipLogo\" className=\"technipLogo__image\"/>\r\n            <img src={GreenCircle} alt=\"greenCircle\" className=\"greenCircle__image\"/>\r\n            <img src={BlueCircle} alt=\"blueCircle\" className=\"blueCircle__image\"/>\r\n            \r\n            <div className=\"login__form\">\r\n                <img src={logo} alt=\"isoTrackerLogo\" className=\"isoTrackerLogo__image\"/>\r\n                <text className=\"welcome__text\" style={{width:\"250px\"}}>Change password</text>\r\n                <text className=\"enter__text\">Please, enter your current password, current password confirmation and new password.</text>\r\n                <text className=\"email__label\" style={{width:\"120px\"}}>Current password</text>\r\n                <div>\r\n                    <input className=\"current__password__input\" type={passwordShown1 ? \"text\" : \"password\"} onChange={(e) => setPassword(e.target.value)}/>\r\n                    <img onClick={togglePassword1} src={Eye} alt=\"eye\" className=\"current__password__eye__image\"></img>\r\n                </div>\r\n                <text className=\"password__label\" style={{width:\"220px\"}}>New password</text>\r\n                <div>\r\n                    <input className=\"conf__password__input\" type={passwordShown2 ? \"text\" : \"password\"} onChange={(e) => setConfPassword(e.target.value)}/>\r\n                    <img onClick={togglePassword2} src={Eye} alt=\"eye\" className=\"conf__password__eye__image\"></img>\r\n                </div>\r\n                <text className=\"new__password__label\" style={{width:\"160px\"}}>Confirm new password</text>\r\n                <div>\r\n                    <input className=\"new__password__input\" type={passwordShown3 ? \"text\" : \"password\"} onChange={(e) => setNewPassword(e.target.value)}/>\r\n                    <img onClick={togglePassword3} src={Eye} alt=\"eye\" className=\"new__password__eye__image\"></img>\r\n                </div>\r\n                <div className=\"login__buttons\" style={{top:\"420px\"}}>\r\n                    <button className=\"login__button\" onClick={handelChangePassword}>Save</button>\r\n                    <button className=\"cancel__button\" onClick={cancel}>Cancel</button>\r\n            </div>\r\n            </div>\r\n            \r\n        </div>\r\n        </body>\r\n    );\r\n};\r\n\r\nexport default ChangePasswordPage;"]},"metadata":{},"sourceType":"module"}