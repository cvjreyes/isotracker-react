{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createSuper\";import _objectSpread from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import'react-dropzone-uploader/dist/styles.css';import Dropzone from'react-dropzone-uploader';import React from'react';import{message}from'antd';import Alert from'@material-ui/lab/Alert';import Collapse from'@material-ui/core/Collapse';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Layout=function Layout(_ref){var input=_ref.input,previews=_ref.previews,submitButton=_ref.submitButton,dropzoneProps=_ref.dropzoneProps,files=_ref.files,maxFiles=_ref.extra.maxFiles;return/*#__PURE__*/_jsxs(\"div\",{children:[submitButton,/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({},dropzoneProps),{},{children:[previews,files.length<maxFiles&&input]}))]});};var DragAndDrop=/*#__PURE__*/function(_React$Component){_inherits(DragAndDrop,_React$Component);var _super=_createSuper(DragAndDrop);function DragAndDrop(){var _this;_classCallCheck(this,DragAndDrop);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={fileList:[],success:false,error:false,pipeError:false,ownerError:false,uploaded:false,errorAlerts:[],pipeErrorAlerts:[],ownerErrorAlerts:[],max:0,uploadingPreview:false,uploading:false,nSuccess:0};_this.handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(files,allFiles){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.setState({success:false,uploaded:false,error:false,pipeError:false,errorAlerts:[],pipeErrorAlerts:[],ownerErrorAlerts:[],counter:0,max:files.length,uploading:true,nSuccess:0});_context4.next=3;return allFiles.forEach(function(file){var formData=new FormData();formData.append('file',file.file);if(_this.props.mode===\"upload\"){if(process.env.REACT_APP_PROGRESS===\"0\"){fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkOwner/\"+file.file.name).then(function(response){return response.json();}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(json){var joined,max;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(json.owner){_this.uploadFile(formData);}else{joined=_this.state.ownerErrorAlerts.concat(file.file.name);_this.setState({ownerErrorAlerts:joined,ownerError:true});max=_this.state.max-1;_this.setState({max:max});if(max===0){_this.setState({uploaded:true,uploading:false});}}case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x3){return _ref3.apply(this,arguments);};}());_this.uploadFile(formData);}else{fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkOwner/\"+file.file.name).then(function(response){return response.json();}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(json){var joined,max;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(json.owner){fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkPipe/\"+file.file.name).then(function(response){return response.json();}).then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(json){var joined,max;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(json.exists){_this.uploadFile(formData);}else{joined=_this.state.pipeErrorAlerts.concat(file.file.name);_this.setState({pipeErrorAlerts:joined,pipeError:true});max=_this.state.max-1;_this.setState({max:max});if(max===0){_this.setState({uploaded:true,uploading:false});}}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x5){return _ref5.apply(this,arguments);};}());}else{joined=_this.state.ownerErrorAlerts.concat(file.file.name);_this.setState({ownerErrorAlerts:joined,ownerError:true});max=_this.state.max-1;_this.setState({max:max});if(max===0){_this.setState({uploaded:true,uploading:false});}}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref4.apply(this,arguments);};}());}}else{if(String(_this.props.iso).trim()===String(file.file.name.split('.').slice(0,-1)).trim()||String(_this.props.iso+'-CL').trim()===String(file.file.name.split('.').slice(0,-1)).trim()){_this.updateFile(formData);}else{var joined=_this.state.errorAlerts.concat(file.file.name);_this.setState({errorAlerts:joined,error:true,uploading:false});}}file.remove();});case 3:_this.setState({uploaded:true});if(_this.props.mode===\"upload\"){_this.props.uploaded();}case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}();return _this;}_createClass(DragAndDrop,[{key:\"uploadFile\",value:function(){var _uploadFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(file){var _this2=this;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/upload\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\nif(response.status===200){var n=_this2.state.nSuccess;_this2.setState({nSuccess:n+1});if(!_this2.state.success){_this2.setState({success:true});}var filename=null;var _iterator=_createForOfIteratorHelper(file.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;filename=value.name;}}catch(err){_iterator.e(err);}finally{_iterator.f();}var extension=\"\";var i=filename.lastIndexOf('.');var cl=false;if(i>0){extension=filename.substring(i+1);if(filename.substring(i-2)==='CL.pdf'){cl=true;}}if(extension===\"pdf\"&&!cl){var body={fileName:filename,user:_this2.props.user,role:_this2.props.role};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadHis\",{// content-type header should not be specified!\nmethod:'POST',headers:{\"Content-Type\":\"application/json\",\"Accept\":\"application/json\"},body:JSON.stringify(body)}).catch(function(error){return console.log(error);});}}else{var _iterator2=_createForOfIteratorHelper(file.values()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _value=_step2.value;var joined=_this2.state.errorAlerts.concat(_value.name);_this2.setState({errorAlerts:joined,error:true});}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}var max=_this2.state.max-1;_this2.setState({max:max});if(max===0){_this2.setState({uploaded:true,uploading:false});if(_this2.state.nSuccess>0){var _body={n:_this2.state.nSuccess};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadNotifications\",{// content-type header should not be specified!\nmethod:'POST',headers:{\"Content-Type\":\"application/json\",\"Accept\":\"application/json\"},body:JSON.stringify(_body)}).catch(function(error){return console.log(error);});}}}).catch(function(error){return message.error(error);});case 2:this.props.uploaded();case 3:case\"end\":return _context5.stop();}}},_callee5,this);}));function uploadFile(_x6){return _uploadFile.apply(this,arguments);}return uploadFile;}()},{key:\"updateFile\",value:function(){var _updateFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(file){var _this3=this;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/update\",{// content-type header should not be specified!\nmethod:'POST',body:file}).then(function(response){// Do something with the successful response\nif(response.status===200){if(!_this3.state.success){_this3.setState({success:true});}var filename=null;var _iterator3=_createForOfIteratorHelper(file.values()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var value=_step3.value;filename=value.name;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}var extension=\"\";var i=filename.lastIndexOf('.');if(i>0){extension=filename.substring(i+1);}if(extension===\"pdf\"){var body={file:filename,user:_this3.props.user,role:_this3.props.role};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/updateHis\",{// content-type header should not be specified!\nmethod:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)}).then(function(response){return console.log(response.json());}).catch(function(error){return message.error(error);});}}else{var _iterator4=_createForOfIteratorHelper(file.values()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _value2=_step4.value;var joined=_this3.state.errorAlerts.concat(_value2.name);_this3.setState({errorAlerts:joined,error:true});}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}var max=_this3.state.max-1;_this3.setState({max:max});if(max===0){_this3.setState({uploaded:true,uploading:false});}}).catch(function(error){return message.error(error);});case 2:case\"end\":return _context6.stop();}}},_callee6);}));function updateFile(_x7){return _updateFile.apply(this,arguments);}return updateFile;}()},{key:\"render\",value:function render(){var errorAlerts=this.state.errorAlerts;var pipeErrorAlerts=this.state.pipeErrorAlerts;var ownerErrorAlerts=this.state.ownerErrorAlerts;var errors=[];var pipeErrors=[];var ownerErrors=[];if(errorAlerts.length>0){for(var i=0;i<errorAlerts.length;i++){if(this.props.mode===\"upload\"){errors.push(/*#__PURE__*/_jsxs(Alert,{severity:\"error\",children:[\"The file \",errorAlerts[i],\" already exists!\"]}));}else{errors.push(/*#__PURE__*/_jsxs(Alert,{severity:\"error\",children:[\"The file \",errorAlerts[i],\" doesn't belong to this isometric!\"]}));}}}if(pipeErrorAlerts.length>0){for(var _i=0;_i<pipeErrorAlerts.length;_i++){pipeErrors.push(/*#__PURE__*/_jsxs(Alert,{severity:\"error\",children:[\"The file \",pipeErrorAlerts[_i],\" doesn't belong to this project!\"]}));}}if(ownerErrorAlerts.length>0){for(var _i2=0;_i2<ownerErrorAlerts.length;_i2++){ownerErrors.push(/*#__PURE__*/_jsxs(Alert,{severity:\"error\",children:[\"The isometric \",ownerErrorAlerts[_i2],\" doesn't have an owner!\"]}));}}var inputContent=null;var styles=null;if(this.props.mode===\"upload\"){inputContent=\"Drop isometrics here\";styles={dropzone:{maxHeight:'400px'}};}else{inputContent=\"Drop the files to update\";styles={dropzone:{height:'250px'},dropzoneActive:{height:'300px'},previewContainer:{height:'2px'}};}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Dropzone,{LayoutComponent:Layout,onSubmit:this.handleSubmit,inputContent:inputContent,styles:styles}),/*#__PURE__*/_jsx(Collapse,{in:this.state.success,children:/*#__PURE__*/_jsx(Collapse,{in:this.state.uploaded,children:/*#__PURE__*/_jsx(Alert,{children:\"The files have been uploaded!\"})})}),/*#__PURE__*/_jsx(Collapse,{in:this.state.error,children:/*#__PURE__*/_jsx(Collapse,{in:this.state.uploaded,children:errors})}),/*#__PURE__*/_jsx(Collapse,{in:this.state.pipeError,children:/*#__PURE__*/_jsx(Collapse,{in:this.state.uploaded,children:pipeErrors})}),/*#__PURE__*/_jsx(Collapse,{in:this.state.ownerError,children:/*#__PURE__*/_jsx(Collapse,{in:this.state.uploaded,children:ownerErrors})}),/*#__PURE__*/_jsx(Collapse,{in:this.state.uploading,children:/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"The files are uploading...\"})})]});}}]);return DragAndDrop;}(React.Component);export default DragAndDrop;","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/src/components/dragAndDrop/dragAndDrop.js"],"names":["Dropzone","React","message","Alert","Collapse","Layout","input","previews","submitButton","dropzoneProps","files","maxFiles","extra","length","DragAndDrop","state","fileList","success","error","pipeError","ownerError","uploaded","errorAlerts","pipeErrorAlerts","ownerErrorAlerts","max","uploadingPreview","uploading","nSuccess","handleSubmit","allFiles","setState","counter","forEach","file","formData","FormData","append","props","mode","process","env","REACT_APP_PROGRESS","fetch","REACT_APP_SERVER","REACT_APP_NODE_PORT","name","then","response","json","owner","uploadFile","joined","concat","exists","String","iso","trim","split","slice","updateFile","remove","method","body","status","n","filename","values","value","extension","i","lastIndexOf","cl","substring","fileName","user","role","headers","JSON","stringify","catch","console","log","errors","pipeErrors","ownerErrors","push","inputContent","styles","dropzone","maxHeight","height","dropzoneActive","previewContainer","Component"],"mappings":"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","sourcesContent":["import 'react-dropzone-uploader/dist/styles.css'\r\nimport Dropzone from 'react-dropzone-uploader'\r\nimport React from 'react'\r\nimport {message} from'antd'\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Collapse from '@material-ui/core/Collapse'\r\n\r\nconst Layout = ({ input, previews, submitButton, dropzoneProps, files, extra: { maxFiles } }) => {\r\n  return (\r\n    <div>\r\n      \r\n      {submitButton}\r\n      <div {...dropzoneProps}>\r\n      \r\n      {previews}\r\n      {files.length < maxFiles && input}\r\n        \r\n      </div>\r\n\r\n      \r\n    </div>\r\n  )\r\n}\r\n\r\nclass DragAndDrop extends React.Component{\r\n\r\n  state = {\r\n    fileList: [],\r\n    success: false,\r\n    error: false,\r\n    pipeError: false,\r\n    ownerError: false,\r\n    uploaded: false,\r\n    errorAlerts: [],\r\n    pipeErrorAlerts: [],\r\n    ownerErrorAlerts: [],\r\n    max: 0,\r\n    uploadingPreview: false,\r\n    uploading: false,\r\n    nSuccess: 0\r\n  };\r\n\r\n  async uploadFile(file) {\r\n    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/upload\", {\r\n      // content-type header should not be specified!\r\n      method: 'POST',\r\n      body: file,\r\n    })\r\n      .then(response => {\r\n        // Do something with the successful response\r\n        if (response.status === 200){\r\n          let n = this.state.nSuccess\r\n          this.setState({nSuccess: n+1})\r\n          if(!this.state.success){\r\n              this.setState({\r\n                success : true,\r\n              })\r\n          }\r\n\r\n          let filename = null;\r\n          for (let value of file.values()){\r\n            filename = value.name\r\n          }\r\n          let extension = \"\";\r\n          let i = filename.lastIndexOf('.');\r\n          let cl = false\r\n          if (i > 0) {\r\n            extension = filename.substring(i+1);\r\n            if(filename.substring(i-2) === 'CL.pdf'){\r\n              cl = true\r\n            }\r\n          }\r\n          if(extension === \"pdf\" && !cl){\r\n            let body =  {\r\n              fileName: filename,\r\n              user: this.props.user,\r\n              role: this.props.role\r\n            }\r\n            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadHis\", {\r\n              // content-type header should not be specified!\r\n              method: 'POST',\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                \"Accept\": \"application/json\"\r\n              },\r\n              body: JSON.stringify(body)\r\n            }).catch(error =>console.log(error))\r\n          }\r\n        }else{\r\n          for (let value of file.values()) {\r\n            let joined = this.state.errorAlerts.concat(value.name);\r\n            this.setState({\r\n              errorAlerts : joined,\r\n              error: true\r\n            })\r\n          }\r\n        }\r\n        let max = this.state.max - 1\r\n        this.setState({\r\n          max: max\r\n        })\r\n        if (max === 0){\r\n          this.setState({\r\n            uploaded: true,\r\n            uploading: false\r\n          })\r\n          if(this.state.nSuccess > 0){\r\n            let body =  {\r\n              n: this.state.nSuccess\r\n            }\r\n            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/uploadNotifications\", {\r\n              // content-type header should not be specified!\r\n              method: 'POST',\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                \"Accept\": \"application/json\"\r\n              },\r\n              body: JSON.stringify(body)\r\n            }).catch(error =>console.log(error))\r\n          }    \r\n\r\n        }\r\n        \r\n      })\r\n      .catch(error => message.error(error)\r\n    );\r\n    this.props.uploaded()\r\n  }\r\n\r\n  async updateFile(file) {\r\n\r\n    \r\n    await fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/update\", {\r\n      // content-type header should not be specified!\r\n      method: 'POST',\r\n      body: file,\r\n    })\r\n      .then(response => {\r\n        // Do something with the successful response\r\n        if (response.status === 200){\r\n          if(!this.state.success){\r\n              this.setState({\r\n                success : true,\r\n              })\r\n          }\r\n\r\n          let filename = null;\r\n          for (let value of file.values()){\r\n            filename = value.name\r\n          }\r\n          let extension = \"\";\r\n          let i = filename.lastIndexOf('.');\r\n          if (i > 0) {\r\n            extension = filename.substring(i+1);\r\n          }\r\n          if(extension === \"pdf\"){\r\n            let body =  {\r\n              file: filename,\r\n              user: this.props.user,\r\n              role: this.props.role\r\n            }\r\n            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/updateHis\", {\r\n              // content-type header should not be specified!\r\n              method: 'POST',\r\n              headers: {\r\n                \"Content-Type\": \"application/json\"\r\n              },\r\n              body: JSON.stringify(body)\r\n            }).then(response => console.log(response.json()))\r\n            .catch(error => message.error(error))\r\n          }\r\n        }else{\r\n          for (let value of file.values()) {\r\n            let joined = this.state.errorAlerts.concat(value.name);\r\n            this.setState({\r\n              errorAlerts : joined,\r\n              error: true\r\n            })\r\n          }\r\n        }\r\n        let max = this.state.max - 1\r\n        this.setState({\r\n          max: max\r\n        })\r\n        \r\n        if (max === 0){\r\n          this.setState({\r\n            uploaded: true,\r\n            uploading: false\r\n          })\r\n        }\r\n        \r\n      })\r\n      .catch(error => message.error(error)\r\n    );\r\n  }\r\n\r\n\r\n  handleSubmit = async (files, allFiles) => {\r\n\r\n    this.setState({\r\n      success: false,\r\n      uploaded: false,\r\n      error: false,\r\n      pipeError: false,\r\n      errorAlerts: [],\r\n      pipeErrorAlerts: [],\r\n      ownerErrorAlerts: [],\r\n      counter: 0,\r\n      max: files.length,\r\n      uploading: true,\r\n      nSuccess: 0\r\n    })\r\n\r\n    await allFiles.forEach(file => {\r\n      const formData  = new FormData(); \r\n      formData.append('file', file.file);  \r\n      if(this.props.mode === \"upload\"){\r\n\r\n        if(process.env.REACT_APP_PROGRESS === \"0\"){\r\n          fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkOwner/\"+file.file.name)\r\n        .then(response => response.json())\r\n        .then(async json =>{\r\n          if(json.owner){\r\n            this.uploadFile(formData);\r\n          }else{\r\n            let joined = this.state.ownerErrorAlerts.concat(file.file.name);\r\n            this.setState({\r\n              ownerErrorAlerts : joined,\r\n              ownerError: true\r\n            })\r\n            let max = this.state.max - 1\r\n            this.setState({\r\n              max: max\r\n            })\r\n            if (max === 0){\r\n              this.setState({\r\n                uploaded: true,\r\n                uploading: false\r\n              })\r\n            }\r\n          }\r\n        })\r\n          this.uploadFile(formData);\r\n        }else{\r\n          fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkOwner/\"+file.file.name)\r\n        .then(response => response.json())\r\n        .then(async json =>{\r\n          if(json.owner){\r\n            fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/checkPipe/\"+file.file.name)\r\n          .then(response => response.json())\r\n          .then(async json =>{\r\n            if(json.exists){\r\n              this.uploadFile(formData);\r\n            }else{\r\n              let joined = this.state.pipeErrorAlerts.concat(file.file.name);\r\n              this.setState({\r\n                pipeErrorAlerts : joined,\r\n                pipeError: true\r\n              })\r\n              let max = this.state.max - 1\r\n              this.setState({\r\n                max: max\r\n              })\r\n              if (max === 0){\r\n                this.setState({\r\n                  uploaded: true,\r\n                  uploading: false\r\n                })\r\n              }\r\n            }\r\n          })\r\n          }else{\r\n            let joined = this.state.ownerErrorAlerts.concat(file.file.name);\r\n            this.setState({\r\n              ownerErrorAlerts : joined,\r\n              ownerError: true\r\n            })\r\n            let max = this.state.max - 1\r\n            this.setState({\r\n              max: max\r\n            })\r\n            if (max === 0){\r\n              this.setState({\r\n                uploaded: true,\r\n                uploading: false\r\n              })\r\n            }\r\n          }\r\n        })\r\n          \r\n        }\r\n        \r\n      }else{\r\n        if(String(this.props.iso).trim() === String(file.file.name.split('.').slice(0, -1)).trim() || \r\n           String(this.props.iso+'-CL').trim() === String(file.file.name.split('.').slice(0, -1)).trim() ){\r\n          this.updateFile(formData);\r\n        }else{\r\n          let joined = this.state.errorAlerts.concat(file.file.name);\r\n            this.setState({\r\n              errorAlerts : joined,\r\n              error: true,\r\n              uploading: false\r\n            })\r\n        }\r\n      }\r\n      file.remove();\r\n    });    \r\n    this.setState({\r\n      uploaded: true\r\n    })\r\n    if(this.props.mode === \"upload\"){\r\n      this.props.uploaded()\r\n    }\r\n    \r\n\r\n  }\r\n\r\n  render(){\r\n\r\n    const errorAlerts = this.state.errorAlerts;\r\n    const pipeErrorAlerts = this.state.pipeErrorAlerts;\r\n    const ownerErrorAlerts = this.state.ownerErrorAlerts;\r\n    let errors = []\r\n    let pipeErrors = []\r\n    let ownerErrors =[]\r\n    if(errorAlerts.length > 0){\r\n      for(let i = 0; i < errorAlerts.length; i++){\r\n        \r\n        if (this.props.mode === \"upload\"){\r\n          errors.push(<Alert severity=\"error\"\r\n          >\r\n            The file {errorAlerts[i]} already exists!\r\n\r\n          </Alert>)\r\n        }else{\r\n          errors.push(<Alert severity=\"error\"\r\n          >\r\n            The file {errorAlerts[i]} doesn't belong to this isometric!\r\n\r\n          </Alert>)\r\n        }\r\n      }\r\n    }\r\n\r\n    if(pipeErrorAlerts.length > 0){\r\n      for(let i = 0; i < pipeErrorAlerts.length; i++){\r\n        \r\n          pipeErrors.push(<Alert severity=\"error\"\r\n          >\r\n            The file {pipeErrorAlerts[i]} doesn't belong to this project!\r\n\r\n          </Alert>)\r\n      }\r\n    }\r\n\r\n    if(ownerErrorAlerts.length > 0){\r\n      for(let i = 0; i < ownerErrorAlerts.length; i++){\r\n        \r\n          ownerErrors.push(<Alert severity=\"error\"\r\n          >\r\n            The isometric {ownerErrorAlerts[i]} doesn't have an owner!\r\n\r\n          </Alert>)\r\n      }\r\n    }\r\n    \r\n\r\n    let inputContent = null\r\n    let styles = null\r\n\r\n    if(this.props.mode === \"upload\"){\r\n      inputContent = \"Drop isometrics here\"\r\n      styles = {\r\n        dropzone: {\r\n          maxHeight: '400px',\r\n        },\r\n      }\r\n    }else{\r\n      inputContent = \"Drop the files to update\"\r\n      styles = {\r\n        dropzone: {\r\n          height: '250px'\r\n        },\r\n        dropzoneActive: {\r\n          height: '300px'\r\n        },\r\n        previewContainer:{\r\n          height: '2px'\r\n        }\r\n    }\r\n    \r\n  }\r\n    return (\r\n      <div>\r\n        <Dropzone\r\n          LayoutComponent={Layout}\r\n          onSubmit={this.handleSubmit}\r\n          inputContent= {inputContent}\r\n          styles={styles}\r\n        />\r\n\r\n        <Collapse in={this.state.success}>\r\n          <Collapse in={this.state.uploaded}>\r\n            <Alert\r\n            >\r\n              The files have been uploaded!\r\n\r\n            </Alert>\r\n          </Collapse>\r\n        </Collapse>\r\n\r\n        <Collapse in={this.state.error}>\r\n          <Collapse in={this.state.uploaded}>\r\n            {errors}\r\n          </Collapse>\r\n          \r\n        </Collapse>\r\n        <Collapse in={this.state.pipeError}>\r\n          <Collapse in={this.state.uploaded}>\r\n            {pipeErrors}\r\n          </Collapse>\r\n          \r\n        </Collapse>\r\n        <Collapse in={this.state.ownerError}>\r\n          <Collapse in={this.state.uploaded}>\r\n            {ownerErrors}\r\n          </Collapse>\r\n          \r\n        </Collapse>\r\n        <Collapse in={this.state.uploading}>\r\n          <Alert severity=\"info\"\r\n            >\r\n              The files are uploading...\r\n\r\n            </Alert>\r\n        </Collapse>\r\n        \r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DragAndDrop;"]},"metadata":{},"sourceType":"module"}