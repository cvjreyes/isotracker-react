{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar _templateObject;\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nimport { BasePlugin } from \"../base/index.mjs\";\nimport { arrayEach, arrayMap } from \"../../helpers/array.mjs\";\nimport { toSingleLine } from \"../../helpers/templateLiteralTag.mjs\";\nimport { warn } from \"../../helpers/console.mjs\";\nimport { rangeEach } from \"../../helpers/number.mjs\";\nimport EventManager from \"../../eventManager.mjs\";\nimport { addClass, removeClass, closest } from \"../../helpers/dom/element.mjs\";\nimport { SEPARATOR } from \"../contextMenu/predefinedItems.mjs\";\nimport * as constants from \"../../i18n/constants.mjs\";\nimport ConditionComponent from \"./component/condition.mjs\";\nimport OperatorsComponent from \"./component/operators.mjs\";\nimport ValueComponent from \"./component/value.mjs\";\nimport ActionBarComponent from \"./component/actionBar.mjs\";\nimport ConditionCollection from \"./conditionCollection.mjs\";\nimport DataFilter from \"./dataFilter.mjs\";\nimport ConditionUpdateObserver from \"./conditionUpdateObserver.mjs\";\nimport { createArrayAssertion, toEmptyString, unifyColumnValues } from \"./utils.mjs\";\nimport { CONDITION_NONE, CONDITION_BY_VALUE, OPERATION_AND, OPERATION_OR, OPERATION_OR_THEN_VARIABLE } from \"./constants.mjs\";\nimport { TrimmingMap } from \"../../translations/index.mjs\";\nexport var PLUGIN_KEY = 'filters';\nexport var PLUGIN_PRIORITY = 250;\n/**\r\n * @plugin Filters\r\n *\r\n * @description\r\n * The plugin allows filtering the table data either by the built-in component or with the API.\r\n *\r\n * See [the filtering demo](https://handsontable.com/docs/demo-filtering.html) for examples.\r\n *\r\n * @example\r\n * ```\r\n * const container = document.getElementById('example');\r\n * const hot = new Handsontable(container, {\r\n *   data: getData(),\r\n *   colHeaders: true,\r\n *   rowHeaders: true,\r\n *   dropdownMenu: true,\r\n *   filters: true\r\n * });\r\n * ```\r\n */\n\nexport var Filters = /*#__PURE__*/function (_BasePlugin) {\n  _inherits(Filters, _BasePlugin);\n\n  var _super = _createSuper(Filters);\n\n  function Filters(hotInstance) {\n    var _this;\n\n    _classCallCheck(this, Filters);\n\n    _this = _super.call(this, hotInstance);\n    /**\r\n     * Instance of {@link EventManager}.\r\n     *\r\n     * @private\r\n     * @type {EventManager}\r\n     */\n\n    _this.eventManager = new EventManager(_assertThisInitialized(_this));\n    /**\r\n     * Instance of {@link DropdownMenu}.\r\n     *\r\n     * @private\r\n     * @type {DropdownMenu}\r\n     */\n\n    _this.dropdownMenuPlugin = null;\n    /**\r\n     * Instance of {@link ConditionCollection}.\r\n     *\r\n     * @private\r\n     * @type {ConditionCollection}\r\n     */\n\n    _this.conditionCollection = null;\n    /**\r\n     * Instance of {@link ConditionUpdateObserver}.\r\n     *\r\n     * @private\r\n     * @type {ConditionUpdateObserver}\r\n     */\n\n    _this.conditionUpdateObserver = null;\n    /**\r\n     * Map, where key is component identifier and value represent `BaseComponent` element or it derivatives.\r\n     *\r\n     * @private\r\n     * @type {Map}\r\n     */\n\n    _this.components = new Map([['filter_by_condition', null], ['filter_operators', null], ['filter_by_condition2', null], ['filter_by_value', null], ['filter_action_bar', null]]);\n    /**\r\n     * Object containing information about last selected column physical and visual index for added filter conditions.\r\n     *\r\n     * @private\r\n     * @type {object}\r\n     * @default null\r\n     */\n\n    _this.lastSelectedColumn = null;\n    /**\r\n     * Map of skipped rows by plugin.\r\n     *\r\n     * @private\r\n     * @type {null|TrimmingMap}\r\n     */\n\n    _this.filtersRowsMap = null; // One listener for the enable/disable functionality\n\n    _this.hot.addHook('afterGetColHeader', function (col, TH) {\n      return _this.onAfterGetColHeader(col, TH);\n    });\n\n    return _this;\n  }\n  /**\r\n   * Checks if the plugin is enabled in the handsontable settings. This method is executed in {@link Hooks#beforeInit}\r\n   * hook and if it returns `true` than the {@link Filters#enablePlugin} method is called.\r\n   *\r\n   * @returns {boolean}\r\n   */\n\n\n  _createClass(Filters, [{\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      /* eslint-disable no-unneeded-ternary */\n      return this.hot.getSettings()[PLUGIN_KEY] ? true : false;\n    }\n    /**\r\n     * Enables the plugin functionality for this Handsontable instance.\r\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this2 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      this.filtersRowsMap = this.hot.rowIndexMapper.registerMap(this.pluginName, new TrimmingMap());\n      this.dropdownMenuPlugin = this.hot.getPlugin('dropdownMenu');\n      var dropdownSettings = this.hot.getSettings().dropdownMenu;\n      var menuContainer = dropdownSettings && dropdownSettings.uiContainer || this.hot.rootDocument.body;\n\n      var addConfirmationHooks = function addConfirmationHooks(component) {\n        component.addLocalHook('accept', function () {\n          return _this2.onActionBarSubmit('accept');\n        });\n        component.addLocalHook('cancel', function () {\n          return _this2.onActionBarSubmit('cancel');\n        });\n        component.addLocalHook('change', function (command) {\n          return _this2.onComponentChange(component, command);\n        });\n        return component;\n      };\n\n      var filterByConditionLabel = function filterByConditionLabel() {\n        return \"\".concat(_this2.hot.getTranslatedPhrase(constants.FILTERS_DIVS_FILTER_BY_CONDITION), \":\");\n      };\n\n      var filterValueLabel = function filterValueLabel() {\n        return \"\".concat(_this2.hot.getTranslatedPhrase(constants.FILTERS_DIVS_FILTER_BY_VALUE), \":\");\n      };\n\n      if (!this.components.get('filter_by_condition')) {\n        var conditionComponent = new ConditionComponent(this.hot, {\n          id: 'filter_by_condition',\n          name: filterByConditionLabel,\n          addSeparator: false,\n          menuContainer: menuContainer\n        });\n        conditionComponent.addLocalHook('afterClose', function () {\n          return _this2.onSelectUIClosed();\n        });\n        this.components.set('filter_by_condition', addConfirmationHooks(conditionComponent));\n      }\n\n      if (!this.components.get('filter_operators')) {\n        this.components.set('filter_operators', new OperatorsComponent(this.hot, {\n          id: 'filter_operators',\n          name: 'Operators'\n        }));\n      }\n\n      if (!this.components.get('filter_by_condition2')) {\n        var _conditionComponent = new ConditionComponent(this.hot, {\n          id: 'filter_by_condition2',\n          name: '',\n          addSeparator: true,\n          menuContainer: menuContainer\n        });\n\n        _conditionComponent.addLocalHook('afterClose', function () {\n          return _this2.onSelectUIClosed();\n        });\n\n        this.components.set('filter_by_condition2', addConfirmationHooks(_conditionComponent));\n      }\n\n      if (!this.components.get('filter_by_value')) {\n        this.components.set('filter_by_value', addConfirmationHooks(new ValueComponent(this.hot, {\n          id: 'filter_by_value',\n          name: filterValueLabel\n        })));\n      }\n\n      if (!this.components.get('filter_action_bar')) {\n        this.components.set('filter_action_bar', addConfirmationHooks(new ActionBarComponent(this.hot, {\n          id: 'filter_action_bar',\n          name: 'Action bar'\n        })));\n      }\n\n      if (!this.conditionCollection) {\n        this.conditionCollection = new ConditionCollection(this.hot);\n      }\n\n      if (!this.conditionUpdateObserver) {\n        this.conditionUpdateObserver = new ConditionUpdateObserver(this.hot, this.conditionCollection, function (physicalColumn) {\n          return _this2.getDataMapAtColumn(physicalColumn);\n        });\n        this.conditionUpdateObserver.addLocalHook('update', function (conditionState) {\n          return _this2.updateComponents(conditionState);\n        });\n      }\n\n      this.components.forEach(function (component) {\n        return component.show();\n      });\n      this.registerEvents();\n      this.addHook('beforeDropdownMenuSetItems', function (items) {\n        return _this2.onBeforeDropdownMenuSetItems(items);\n      });\n      this.addHook('afterDropdownMenuDefaultOptions', function (defaultOptions) {\n        return _this2.onAfterDropdownMenuDefaultOptions(defaultOptions);\n      });\n      this.addHook('afterDropdownMenuShow', function () {\n        return _this2.onAfterDropdownMenuShow();\n      });\n      this.addHook('afterDropdownMenuHide', function () {\n        return _this2.onAfterDropdownMenuHide();\n      });\n      this.addHook('afterChange', function (changes) {\n        return _this2.onAfterChange(changes);\n      }); // Temp. solution (extending menu items bug in contextMenu/dropdownMenu)\n\n      if (this.hot.getSettings().dropdownMenu && this.dropdownMenuPlugin) {\n        this.dropdownMenuPlugin.disablePlugin();\n        this.dropdownMenuPlugin.enablePlugin();\n      }\n\n      _get(_getPrototypeOf(Filters.prototype), \"enablePlugin\", this).call(this);\n    }\n    /**\r\n     * Registers the DOM listeners.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"registerEvents\",\n    value: function registerEvents() {\n      var _this3 = this;\n\n      this.eventManager.addEventListener(this.hot.rootElement, 'click', function (event) {\n        return _this3.onTableClick(event);\n      });\n    }\n    /**\r\n     * Disables the plugin functionality for this Handsontable instance.\r\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      var _this4 = this;\n\n      if (this.enabled) {\n        var _this$dropdownMenuPlu;\n\n        if ((_this$dropdownMenuPlu = this.dropdownMenuPlugin) !== null && _this$dropdownMenuPlu !== void 0 && _this$dropdownMenuPlu.enabled) {\n          this.dropdownMenuPlugin.menu.clearLocalHooks();\n        }\n\n        this.components.forEach(function (component, key) {\n          component.destroy();\n\n          _this4.components.set(key, null);\n        });\n        this.conditionCollection.destroy();\n        this.conditionCollection = null;\n        this.hot.rowIndexMapper.unregisterMap(this.pluginName);\n      }\n\n      _get(_getPrototypeOf(Filters.prototype), \"disablePlugin\", this).call(this);\n    }\n    /* eslint-disable jsdoc/require-description-complete-sentence */\n\n    /**\r\n     * @memberof Filters#\r\n     * @function addCondition\r\n     * @description\r\n     * Adds condition to the conditions collection at specified column index.\r\n     *\r\n     * Possible predefined conditions:\r\n     *  * `begins_with` - Begins with\r\n     *  * `between` - Between\r\n     *  * `by_value` - By value\r\n     *  * `contains` - Contains\r\n     *  * `empty` - Empty\r\n     *  * `ends_with` - Ends with\r\n     *  * `eq` - Equal\r\n     *  * `gt` - Greater than\r\n     *  * `gte` - Greater than or equal\r\n     *  * `lt` - Less than\r\n     *  * `lte` - Less than or equal\r\n     *  * `none` - None (no filter)\r\n     *  * `not_between` - Not between\r\n     *  * `not_contains` - Not contains\r\n     *  * `not_empty` - Not empty\r\n     *  * `neq` - Not equal.\r\n     *\r\n     * Possible operations on collection of conditions:\r\n     *  * `conjunction` - [**Conjunction**](https://en.wikipedia.org/wiki/Logical_conjunction) on conditions collection (by default), i.e. for such operation: c1 AND c2 AND c3 AND c4 ... AND cn === TRUE, where c1 ... cn are conditions.\r\n     *  * `disjunction` - [**Disjunction**](https://en.wikipedia.org/wiki/Logical_disjunction) on conditions collection, i.e. for such operation: `c1 OR c2 OR c3 OR c4 ... OR cn` === TRUE, where c1, c2, c3, c4 ... cn are conditions.\r\n     *  * `disjunctionWithExtraCondition` - **Disjunction** on first `n - 1`\\* conditions from collection with an extra requirement computed from the last condition, i.e. for such operation: `c1 OR c2 OR c3 OR c4 ... OR cn-1 AND cn` === TRUE, where c1, c2, c3, c4 ... cn are conditions.\r\n     *\r\n     * \\* when `n` is collection size; it's used i.e. for one operation introduced from UI (when choosing from filter's drop-down menu two conditions with OR operator between them, mixed with choosing values from the multiple choice select)\r\n     *\r\n     * **Note**: Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, use it consequently for a particular column).\r\n     *\r\n     * @example\r\n     * ```js\r\n     * const container = document.getElementById('example');\r\n     * const hot = new Handsontable(container, {\r\n     *   data: getData(),\r\n     *   filters: true\r\n     * });\r\n     *\r\n     * // access to filters plugin instance\r\n     * const filtersPlugin = hot.getPlugin('filters');\r\n     *\r\n     * // add filter \"Greater than\" 95 to column at index 1\r\n     * filtersPlugin.addCondition(1, 'gt', [95]);\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"By value\" to column at index 1\r\n     * // in this case all value's that don't match will be filtered.\r\n     * filtersPlugin.addCondition(1, 'by_value', [['ing', 'ed', 'as', 'on']]);\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"Begins with\" with value \"de\" AND \"Not contains\" with value \"ing\"\r\n     * filtersPlugin.addCondition(1, 'begins_with', ['de'], 'conjunction');\r\n     * filtersPlugin.addCondition(1, 'not_contains', ['ing'], 'conjunction');\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"Begins with\" with value \"de\" OR \"Not contains\" with value \"ing\"\r\n     * filtersPlugin.addCondition(1, 'begins_with', ['de'], 'disjunction');\r\n     * filtersPlugin.addCondition(1, 'not_contains', ['ing'], 'disjunction');\r\n     * filtersPlugin.filter();\r\n     * ```\r\n     * @param {number} column Visual column index.\r\n     * @param {string} name Condition short name.\r\n     * @param {Array} args Condition arguments.\r\n     * @param {string} [operationId=conjunction] `id` of operation which is performed on the column.\r\n     */\n\n    /* eslint-enable jsdoc/require-description-complete-sentence */\n\n  }, {\n    key: \"addCondition\",\n    value: function addCondition(column, name, args) {\n      var operationId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : OPERATION_AND;\n      var physicalColumn = this.hot.toPhysicalColumn(column);\n      this.conditionCollection.addCondition(physicalColumn, {\n        command: {\n          key: name\n        },\n        args: args\n      }, operationId);\n    }\n    /**\r\n     * Removes conditions at specified column index.\r\n     *\r\n     * @param {number} column Visual column index.\r\n     */\n\n  }, {\n    key: \"removeConditions\",\n    value: function removeConditions(column) {\n      var physicalColumn = this.hot.toPhysicalColumn(column);\n      this.conditionCollection.removeConditions(physicalColumn);\n    }\n    /**\r\n     * Clears all conditions previously added to the collection for the specified column index or, if the column index\r\n     * was not passed, clear the conditions for all columns.\r\n     *\r\n     * @param {number} [column] Visual column index.\r\n     */\n\n  }, {\n    key: \"clearConditions\",\n    value: function clearConditions(column) {\n      if (column === void 0) {\n        this.conditionCollection.clean();\n      } else {\n        var physicalColumn = this.hot.toPhysicalColumn(column);\n        this.conditionCollection.removeConditions(physicalColumn);\n      }\n    }\n    /**\r\n     * Filters data based on added filter conditions.\r\n     *\r\n     * @fires Hooks#beforeFilter\r\n     * @fires Hooks#afterFilter\r\n     */\n\n  }, {\n    key: \"filter\",\n    value: function filter() {\n      var _this5 = this;\n\n      var dataFilter = this._createDataFilter();\n\n      var needToFilter = !this.conditionCollection.isEmpty();\n      var visibleVisualRows = [];\n      var conditions = this.conditionCollection.exportAllConditions();\n      var allowFiltering = this.hot.runHooks('beforeFilter', conditions);\n\n      if (allowFiltering !== false) {\n        if (needToFilter) {\n          var trimmedRows = [];\n          this.hot.batchExecution(function () {\n            _this5.filtersRowsMap.clear();\n\n            visibleVisualRows = arrayMap(dataFilter.filter(), function (rowData) {\n              return rowData.meta.visualRow;\n            });\n            var visibleVisualRowsAssertion = createArrayAssertion(visibleVisualRows);\n            rangeEach(_this5.hot.countSourceRows() - 1, function (row) {\n              if (!visibleVisualRowsAssertion(row)) {\n                trimmedRows.push(row);\n              }\n            });\n            arrayEach(trimmedRows, function (physicalRow) {\n              _this5.filtersRowsMap.setValueAtIndex(physicalRow, true);\n            });\n          }, true);\n\n          if (!visibleVisualRows.length) {\n            this.hot.deselectCell();\n          }\n        } else {\n          this.filtersRowsMap.clear();\n        }\n      }\n\n      this.hot.runHooks('afterFilter', conditions);\n      this.hot.view.adjustElementsSize(true);\n      this.hot.render();\n      this.clearColumnSelection();\n    }\n    /**\r\n     * Gets last selected column index.\r\n     *\r\n     * @returns {object|null} Return `null` when column isn't selected otherwise\r\n     * object containing information about selected column with keys `visualIndex` and `physicalIndex`.\r\n     */\n\n  }, {\n    key: \"getSelectedColumn\",\n    value: function getSelectedColumn() {\n      return this.lastSelectedColumn;\n    }\n    /**\r\n     * Clears column selection.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"clearColumnSelection\",\n    value: function clearColumnSelection() {\n      var _this$hot$getSelected;\n\n      var coords = (_this$hot$getSelected = this.hot.getSelectedRangeLast()) === null || _this$hot$getSelected === void 0 ? void 0 : _this$hot$getSelected.getTopLeftCorner();\n\n      if (coords !== void 0) {\n        this.hot.selectCell(coords.row, coords.col);\n      }\n    }\n    /**\r\n     * Returns handsontable source data with cell meta based on current selection.\r\n     *\r\n     * @param {number} [column] The physical column index. By default column index accept the value of the selected column.\r\n     * @returns {Array} Returns array of objects where keys as row index.\r\n     */\n\n  }, {\n    key: \"getDataMapAtColumn\",\n    value: function getDataMapAtColumn(column) {\n      var _this6 = this;\n\n      var visualIndex = this.hot.toVisualColumn(column);\n      var data = [];\n      arrayEach(this.hot.getSourceDataAtCol(visualIndex), function (value, rowIndex) {\n        var _this6$hot$getCellMet = _this6.hot.getCellMeta(rowIndex, visualIndex),\n            row = _this6$hot$getCellMet.row,\n            col = _this6$hot$getCellMet.col,\n            visualCol = _this6$hot$getCellMet.visualCol,\n            visualRow = _this6$hot$getCellMet.visualRow,\n            type = _this6$hot$getCellMet.type,\n            instance = _this6$hot$getCellMet.instance,\n            dateFormat = _this6$hot$getCellMet.dateFormat;\n\n        data.push({\n          meta: {\n            row: row,\n            col: col,\n            visualCol: visualCol,\n            visualRow: visualRow,\n            type: type,\n            instance: instance,\n            dateFormat: dateFormat\n          },\n          value: toEmptyString(value)\n        });\n      });\n      return data;\n    }\n    /**\r\n     * `afterChange` listener.\r\n     *\r\n     * @private\r\n     * @param {Array} changes Array of changes.\r\n     */\n\n  }, {\n    key: \"onAfterChange\",\n    value: function onAfterChange(changes) {\n      var _this7 = this;\n\n      if (changes) {\n        arrayEach(changes, function (change) {\n          var _change = _slicedToArray(change, 2),\n              prop = _change[1];\n\n          var columnIndex = _this7.hot.propToCol(prop);\n\n          if (_this7.conditionCollection.hasConditions(columnIndex)) {\n            _this7.updateValueComponentCondition(columnIndex);\n          }\n        });\n      }\n    }\n    /**\r\n     * Update condition of ValueComponent basing on handled changes.\r\n     *\r\n     * @private\r\n     * @param {number} columnIndex Column index of handled ValueComponent condition.\r\n     */\n\n  }, {\n    key: \"updateValueComponentCondition\",\n    value: function updateValueComponentCondition(columnIndex) {\n      var dataAtCol = this.hot.getDataAtCol(columnIndex);\n      var selectedValues = unifyColumnValues(dataAtCol);\n      this.conditionUpdateObserver.updateStatesAtColumn(columnIndex, selectedValues);\n    }\n    /**\r\n     * Restores components to its saved state.\r\n     *\r\n     * @private\r\n     * @param {Array} components List of components.\r\n     */\n\n  }, {\n    key: \"restoreComponents\",\n    value: function restoreComponents(components) {\n      var _this$getSelectedColu;\n\n      var physicalIndex = (_this$getSelectedColu = this.getSelectedColumn()) === null || _this$getSelectedColu === void 0 ? void 0 : _this$getSelectedColu.physicalIndex;\n      components.forEach(function (component) {\n        if (component.isHidden()) {\n          return;\n        }\n\n        component.restoreState(physicalIndex);\n      });\n      this.updateDependentComponentsVisibility();\n    }\n    /**\r\n     * After dropdown menu show listener.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"onAfterDropdownMenuShow\",\n    value: function onAfterDropdownMenuShow() {\n      this.restoreComponents(Array.from(this.components.values()));\n    }\n    /**\r\n     * After dropdown menu hide listener.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"onAfterDropdownMenuHide\",\n    value: function onAfterDropdownMenuHide() {\n      this.components.get('filter_by_condition').getSelectElement().closeOptions();\n      this.components.get('filter_by_condition2').getSelectElement().closeOptions();\n    }\n    /**\r\n     * Before dropdown menu set menu items listener.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"onBeforeDropdownMenuSetItems\",\n    value: function onBeforeDropdownMenuSetItems() {\n      var _this8 = this;\n\n      if (this.dropdownMenuPlugin) {\n        this.dropdownMenuPlugin.menu.addLocalHook('afterOpen', function () {\n          _this8.dropdownMenuPlugin.menu.hotMenu.updateSettings({\n            hiddenRows: true\n          });\n        });\n      }\n    }\n    /**\r\n     * After dropdown menu default options listener.\r\n     *\r\n     * @private\r\n     * @param {object} defaultOptions ContextMenu default item options.\r\n     */\n\n  }, {\n    key: \"onAfterDropdownMenuDefaultOptions\",\n    value: function onAfterDropdownMenuDefaultOptions(defaultOptions) {\n      defaultOptions.items.push({\n        name: SEPARATOR\n      });\n      this.components.forEach(function (component) {\n        defaultOptions.items.push(component.getMenuItemDescriptor());\n      });\n    }\n    /**\r\n     * Get operation basing on number and type of arguments (where arguments are states of components).\r\n     *\r\n     * @param {string} suggestedOperation Operation which was chosen by user from UI.\r\n     * @param {object} byConditionState1 State of first condition component.\r\n     * @param {object} byConditionState2 State of second condition component.\r\n     * @param {object} byValueState State of value component.\r\n     * @private\r\n     * @returns {string}\r\n     */\n\n  }, {\n    key: \"getOperationBasedOnArguments\",\n    value: function getOperationBasedOnArguments(suggestedOperation, byConditionState1, byConditionState2, byValueState) {\n      var operation = suggestedOperation;\n\n      if (operation === OPERATION_OR && byConditionState1.command.key !== CONDITION_NONE && byConditionState2.command.key !== CONDITION_NONE && byValueState.command.key !== CONDITION_NONE) {\n        operation = OPERATION_OR_THEN_VARIABLE;\n      } else if (byValueState.command.key !== CONDITION_NONE) {\n        if (byConditionState1.command.key === CONDITION_NONE || byConditionState2.command.key === CONDITION_NONE) {\n          operation = OPERATION_AND;\n        }\n      }\n\n      return operation;\n    }\n    /**\r\n     * On action bar submit listener.\r\n     *\r\n     * @private\r\n     * @param {string} submitType The submit type.\r\n     */\n\n  }, {\n    key: \"onActionBarSubmit\",\n    value: function onActionBarSubmit(submitType) {\n      if (submitType === 'accept') {\n        var _this$getSelectedColu2;\n\n        var physicalIndex = (_this$getSelectedColu2 = this.getSelectedColumn()) === null || _this$getSelectedColu2 === void 0 ? void 0 : _this$getSelectedColu2.physicalIndex;\n        var byConditionState1 = this.components.get('filter_by_condition').getState();\n        var byConditionState2 = this.components.get('filter_by_condition2').getState();\n        var byValueState = this.components.get('filter_by_value').getState();\n        var operation = this.getOperationBasedOnArguments(this.components.get('filter_operators').getActiveOperationId(), byConditionState1, byConditionState2, byValueState);\n        this.conditionUpdateObserver.groupChanges();\n        var columnStackPosition = this.conditionCollection.getColumnStackPosition(physicalIndex);\n\n        if (columnStackPosition === -1) {\n          columnStackPosition = void 0;\n        }\n\n        this.conditionCollection.removeConditions(physicalIndex);\n\n        if (byConditionState1.command.key !== CONDITION_NONE) {\n          this.conditionCollection.addCondition(physicalIndex, byConditionState1, operation, columnStackPosition);\n\n          if (byConditionState2.command.key !== CONDITION_NONE) {\n            this.conditionCollection.addCondition(physicalIndex, byConditionState2, operation, columnStackPosition);\n          }\n        }\n\n        if (byValueState.command.key !== CONDITION_NONE) {\n          this.conditionCollection.addCondition(physicalIndex, byValueState, operation, columnStackPosition);\n        }\n\n        this.conditionUpdateObserver.flush();\n        this.components.forEach(function (component) {\n          return component.saveState(physicalIndex);\n        });\n        this.filtersRowsMap.clear();\n        this.filter();\n      }\n\n      if (this.dropdownMenuPlugin) {\n        this.dropdownMenuPlugin.close();\n      }\n    }\n    /**\r\n     * On component change listener.\r\n     *\r\n     * @private\r\n     * @param {BaseComponent} component Component inheriting BaseComponent.\r\n     * @param {object} command Menu item object (command).\r\n     */\n\n  }, {\n    key: \"onComponentChange\",\n    value: function onComponentChange(component, command) {\n      this.updateDependentComponentsVisibility();\n\n      if (component.constructor === ConditionComponent && !command.inputsCount) {\n        this.setListeningDropdownMenu();\n      }\n    }\n    /**\r\n     * On component SelectUI closed listener.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"onSelectUIClosed\",\n    value: function onSelectUIClosed() {\n      this.setListeningDropdownMenu();\n    }\n    /**\r\n     * Listen to the keyboard input on document body and forward events to instance of Handsontable\r\n     * created by DropdownMenu plugin.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"setListeningDropdownMenu\",\n    value: function setListeningDropdownMenu() {\n      if (this.dropdownMenuPlugin) {\n        this.dropdownMenuPlugin.setListening();\n      }\n    }\n    /**\r\n     * Updates visibility of the some of the components based on the state of the parent component.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"updateDependentComponentsVisibility\",\n    value: function updateDependentComponentsVisibility() {\n      var component = this.components.get('filter_by_condition');\n\n      var _component$getState = component.getState(),\n          command = _component$getState.command;\n\n      var componentsToShow = [this.components.get('filter_by_condition2'), this.components.get('filter_operators')];\n\n      if (command.showOperators) {\n        this.showComponents.apply(this, componentsToShow);\n      } else {\n        this.hideComponents.apply(this, componentsToShow);\n      }\n    }\n    /**\r\n     * On after get column header listener.\r\n     *\r\n     * @private\r\n     * @param {number} col Visual column index.\r\n     * @param {HTMLTableCellElement} TH Header's TH element.\r\n     */\n\n  }, {\n    key: \"onAfterGetColHeader\",\n    value: function onAfterGetColHeader(col, TH) {\n      var physicalColumn = this.hot.toPhysicalColumn(col);\n\n      if (this.enabled && this.conditionCollection.hasConditions(physicalColumn)) {\n        addClass(TH, 'htFiltersActive');\n      } else {\n        removeClass(TH, 'htFiltersActive');\n      }\n    }\n    /**\r\n     * On table click listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event DOM Event.\r\n     */\n\n  }, {\n    key: \"onTableClick\",\n    value: function onTableClick(event) {\n      var th = closest(event.target, 'TH');\n\n      if (th) {\n        var visualIndex = this.hot.getCoords(th).col;\n        var physicalIndex = this.hot.toPhysicalColumn(visualIndex);\n        this.lastSelectedColumn = {\n          visualIndex: visualIndex,\n          physicalIndex: physicalIndex\n        };\n      }\n    }\n    /**\r\n     * Creates DataFilter instance based on condition collection.\r\n     *\r\n     * @private\r\n     * @param {ConditionCollection} conditionCollection Condition collection object.\r\n     * @returns {DataFilter}\r\n     */\n\n  }, {\n    key: \"_createDataFilter\",\n    value: function _createDataFilter() {\n      var _this9 = this;\n\n      var conditionCollection = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.conditionCollection;\n      return new DataFilter(conditionCollection, function (physicalColumn) {\n        return _this9.getDataMapAtColumn(physicalColumn);\n      });\n    }\n    /**\r\n     * It updates the components state. The state is triggered by ConditionUpdateObserver, which\r\n     * reacts to any condition added to the condition collection. It may be added through the UI\r\n     * components or by API call.\r\n     *\r\n     * @private\r\n     * @param {object} conditionsState An object with the state generated by UI components.\r\n     */\n\n  }, {\n    key: \"updateComponents\",\n    value: function updateComponents(conditionsState) {\n      var _this$dropdownMenuPlu2;\n\n      if (!((_this$dropdownMenuPlu2 = this.dropdownMenuPlugin) !== null && _this$dropdownMenuPlu2 !== void 0 && _this$dropdownMenuPlu2.enabled)) {\n        return;\n      }\n\n      var _conditionsState$edit = conditionsState.editedConditionStack,\n          conditions = _conditionsState$edit.conditions,\n          column = _conditionsState$edit.column;\n      var conditionsByValue = conditions.filter(function (condition) {\n        return condition.name === CONDITION_BY_VALUE;\n      });\n      var conditionsWithoutByValue = conditions.filter(function (condition) {\n        return condition.name !== CONDITION_BY_VALUE;\n      });\n\n      if (conditionsByValue.length >= 2 || conditionsWithoutByValue.length >= 3) {\n        warn(toSingleLine(_templateObject || (_templateObject = _taggedTemplateLiteral([\"The filter conditions have been applied properly, but couldn\\u2019t be displayed visually. \\n        The overall amount of conditions exceed the capability of the dropdown menu. \\n        For more details see the documentation.\"], [\"The filter conditions have been applied properly, but couldn\\u2019t be displayed visually.\\\\x20\\n        The overall amount of conditions exceed the capability of the dropdown menu.\\\\x20\\n        For more details see the documentation.\"]))));\n      } else {\n        var operationType = this.conditionCollection.getOperation(column);\n        this.components.get('filter_by_condition').updateState(conditionsWithoutByValue[0], column);\n        this.components.get('filter_by_condition2').updateState(conditionsWithoutByValue[1], column);\n        this.components.get('filter_operators').updateState(operationType, column);\n        this.components.get('filter_by_value').updateState(conditionsState);\n      }\n    }\n    /**\r\n     * Returns indexes of passed components inside list of `dropdownMenu` items.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     * @returns {Array}\r\n     */\n\n  }, {\n    key: \"getIndexesOfComponents\",\n    value: function getIndexesOfComponents() {\n      var indexes = [];\n\n      if (!this.dropdownMenuPlugin) {\n        return indexes;\n      }\n\n      var menu = this.dropdownMenuPlugin.menu;\n\n      for (var _len = arguments.length, components = new Array(_len), _key = 0; _key < _len; _key++) {\n        components[_key] = arguments[_key];\n      }\n\n      arrayEach(components, function (component) {\n        arrayEach(menu.menuItems, function (item, index) {\n          if (item.key === component.getMenuItemDescriptor().key) {\n            indexes.push(index);\n          }\n        });\n      });\n      return indexes;\n    }\n    /**\r\n     * Changes visibility of component.\r\n     *\r\n     * @private\r\n     * @param {boolean} visible Determine if components should be visible.\r\n     * @param {...BaseComponent} components List of components.\r\n     */\n\n  }, {\n    key: \"changeComponentsVisibility\",\n    value: function changeComponentsVisibility() {\n      var visible = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      if (!this.dropdownMenuPlugin) {\n        return;\n      }\n\n      var menu = this.dropdownMenuPlugin.menu;\n      var hotMenu = menu.hotMenu;\n      var hiddenRows = hotMenu.getPlugin('hiddenRows');\n\n      for (var _len2 = arguments.length, components = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        components[_key2 - 1] = arguments[_key2];\n      }\n\n      var indexes = this.getIndexesOfComponents.apply(this, components);\n\n      if (visible) {\n        hiddenRows.showRows(indexes);\n      } else {\n        hiddenRows.hideRows(indexes);\n      }\n\n      hotMenu.render();\n    }\n    /**\r\n     * Hides components of filters `dropdownMenu`.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     */\n\n  }, {\n    key: \"hideComponents\",\n    value: function hideComponents() {\n      for (var _len3 = arguments.length, components = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        components[_key3] = arguments[_key3];\n      }\n\n      this.changeComponentsVisibility.apply(this, [false].concat(components));\n    }\n    /**\r\n     * Shows components of filters `dropdownMenu`.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     */\n\n  }, {\n    key: \"showComponents\",\n    value: function showComponents() {\n      for (var _len4 = arguments.length, components = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        components[_key4] = arguments[_key4];\n      }\n\n      this.changeComponentsVisibility.apply(this, [true].concat(components));\n    }\n    /**\r\n     * Destroys the plugin instance.\r\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var _this10 = this;\n\n      if (this.enabled) {\n        this.components.forEach(function (component, key) {\n          if (component !== null) {\n            component.destroy();\n\n            _this10.components.set(key, null);\n          }\n        });\n        this.conditionCollection.destroy();\n        this.conditionUpdateObserver.destroy();\n        this.hot.rowIndexMapper.unregisterMap(this.pluginName);\n      }\n\n      _get(_getPrototypeOf(Filters.prototype), \"destroy\", this).call(this);\n    }\n  }], [{\n    key: \"PLUGIN_KEY\",\n    get: function get() {\n      return PLUGIN_KEY;\n    }\n  }, {\n    key: \"PLUGIN_PRIORITY\",\n    get: function get() {\n      return PLUGIN_PRIORITY;\n    }\n  }, {\n    key: \"PLUGIN_DEPS\",\n    get: function get() {\n      return ['plugin:DropdownMenu', 'plugin:HiddenRows', 'cell-type:checkbox'];\n    }\n  }]);\n\n  return Filters;\n}(BasePlugin);","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/handsontable/plugins/filters/filters.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_templateObject","_taggedTemplateLiteral","strings","raw","slice","Object","freeze","defineProperties","value","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","name","Array","from","test","len","length","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","err","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","BasePlugin","arrayEach","arrayMap","toSingleLine","warn","rangeEach","EventManager","addClass","removeClass","closest","SEPARATOR","constants","ConditionComponent","OperatorsComponent","ValueComponent","ActionBarComponent","ConditionCollection","DataFilter","ConditionUpdateObserver","createArrayAssertion","toEmptyString","unifyColumnValues","CONDITION_NONE","CONDITION_BY_VALUE","OPERATION_AND","OPERATION_OR","OPERATION_OR_THEN_VARIABLE","TrimmingMap","PLUGIN_KEY","PLUGIN_PRIORITY","Filters","_BasePlugin","_super","hotInstance","_this","eventManager","dropdownMenuPlugin","conditionCollection","conditionUpdateObserver","components","Map","lastSelectedColumn","filtersRowsMap","hot","addHook","col","TH","onAfterGetColHeader","isEnabled","getSettings","enablePlugin","_this2","enabled","rowIndexMapper","registerMap","pluginName","getPlugin","dropdownSettings","dropdownMenu","menuContainer","uiContainer","rootDocument","body","addConfirmationHooks","component","addLocalHook","onActionBarSubmit","command","onComponentChange","filterByConditionLabel","concat","getTranslatedPhrase","FILTERS_DIVS_FILTER_BY_CONDITION","filterValueLabel","FILTERS_DIVS_FILTER_BY_VALUE","conditionComponent","id","addSeparator","onSelectUIClosed","set","_conditionComponent","physicalColumn","getDataMapAtColumn","conditionState","updateComponents","forEach","show","registerEvents","items","onBeforeDropdownMenuSetItems","defaultOptions","onAfterDropdownMenuDefaultOptions","onAfterDropdownMenuShow","onAfterDropdownMenuHide","changes","onAfterChange","disablePlugin","_this3","addEventListener","rootElement","event","onTableClick","_this4","_this$dropdownMenuPlu","menu","clearLocalHooks","destroy","unregisterMap","addCondition","column","args","operationId","undefined","toPhysicalColumn","removeConditions","clearConditions","clean","filter","_this5","dataFilter","_createDataFilter","needToFilter","isEmpty","visibleVisualRows","conditions","exportAllConditions","allowFiltering","runHooks","trimmedRows","batchExecution","clear","rowData","meta","visualRow","visibleVisualRowsAssertion","countSourceRows","row","physicalRow","setValueAtIndex","deselectCell","view","adjustElementsSize","render","clearColumnSelection","getSelectedColumn","_this$hot$getSelected","coords","getSelectedRangeLast","getTopLeftCorner","selectCell","_this6","visualIndex","toVisualColumn","data","getSourceDataAtCol","rowIndex","_this6$hot$getCellMet","getCellMeta","visualCol","type","dateFormat","_this7","change","_change","prop","columnIndex","propToCol","hasConditions","updateValueComponentCondition","dataAtCol","getDataAtCol","selectedValues","updateStatesAtColumn","restoreComponents","_this$getSelectedColu","physicalIndex","isHidden","restoreState","updateDependentComponentsVisibility","values","getSelectElement","closeOptions","_this8","hotMenu","updateSettings","hiddenRows","getMenuItemDescriptor","getOperationBasedOnArguments","suggestedOperation","byConditionState1","byConditionState2","byValueState","operation","submitType","_this$getSelectedColu2","getState","getActiveOperationId","groupChanges","columnStackPosition","getColumnStackPosition","flush","saveState","close","inputsCount","setListeningDropdownMenu","setListening","_component$getState","componentsToShow","showOperators","showComponents","hideComponents","th","getCoords","_this9","conditionsState","_this$dropdownMenuPlu2","_conditionsState$edit","editedConditionStack","conditionsByValue","condition","conditionsWithoutByValue","operationType","getOperation","updateState","getIndexesOfComponents","indexes","_len","_key","menuItems","item","index","changeComponentsVisibility","visible","_len2","_key2","showRows","hideRows","_len3","_key3","_len4","_key4","_this10"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\r\n\r\nimport \"core-js/modules/es.object.set-prototype-of.js\";\r\nimport \"core-js/modules/es.object.get-prototype-of.js\";\r\nimport \"core-js/modules/es.reflect.construct.js\";\r\nimport \"core-js/modules/es.reflect.get.js\";\r\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\r\nimport \"core-js/modules/es.symbol.js\";\r\nimport \"core-js/modules/es.symbol.description.js\";\r\nimport \"core-js/modules/es.symbol.iterator.js\";\r\nimport \"core-js/modules/es.array.slice.js\";\r\nimport \"core-js/modules/es.object.freeze.js\";\r\n\r\nvar _templateObject;\r\n\r\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\r\n\r\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\r\n\r\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\r\n\r\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\nimport \"core-js/modules/es.array.iterator.js\";\r\nimport \"core-js/modules/es.map.js\";\r\nimport \"core-js/modules/es.object.to-string.js\";\r\nimport \"core-js/modules/es.string.iterator.js\";\r\nimport \"core-js/modules/web.dom-collections.iterator.js\";\r\nimport \"core-js/modules/web.dom-collections.for-each.js\";\r\nimport \"core-js/modules/es.array.filter.js\";\r\nimport \"core-js/modules/es.array.from.js\";\r\nimport \"core-js/modules/es.function.name.js\";\r\nimport \"core-js/modules/es.array.concat.js\";\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\r\n\r\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\r\n\r\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\r\n\r\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\r\n\r\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\r\n\r\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\r\n\r\nimport { BasePlugin } from \"../base/index.mjs\";\r\nimport { arrayEach, arrayMap } from \"../../helpers/array.mjs\";\r\nimport { toSingleLine } from \"../../helpers/templateLiteralTag.mjs\";\r\nimport { warn } from \"../../helpers/console.mjs\";\r\nimport { rangeEach } from \"../../helpers/number.mjs\";\r\nimport EventManager from \"../../eventManager.mjs\";\r\nimport { addClass, removeClass, closest } from \"../../helpers/dom/element.mjs\";\r\nimport { SEPARATOR } from \"../contextMenu/predefinedItems.mjs\";\r\nimport * as constants from \"../../i18n/constants.mjs\";\r\nimport ConditionComponent from \"./component/condition.mjs\";\r\nimport OperatorsComponent from \"./component/operators.mjs\";\r\nimport ValueComponent from \"./component/value.mjs\";\r\nimport ActionBarComponent from \"./component/actionBar.mjs\";\r\nimport ConditionCollection from \"./conditionCollection.mjs\";\r\nimport DataFilter from \"./dataFilter.mjs\";\r\nimport ConditionUpdateObserver from \"./conditionUpdateObserver.mjs\";\r\nimport { createArrayAssertion, toEmptyString, unifyColumnValues } from \"./utils.mjs\";\r\nimport { CONDITION_NONE, CONDITION_BY_VALUE, OPERATION_AND, OPERATION_OR, OPERATION_OR_THEN_VARIABLE } from \"./constants.mjs\";\r\nimport { TrimmingMap } from \"../../translations/index.mjs\";\r\nexport var PLUGIN_KEY = 'filters';\r\nexport var PLUGIN_PRIORITY = 250;\r\n/**\r\n * @plugin Filters\r\n *\r\n * @description\r\n * The plugin allows filtering the table data either by the built-in component or with the API.\r\n *\r\n * See [the filtering demo](https://handsontable.com/docs/demo-filtering.html) for examples.\r\n *\r\n * @example\r\n * ```\r\n * const container = document.getElementById('example');\r\n * const hot = new Handsontable(container, {\r\n *   data: getData(),\r\n *   colHeaders: true,\r\n *   rowHeaders: true,\r\n *   dropdownMenu: true,\r\n *   filters: true\r\n * });\r\n * ```\r\n */\r\n\r\nexport var Filters = /*#__PURE__*/function (_BasePlugin) {\r\n  _inherits(Filters, _BasePlugin);\r\n\r\n  var _super = _createSuper(Filters);\r\n\r\n  function Filters(hotInstance) {\r\n    var _this;\r\n\r\n    _classCallCheck(this, Filters);\r\n\r\n    _this = _super.call(this, hotInstance);\r\n    /**\r\n     * Instance of {@link EventManager}.\r\n     *\r\n     * @private\r\n     * @type {EventManager}\r\n     */\r\n\r\n    _this.eventManager = new EventManager(_assertThisInitialized(_this));\r\n    /**\r\n     * Instance of {@link DropdownMenu}.\r\n     *\r\n     * @private\r\n     * @type {DropdownMenu}\r\n     */\r\n\r\n    _this.dropdownMenuPlugin = null;\r\n    /**\r\n     * Instance of {@link ConditionCollection}.\r\n     *\r\n     * @private\r\n     * @type {ConditionCollection}\r\n     */\r\n\r\n    _this.conditionCollection = null;\r\n    /**\r\n     * Instance of {@link ConditionUpdateObserver}.\r\n     *\r\n     * @private\r\n     * @type {ConditionUpdateObserver}\r\n     */\r\n\r\n    _this.conditionUpdateObserver = null;\r\n    /**\r\n     * Map, where key is component identifier and value represent `BaseComponent` element or it derivatives.\r\n     *\r\n     * @private\r\n     * @type {Map}\r\n     */\r\n\r\n    _this.components = new Map([['filter_by_condition', null], ['filter_operators', null], ['filter_by_condition2', null], ['filter_by_value', null], ['filter_action_bar', null]]);\r\n    /**\r\n     * Object containing information about last selected column physical and visual index for added filter conditions.\r\n     *\r\n     * @private\r\n     * @type {object}\r\n     * @default null\r\n     */\r\n\r\n    _this.lastSelectedColumn = null;\r\n    /**\r\n     * Map of skipped rows by plugin.\r\n     *\r\n     * @private\r\n     * @type {null|TrimmingMap}\r\n     */\r\n\r\n    _this.filtersRowsMap = null; // One listener for the enable/disable functionality\r\n\r\n    _this.hot.addHook('afterGetColHeader', function (col, TH) {\r\n      return _this.onAfterGetColHeader(col, TH);\r\n    });\r\n\r\n    return _this;\r\n  }\r\n  /**\r\n   * Checks if the plugin is enabled in the handsontable settings. This method is executed in {@link Hooks#beforeInit}\r\n   * hook and if it returns `true` than the {@link Filters#enablePlugin} method is called.\r\n   *\r\n   * @returns {boolean}\r\n   */\r\n\r\n\r\n  _createClass(Filters, [{\r\n    key: \"isEnabled\",\r\n    value: function isEnabled() {\r\n      /* eslint-disable no-unneeded-ternary */\r\n      return this.hot.getSettings()[PLUGIN_KEY] ? true : false;\r\n    }\r\n    /**\r\n     * Enables the plugin functionality for this Handsontable instance.\r\n     */\r\n\r\n  }, {\r\n    key: \"enablePlugin\",\r\n    value: function enablePlugin() {\r\n      var _this2 = this;\r\n\r\n      if (this.enabled) {\r\n        return;\r\n      }\r\n\r\n      this.filtersRowsMap = this.hot.rowIndexMapper.registerMap(this.pluginName, new TrimmingMap());\r\n      this.dropdownMenuPlugin = this.hot.getPlugin('dropdownMenu');\r\n      var dropdownSettings = this.hot.getSettings().dropdownMenu;\r\n      var menuContainer = dropdownSettings && dropdownSettings.uiContainer || this.hot.rootDocument.body;\r\n\r\n      var addConfirmationHooks = function addConfirmationHooks(component) {\r\n        component.addLocalHook('accept', function () {\r\n          return _this2.onActionBarSubmit('accept');\r\n        });\r\n        component.addLocalHook('cancel', function () {\r\n          return _this2.onActionBarSubmit('cancel');\r\n        });\r\n        component.addLocalHook('change', function (command) {\r\n          return _this2.onComponentChange(component, command);\r\n        });\r\n        return component;\r\n      };\r\n\r\n      var filterByConditionLabel = function filterByConditionLabel() {\r\n        return \"\".concat(_this2.hot.getTranslatedPhrase(constants.FILTERS_DIVS_FILTER_BY_CONDITION), \":\");\r\n      };\r\n\r\n      var filterValueLabel = function filterValueLabel() {\r\n        return \"\".concat(_this2.hot.getTranslatedPhrase(constants.FILTERS_DIVS_FILTER_BY_VALUE), \":\");\r\n      };\r\n\r\n      if (!this.components.get('filter_by_condition')) {\r\n        var conditionComponent = new ConditionComponent(this.hot, {\r\n          id: 'filter_by_condition',\r\n          name: filterByConditionLabel,\r\n          addSeparator: false,\r\n          menuContainer: menuContainer\r\n        });\r\n        conditionComponent.addLocalHook('afterClose', function () {\r\n          return _this2.onSelectUIClosed();\r\n        });\r\n        this.components.set('filter_by_condition', addConfirmationHooks(conditionComponent));\r\n      }\r\n\r\n      if (!this.components.get('filter_operators')) {\r\n        this.components.set('filter_operators', new OperatorsComponent(this.hot, {\r\n          id: 'filter_operators',\r\n          name: 'Operators'\r\n        }));\r\n      }\r\n\r\n      if (!this.components.get('filter_by_condition2')) {\r\n        var _conditionComponent = new ConditionComponent(this.hot, {\r\n          id: 'filter_by_condition2',\r\n          name: '',\r\n          addSeparator: true,\r\n          menuContainer: menuContainer\r\n        });\r\n\r\n        _conditionComponent.addLocalHook('afterClose', function () {\r\n          return _this2.onSelectUIClosed();\r\n        });\r\n\r\n        this.components.set('filter_by_condition2', addConfirmationHooks(_conditionComponent));\r\n      }\r\n\r\n      if (!this.components.get('filter_by_value')) {\r\n        this.components.set('filter_by_value', addConfirmationHooks(new ValueComponent(this.hot, {\r\n          id: 'filter_by_value',\r\n          name: filterValueLabel\r\n        })));\r\n      }\r\n\r\n      if (!this.components.get('filter_action_bar')) {\r\n        this.components.set('filter_action_bar', addConfirmationHooks(new ActionBarComponent(this.hot, {\r\n          id: 'filter_action_bar',\r\n          name: 'Action bar'\r\n        })));\r\n      }\r\n\r\n      if (!this.conditionCollection) {\r\n        this.conditionCollection = new ConditionCollection(this.hot);\r\n      }\r\n\r\n      if (!this.conditionUpdateObserver) {\r\n        this.conditionUpdateObserver = new ConditionUpdateObserver(this.hot, this.conditionCollection, function (physicalColumn) {\r\n          return _this2.getDataMapAtColumn(physicalColumn);\r\n        });\r\n        this.conditionUpdateObserver.addLocalHook('update', function (conditionState) {\r\n          return _this2.updateComponents(conditionState);\r\n        });\r\n      }\r\n\r\n      this.components.forEach(function (component) {\r\n        return component.show();\r\n      });\r\n      this.registerEvents();\r\n      this.addHook('beforeDropdownMenuSetItems', function (items) {\r\n        return _this2.onBeforeDropdownMenuSetItems(items);\r\n      });\r\n      this.addHook('afterDropdownMenuDefaultOptions', function (defaultOptions) {\r\n        return _this2.onAfterDropdownMenuDefaultOptions(defaultOptions);\r\n      });\r\n      this.addHook('afterDropdownMenuShow', function () {\r\n        return _this2.onAfterDropdownMenuShow();\r\n      });\r\n      this.addHook('afterDropdownMenuHide', function () {\r\n        return _this2.onAfterDropdownMenuHide();\r\n      });\r\n      this.addHook('afterChange', function (changes) {\r\n        return _this2.onAfterChange(changes);\r\n      }); // Temp. solution (extending menu items bug in contextMenu/dropdownMenu)\r\n\r\n      if (this.hot.getSettings().dropdownMenu && this.dropdownMenuPlugin) {\r\n        this.dropdownMenuPlugin.disablePlugin();\r\n        this.dropdownMenuPlugin.enablePlugin();\r\n      }\r\n\r\n      _get(_getPrototypeOf(Filters.prototype), \"enablePlugin\", this).call(this);\r\n    }\r\n    /**\r\n     * Registers the DOM listeners.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"registerEvents\",\r\n    value: function registerEvents() {\r\n      var _this3 = this;\r\n\r\n      this.eventManager.addEventListener(this.hot.rootElement, 'click', function (event) {\r\n        return _this3.onTableClick(event);\r\n      });\r\n    }\r\n    /**\r\n     * Disables the plugin functionality for this Handsontable instance.\r\n     */\r\n\r\n  }, {\r\n    key: \"disablePlugin\",\r\n    value: function disablePlugin() {\r\n      var _this4 = this;\r\n\r\n      if (this.enabled) {\r\n        var _this$dropdownMenuPlu;\r\n\r\n        if ((_this$dropdownMenuPlu = this.dropdownMenuPlugin) !== null && _this$dropdownMenuPlu !== void 0 && _this$dropdownMenuPlu.enabled) {\r\n          this.dropdownMenuPlugin.menu.clearLocalHooks();\r\n        }\r\n\r\n        this.components.forEach(function (component, key) {\r\n          component.destroy();\r\n\r\n          _this4.components.set(key, null);\r\n        });\r\n        this.conditionCollection.destroy();\r\n        this.conditionCollection = null;\r\n        this.hot.rowIndexMapper.unregisterMap(this.pluginName);\r\n      }\r\n\r\n      _get(_getPrototypeOf(Filters.prototype), \"disablePlugin\", this).call(this);\r\n    }\r\n    /* eslint-disable jsdoc/require-description-complete-sentence */\r\n\r\n    /**\r\n     * @memberof Filters#\r\n     * @function addCondition\r\n     * @description\r\n     * Adds condition to the conditions collection at specified column index.\r\n     *\r\n     * Possible predefined conditions:\r\n     *  * `begins_with` - Begins with\r\n     *  * `between` - Between\r\n     *  * `by_value` - By value\r\n     *  * `contains` - Contains\r\n     *  * `empty` - Empty\r\n     *  * `ends_with` - Ends with\r\n     *  * `eq` - Equal\r\n     *  * `gt` - Greater than\r\n     *  * `gte` - Greater than or equal\r\n     *  * `lt` - Less than\r\n     *  * `lte` - Less than or equal\r\n     *  * `none` - None (no filter)\r\n     *  * `not_between` - Not between\r\n     *  * `not_contains` - Not contains\r\n     *  * `not_empty` - Not empty\r\n     *  * `neq` - Not equal.\r\n     *\r\n     * Possible operations on collection of conditions:\r\n     *  * `conjunction` - [**Conjunction**](https://en.wikipedia.org/wiki/Logical_conjunction) on conditions collection (by default), i.e. for such operation: c1 AND c2 AND c3 AND c4 ... AND cn === TRUE, where c1 ... cn are conditions.\r\n     *  * `disjunction` - [**Disjunction**](https://en.wikipedia.org/wiki/Logical_disjunction) on conditions collection, i.e. for such operation: `c1 OR c2 OR c3 OR c4 ... OR cn` === TRUE, where c1, c2, c3, c4 ... cn are conditions.\r\n     *  * `disjunctionWithExtraCondition` - **Disjunction** on first `n - 1`\\* conditions from collection with an extra requirement computed from the last condition, i.e. for such operation: `c1 OR c2 OR c3 OR c4 ... OR cn-1 AND cn` === TRUE, where c1, c2, c3, c4 ... cn are conditions.\r\n     *\r\n     * \\* when `n` is collection size; it's used i.e. for one operation introduced from UI (when choosing from filter's drop-down menu two conditions with OR operator between them, mixed with choosing values from the multiple choice select)\r\n     *\r\n     * **Note**: Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, use it consequently for a particular column).\r\n     *\r\n     * @example\r\n     * ```js\r\n     * const container = document.getElementById('example');\r\n     * const hot = new Handsontable(container, {\r\n     *   data: getData(),\r\n     *   filters: true\r\n     * });\r\n     *\r\n     * // access to filters plugin instance\r\n     * const filtersPlugin = hot.getPlugin('filters');\r\n     *\r\n     * // add filter \"Greater than\" 95 to column at index 1\r\n     * filtersPlugin.addCondition(1, 'gt', [95]);\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"By value\" to column at index 1\r\n     * // in this case all value's that don't match will be filtered.\r\n     * filtersPlugin.addCondition(1, 'by_value', [['ing', 'ed', 'as', 'on']]);\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"Begins with\" with value \"de\" AND \"Not contains\" with value \"ing\"\r\n     * filtersPlugin.addCondition(1, 'begins_with', ['de'], 'conjunction');\r\n     * filtersPlugin.addCondition(1, 'not_contains', ['ing'], 'conjunction');\r\n     * filtersPlugin.filter();\r\n     *\r\n     * // add filter \"Begins with\" with value \"de\" OR \"Not contains\" with value \"ing\"\r\n     * filtersPlugin.addCondition(1, 'begins_with', ['de'], 'disjunction');\r\n     * filtersPlugin.addCondition(1, 'not_contains', ['ing'], 'disjunction');\r\n     * filtersPlugin.filter();\r\n     * ```\r\n     * @param {number} column Visual column index.\r\n     * @param {string} name Condition short name.\r\n     * @param {Array} args Condition arguments.\r\n     * @param {string} [operationId=conjunction] `id` of operation which is performed on the column.\r\n     */\r\n\r\n    /* eslint-enable jsdoc/require-description-complete-sentence */\r\n\r\n  }, {\r\n    key: \"addCondition\",\r\n    value: function addCondition(column, name, args) {\r\n      var operationId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : OPERATION_AND;\r\n      var physicalColumn = this.hot.toPhysicalColumn(column);\r\n      this.conditionCollection.addCondition(physicalColumn, {\r\n        command: {\r\n          key: name\r\n        },\r\n        args: args\r\n      }, operationId);\r\n    }\r\n    /**\r\n     * Removes conditions at specified column index.\r\n     *\r\n     * @param {number} column Visual column index.\r\n     */\r\n\r\n  }, {\r\n    key: \"removeConditions\",\r\n    value: function removeConditions(column) {\r\n      var physicalColumn = this.hot.toPhysicalColumn(column);\r\n      this.conditionCollection.removeConditions(physicalColumn);\r\n    }\r\n    /**\r\n     * Clears all conditions previously added to the collection for the specified column index or, if the column index\r\n     * was not passed, clear the conditions for all columns.\r\n     *\r\n     * @param {number} [column] Visual column index.\r\n     */\r\n\r\n  }, {\r\n    key: \"clearConditions\",\r\n    value: function clearConditions(column) {\r\n      if (column === void 0) {\r\n        this.conditionCollection.clean();\r\n      } else {\r\n        var physicalColumn = this.hot.toPhysicalColumn(column);\r\n        this.conditionCollection.removeConditions(physicalColumn);\r\n      }\r\n    }\r\n    /**\r\n     * Filters data based on added filter conditions.\r\n     *\r\n     * @fires Hooks#beforeFilter\r\n     * @fires Hooks#afterFilter\r\n     */\r\n\r\n  }, {\r\n    key: \"filter\",\r\n    value: function filter() {\r\n      var _this5 = this;\r\n\r\n      var dataFilter = this._createDataFilter();\r\n\r\n      var needToFilter = !this.conditionCollection.isEmpty();\r\n      var visibleVisualRows = [];\r\n      var conditions = this.conditionCollection.exportAllConditions();\r\n      var allowFiltering = this.hot.runHooks('beforeFilter', conditions);\r\n\r\n      if (allowFiltering !== false) {\r\n        if (needToFilter) {\r\n          var trimmedRows = [];\r\n          this.hot.batchExecution(function () {\r\n            _this5.filtersRowsMap.clear();\r\n\r\n            visibleVisualRows = arrayMap(dataFilter.filter(), function (rowData) {\r\n              return rowData.meta.visualRow;\r\n            });\r\n            var visibleVisualRowsAssertion = createArrayAssertion(visibleVisualRows);\r\n            rangeEach(_this5.hot.countSourceRows() - 1, function (row) {\r\n              if (!visibleVisualRowsAssertion(row)) {\r\n                trimmedRows.push(row);\r\n              }\r\n            });\r\n            arrayEach(trimmedRows, function (physicalRow) {\r\n              _this5.filtersRowsMap.setValueAtIndex(physicalRow, true);\r\n            });\r\n          }, true);\r\n\r\n          if (!visibleVisualRows.length) {\r\n            this.hot.deselectCell();\r\n          }\r\n        } else {\r\n          this.filtersRowsMap.clear();\r\n        }\r\n      }\r\n\r\n      this.hot.runHooks('afterFilter', conditions);\r\n      this.hot.view.adjustElementsSize(true);\r\n      this.hot.render();\r\n      this.clearColumnSelection();\r\n    }\r\n    /**\r\n     * Gets last selected column index.\r\n     *\r\n     * @returns {object|null} Return `null` when column isn't selected otherwise\r\n     * object containing information about selected column with keys `visualIndex` and `physicalIndex`.\r\n     */\r\n\r\n  }, {\r\n    key: \"getSelectedColumn\",\r\n    value: function getSelectedColumn() {\r\n      return this.lastSelectedColumn;\r\n    }\r\n    /**\r\n     * Clears column selection.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"clearColumnSelection\",\r\n    value: function clearColumnSelection() {\r\n      var _this$hot$getSelected;\r\n\r\n      var coords = (_this$hot$getSelected = this.hot.getSelectedRangeLast()) === null || _this$hot$getSelected === void 0 ? void 0 : _this$hot$getSelected.getTopLeftCorner();\r\n\r\n      if (coords !== void 0) {\r\n        this.hot.selectCell(coords.row, coords.col);\r\n      }\r\n    }\r\n    /**\r\n     * Returns handsontable source data with cell meta based on current selection.\r\n     *\r\n     * @param {number} [column] The physical column index. By default column index accept the value of the selected column.\r\n     * @returns {Array} Returns array of objects where keys as row index.\r\n     */\r\n\r\n  }, {\r\n    key: \"getDataMapAtColumn\",\r\n    value: function getDataMapAtColumn(column) {\r\n      var _this6 = this;\r\n\r\n      var visualIndex = this.hot.toVisualColumn(column);\r\n      var data = [];\r\n      arrayEach(this.hot.getSourceDataAtCol(visualIndex), function (value, rowIndex) {\r\n        var _this6$hot$getCellMet = _this6.hot.getCellMeta(rowIndex, visualIndex),\r\n            row = _this6$hot$getCellMet.row,\r\n            col = _this6$hot$getCellMet.col,\r\n            visualCol = _this6$hot$getCellMet.visualCol,\r\n            visualRow = _this6$hot$getCellMet.visualRow,\r\n            type = _this6$hot$getCellMet.type,\r\n            instance = _this6$hot$getCellMet.instance,\r\n            dateFormat = _this6$hot$getCellMet.dateFormat;\r\n\r\n        data.push({\r\n          meta: {\r\n            row: row,\r\n            col: col,\r\n            visualCol: visualCol,\r\n            visualRow: visualRow,\r\n            type: type,\r\n            instance: instance,\r\n            dateFormat: dateFormat\r\n          },\r\n          value: toEmptyString(value)\r\n        });\r\n      });\r\n      return data;\r\n    }\r\n    /**\r\n     * `afterChange` listener.\r\n     *\r\n     * @private\r\n     * @param {Array} changes Array of changes.\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterChange\",\r\n    value: function onAfterChange(changes) {\r\n      var _this7 = this;\r\n\r\n      if (changes) {\r\n        arrayEach(changes, function (change) {\r\n          var _change = _slicedToArray(change, 2),\r\n              prop = _change[1];\r\n\r\n          var columnIndex = _this7.hot.propToCol(prop);\r\n\r\n          if (_this7.conditionCollection.hasConditions(columnIndex)) {\r\n            _this7.updateValueComponentCondition(columnIndex);\r\n          }\r\n        });\r\n      }\r\n    }\r\n    /**\r\n     * Update condition of ValueComponent basing on handled changes.\r\n     *\r\n     * @private\r\n     * @param {number} columnIndex Column index of handled ValueComponent condition.\r\n     */\r\n\r\n  }, {\r\n    key: \"updateValueComponentCondition\",\r\n    value: function updateValueComponentCondition(columnIndex) {\r\n      var dataAtCol = this.hot.getDataAtCol(columnIndex);\r\n      var selectedValues = unifyColumnValues(dataAtCol);\r\n      this.conditionUpdateObserver.updateStatesAtColumn(columnIndex, selectedValues);\r\n    }\r\n    /**\r\n     * Restores components to its saved state.\r\n     *\r\n     * @private\r\n     * @param {Array} components List of components.\r\n     */\r\n\r\n  }, {\r\n    key: \"restoreComponents\",\r\n    value: function restoreComponents(components) {\r\n      var _this$getSelectedColu;\r\n\r\n      var physicalIndex = (_this$getSelectedColu = this.getSelectedColumn()) === null || _this$getSelectedColu === void 0 ? void 0 : _this$getSelectedColu.physicalIndex;\r\n      components.forEach(function (component) {\r\n        if (component.isHidden()) {\r\n          return;\r\n        }\r\n\r\n        component.restoreState(physicalIndex);\r\n      });\r\n      this.updateDependentComponentsVisibility();\r\n    }\r\n    /**\r\n     * After dropdown menu show listener.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterDropdownMenuShow\",\r\n    value: function onAfterDropdownMenuShow() {\r\n      this.restoreComponents(Array.from(this.components.values()));\r\n    }\r\n    /**\r\n     * After dropdown menu hide listener.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterDropdownMenuHide\",\r\n    value: function onAfterDropdownMenuHide() {\r\n      this.components.get('filter_by_condition').getSelectElement().closeOptions();\r\n      this.components.get('filter_by_condition2').getSelectElement().closeOptions();\r\n    }\r\n    /**\r\n     * Before dropdown menu set menu items listener.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"onBeforeDropdownMenuSetItems\",\r\n    value: function onBeforeDropdownMenuSetItems() {\r\n      var _this8 = this;\r\n\r\n      if (this.dropdownMenuPlugin) {\r\n        this.dropdownMenuPlugin.menu.addLocalHook('afterOpen', function () {\r\n          _this8.dropdownMenuPlugin.menu.hotMenu.updateSettings({\r\n            hiddenRows: true\r\n          });\r\n        });\r\n      }\r\n    }\r\n    /**\r\n     * After dropdown menu default options listener.\r\n     *\r\n     * @private\r\n     * @param {object} defaultOptions ContextMenu default item options.\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterDropdownMenuDefaultOptions\",\r\n    value: function onAfterDropdownMenuDefaultOptions(defaultOptions) {\r\n      defaultOptions.items.push({\r\n        name: SEPARATOR\r\n      });\r\n      this.components.forEach(function (component) {\r\n        defaultOptions.items.push(component.getMenuItemDescriptor());\r\n      });\r\n    }\r\n    /**\r\n     * Get operation basing on number and type of arguments (where arguments are states of components).\r\n     *\r\n     * @param {string} suggestedOperation Operation which was chosen by user from UI.\r\n     * @param {object} byConditionState1 State of first condition component.\r\n     * @param {object} byConditionState2 State of second condition component.\r\n     * @param {object} byValueState State of value component.\r\n     * @private\r\n     * @returns {string}\r\n     */\r\n\r\n  }, {\r\n    key: \"getOperationBasedOnArguments\",\r\n    value: function getOperationBasedOnArguments(suggestedOperation, byConditionState1, byConditionState2, byValueState) {\r\n      var operation = suggestedOperation;\r\n\r\n      if (operation === OPERATION_OR && byConditionState1.command.key !== CONDITION_NONE && byConditionState2.command.key !== CONDITION_NONE && byValueState.command.key !== CONDITION_NONE) {\r\n        operation = OPERATION_OR_THEN_VARIABLE;\r\n      } else if (byValueState.command.key !== CONDITION_NONE) {\r\n        if (byConditionState1.command.key === CONDITION_NONE || byConditionState2.command.key === CONDITION_NONE) {\r\n          operation = OPERATION_AND;\r\n        }\r\n      }\r\n\r\n      return operation;\r\n    }\r\n    /**\r\n     * On action bar submit listener.\r\n     *\r\n     * @private\r\n     * @param {string} submitType The submit type.\r\n     */\r\n\r\n  }, {\r\n    key: \"onActionBarSubmit\",\r\n    value: function onActionBarSubmit(submitType) {\r\n      if (submitType === 'accept') {\r\n        var _this$getSelectedColu2;\r\n\r\n        var physicalIndex = (_this$getSelectedColu2 = this.getSelectedColumn()) === null || _this$getSelectedColu2 === void 0 ? void 0 : _this$getSelectedColu2.physicalIndex;\r\n        var byConditionState1 = this.components.get('filter_by_condition').getState();\r\n        var byConditionState2 = this.components.get('filter_by_condition2').getState();\r\n        var byValueState = this.components.get('filter_by_value').getState();\r\n        var operation = this.getOperationBasedOnArguments(this.components.get('filter_operators').getActiveOperationId(), byConditionState1, byConditionState2, byValueState);\r\n        this.conditionUpdateObserver.groupChanges();\r\n        var columnStackPosition = this.conditionCollection.getColumnStackPosition(physicalIndex);\r\n\r\n        if (columnStackPosition === -1) {\r\n          columnStackPosition = void 0;\r\n        }\r\n\r\n        this.conditionCollection.removeConditions(physicalIndex);\r\n\r\n        if (byConditionState1.command.key !== CONDITION_NONE) {\r\n          this.conditionCollection.addCondition(physicalIndex, byConditionState1, operation, columnStackPosition);\r\n\r\n          if (byConditionState2.command.key !== CONDITION_NONE) {\r\n            this.conditionCollection.addCondition(physicalIndex, byConditionState2, operation, columnStackPosition);\r\n          }\r\n        }\r\n\r\n        if (byValueState.command.key !== CONDITION_NONE) {\r\n          this.conditionCollection.addCondition(physicalIndex, byValueState, operation, columnStackPosition);\r\n        }\r\n\r\n        this.conditionUpdateObserver.flush();\r\n        this.components.forEach(function (component) {\r\n          return component.saveState(physicalIndex);\r\n        });\r\n        this.filtersRowsMap.clear();\r\n        this.filter();\r\n      }\r\n\r\n      if (this.dropdownMenuPlugin) {\r\n        this.dropdownMenuPlugin.close();\r\n      }\r\n    }\r\n    /**\r\n     * On component change listener.\r\n     *\r\n     * @private\r\n     * @param {BaseComponent} component Component inheriting BaseComponent.\r\n     * @param {object} command Menu item object (command).\r\n     */\r\n\r\n  }, {\r\n    key: \"onComponentChange\",\r\n    value: function onComponentChange(component, command) {\r\n      this.updateDependentComponentsVisibility();\r\n\r\n      if (component.constructor === ConditionComponent && !command.inputsCount) {\r\n        this.setListeningDropdownMenu();\r\n      }\r\n    }\r\n    /**\r\n     * On component SelectUI closed listener.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"onSelectUIClosed\",\r\n    value: function onSelectUIClosed() {\r\n      this.setListeningDropdownMenu();\r\n    }\r\n    /**\r\n     * Listen to the keyboard input on document body and forward events to instance of Handsontable\r\n     * created by DropdownMenu plugin.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"setListeningDropdownMenu\",\r\n    value: function setListeningDropdownMenu() {\r\n      if (this.dropdownMenuPlugin) {\r\n        this.dropdownMenuPlugin.setListening();\r\n      }\r\n    }\r\n    /**\r\n     * Updates visibility of the some of the components based on the state of the parent component.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"updateDependentComponentsVisibility\",\r\n    value: function updateDependentComponentsVisibility() {\r\n      var component = this.components.get('filter_by_condition');\r\n\r\n      var _component$getState = component.getState(),\r\n          command = _component$getState.command;\r\n\r\n      var componentsToShow = [this.components.get('filter_by_condition2'), this.components.get('filter_operators')];\r\n\r\n      if (command.showOperators) {\r\n        this.showComponents.apply(this, componentsToShow);\r\n      } else {\r\n        this.hideComponents.apply(this, componentsToShow);\r\n      }\r\n    }\r\n    /**\r\n     * On after get column header listener.\r\n     *\r\n     * @private\r\n     * @param {number} col Visual column index.\r\n     * @param {HTMLTableCellElement} TH Header's TH element.\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterGetColHeader\",\r\n    value: function onAfterGetColHeader(col, TH) {\r\n      var physicalColumn = this.hot.toPhysicalColumn(col);\r\n\r\n      if (this.enabled && this.conditionCollection.hasConditions(physicalColumn)) {\r\n        addClass(TH, 'htFiltersActive');\r\n      } else {\r\n        removeClass(TH, 'htFiltersActive');\r\n      }\r\n    }\r\n    /**\r\n     * On table click listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event DOM Event.\r\n     */\r\n\r\n  }, {\r\n    key: \"onTableClick\",\r\n    value: function onTableClick(event) {\r\n      var th = closest(event.target, 'TH');\r\n\r\n      if (th) {\r\n        var visualIndex = this.hot.getCoords(th).col;\r\n        var physicalIndex = this.hot.toPhysicalColumn(visualIndex);\r\n        this.lastSelectedColumn = {\r\n          visualIndex: visualIndex,\r\n          physicalIndex: physicalIndex\r\n        };\r\n      }\r\n    }\r\n    /**\r\n     * Creates DataFilter instance based on condition collection.\r\n     *\r\n     * @private\r\n     * @param {ConditionCollection} conditionCollection Condition collection object.\r\n     * @returns {DataFilter}\r\n     */\r\n\r\n  }, {\r\n    key: \"_createDataFilter\",\r\n    value: function _createDataFilter() {\r\n      var _this9 = this;\r\n\r\n      var conditionCollection = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.conditionCollection;\r\n      return new DataFilter(conditionCollection, function (physicalColumn) {\r\n        return _this9.getDataMapAtColumn(physicalColumn);\r\n      });\r\n    }\r\n    /**\r\n     * It updates the components state. The state is triggered by ConditionUpdateObserver, which\r\n     * reacts to any condition added to the condition collection. It may be added through the UI\r\n     * components or by API call.\r\n     *\r\n     * @private\r\n     * @param {object} conditionsState An object with the state generated by UI components.\r\n     */\r\n\r\n  }, {\r\n    key: \"updateComponents\",\r\n    value: function updateComponents(conditionsState) {\r\n      var _this$dropdownMenuPlu2;\r\n\r\n      if (!((_this$dropdownMenuPlu2 = this.dropdownMenuPlugin) !== null && _this$dropdownMenuPlu2 !== void 0 && _this$dropdownMenuPlu2.enabled)) {\r\n        return;\r\n      }\r\n\r\n      var _conditionsState$edit = conditionsState.editedConditionStack,\r\n          conditions = _conditionsState$edit.conditions,\r\n          column = _conditionsState$edit.column;\r\n      var conditionsByValue = conditions.filter(function (condition) {\r\n        return condition.name === CONDITION_BY_VALUE;\r\n      });\r\n      var conditionsWithoutByValue = conditions.filter(function (condition) {\r\n        return condition.name !== CONDITION_BY_VALUE;\r\n      });\r\n\r\n      if (conditionsByValue.length >= 2 || conditionsWithoutByValue.length >= 3) {\r\n        warn(toSingleLine(_templateObject || (_templateObject = _taggedTemplateLiteral([\"The filter conditions have been applied properly, but couldn\\u2019t be displayed visually. \\n        The overall amount of conditions exceed the capability of the dropdown menu. \\n        For more details see the documentation.\"], [\"The filter conditions have been applied properly, but couldn\\u2019t be displayed visually.\\\\x20\\n        The overall amount of conditions exceed the capability of the dropdown menu.\\\\x20\\n        For more details see the documentation.\"]))));\r\n      } else {\r\n        var operationType = this.conditionCollection.getOperation(column);\r\n        this.components.get('filter_by_condition').updateState(conditionsWithoutByValue[0], column);\r\n        this.components.get('filter_by_condition2').updateState(conditionsWithoutByValue[1], column);\r\n        this.components.get('filter_operators').updateState(operationType, column);\r\n        this.components.get('filter_by_value').updateState(conditionsState);\r\n      }\r\n    }\r\n    /**\r\n     * Returns indexes of passed components inside list of `dropdownMenu` items.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     * @returns {Array}\r\n     */\r\n\r\n  }, {\r\n    key: \"getIndexesOfComponents\",\r\n    value: function getIndexesOfComponents() {\r\n      var indexes = [];\r\n\r\n      if (!this.dropdownMenuPlugin) {\r\n        return indexes;\r\n      }\r\n\r\n      var menu = this.dropdownMenuPlugin.menu;\r\n\r\n      for (var _len = arguments.length, components = new Array(_len), _key = 0; _key < _len; _key++) {\r\n        components[_key] = arguments[_key];\r\n      }\r\n\r\n      arrayEach(components, function (component) {\r\n        arrayEach(menu.menuItems, function (item, index) {\r\n          if (item.key === component.getMenuItemDescriptor().key) {\r\n            indexes.push(index);\r\n          }\r\n        });\r\n      });\r\n      return indexes;\r\n    }\r\n    /**\r\n     * Changes visibility of component.\r\n     *\r\n     * @private\r\n     * @param {boolean} visible Determine if components should be visible.\r\n     * @param {...BaseComponent} components List of components.\r\n     */\r\n\r\n  }, {\r\n    key: \"changeComponentsVisibility\",\r\n    value: function changeComponentsVisibility() {\r\n      var visible = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\r\n\r\n      if (!this.dropdownMenuPlugin) {\r\n        return;\r\n      }\r\n\r\n      var menu = this.dropdownMenuPlugin.menu;\r\n      var hotMenu = menu.hotMenu;\r\n      var hiddenRows = hotMenu.getPlugin('hiddenRows');\r\n\r\n      for (var _len2 = arguments.length, components = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\r\n        components[_key2 - 1] = arguments[_key2];\r\n      }\r\n\r\n      var indexes = this.getIndexesOfComponents.apply(this, components);\r\n\r\n      if (visible) {\r\n        hiddenRows.showRows(indexes);\r\n      } else {\r\n        hiddenRows.hideRows(indexes);\r\n      }\r\n\r\n      hotMenu.render();\r\n    }\r\n    /**\r\n     * Hides components of filters `dropdownMenu`.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     */\r\n\r\n  }, {\r\n    key: \"hideComponents\",\r\n    value: function hideComponents() {\r\n      for (var _len3 = arguments.length, components = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\r\n        components[_key3] = arguments[_key3];\r\n      }\r\n\r\n      this.changeComponentsVisibility.apply(this, [false].concat(components));\r\n    }\r\n    /**\r\n     * Shows components of filters `dropdownMenu`.\r\n     *\r\n     * @private\r\n     * @param {...BaseComponent} components List of components.\r\n     */\r\n\r\n  }, {\r\n    key: \"showComponents\",\r\n    value: function showComponents() {\r\n      for (var _len4 = arguments.length, components = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\r\n        components[_key4] = arguments[_key4];\r\n      }\r\n\r\n      this.changeComponentsVisibility.apply(this, [true].concat(components));\r\n    }\r\n    /**\r\n     * Destroys the plugin instance.\r\n     */\r\n\r\n  }, {\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      var _this10 = this;\r\n\r\n      if (this.enabled) {\r\n        this.components.forEach(function (component, key) {\r\n          if (component !== null) {\r\n            component.destroy();\r\n\r\n            _this10.components.set(key, null);\r\n          }\r\n        });\r\n        this.conditionCollection.destroy();\r\n        this.conditionUpdateObserver.destroy();\r\n        this.hot.rowIndexMapper.unregisterMap(this.pluginName);\r\n      }\r\n\r\n      _get(_getPrototypeOf(Filters.prototype), \"destroy\", this).call(this);\r\n    }\r\n  }], [{\r\n    key: \"PLUGIN_KEY\",\r\n    get: function get() {\r\n      return PLUGIN_KEY;\r\n    }\r\n  }, {\r\n    key: \"PLUGIN_PRIORITY\",\r\n    get: function get() {\r\n      return PLUGIN_PRIORITY;\r\n    }\r\n  }, {\r\n    key: \"PLUGIN_DEPS\",\r\n    get: function get() {\r\n      return ['plugin:DropdownMenu', 'plugin:HiddenRows', 'cell-type:checkbox'];\r\n    }\r\n  }]);\r\n\r\n  return Filters;\r\n}(BasePlugin);"]},"metadata":{},"sourceType":"module"}