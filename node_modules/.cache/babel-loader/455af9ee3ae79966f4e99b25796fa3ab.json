{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nimport { HandsontableEditor } from \"../handsontableEditor/index.mjs\";\nimport { arrayMap, pivot } from \"../../helpers/array.mjs\";\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, getTrimmingContainer, offset, outerHeight, outerWidth, setCaretPosition } from \"../../helpers/dom/element.mjs\";\nimport { isDefined, stringify } from \"../../helpers/mixed.mjs\";\nimport { stripTags } from \"../../helpers/string.mjs\";\nimport { KEY_CODES, isPrintableChar } from \"../../helpers/unicode.mjs\";\nimport { textRenderer } from \"../../renderers/textRenderer/index.mjs\";\nvar privatePool = new WeakMap();\nexport var EDITOR_TYPE = 'autocomplete';\n/**\n * @private\n * @class AutocompleteEditor\n */\n\nexport var AutocompleteEditor = /*#__PURE__*/function (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n\n  var _super = _createSuper(AutocompleteEditor);\n\n  function AutocompleteEditor(instance) {\n    var _this;\n\n    _classCallCheck(this, AutocompleteEditor);\n\n    _this = _super.call(this, instance);\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {string}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {string[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false,\n      isMacOS: _this.hot.rootWindow.navigator.platform.indexOf('Mac') > -1\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {string}\n   */\n\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n\n      var priv = privatePool.get(this);\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth();\n\n      if (scrollbarWidth === 0 && priv.isMacOS) {\n        scrollbarWidth += 15; // default scroll bar width if scroll bars are visible only when scrolling\n      }\n\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth : void 0,\n        renderer: function renderer(instance, TD, row, col, prop, value, cellProperties) {\n          textRenderer(instance, TD, row, col, prop, value, cellProperties);\n          var _this3$cellProperties = _this3.cellProperties,\n              filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n              allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true\n      });\n\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes.\n     *\n     * @param {boolean|undefined} result If `false` and the cell using allowInvalid option,\n     *                                   then an editor won't be closed until validation is passed.\n     */\n\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {string} query The query.\n     */\n\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n\n      var source = this.cellProperties.source;\n      this.query = query;\n\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList The choices list to process.\n     */\n\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n\n        highlightIndex = 0;\n        choices = sorted;\n      }\n\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n\n      this.hot.listen();\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {number} spaceAvailable The free space as height definded in px available for dropdown list.\n     * @param {number} dropdownHeight The dropdown height.\n     */\n\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n\n        height = tempHeight - lastRowHeight;\n\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\"); // eslint-disable-line max-len\n        }\n\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {number} dropdownHeight The dropdown height.\n     */\n\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {number} height The new dropdown height.\n     */\n\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {number|undefined} index The visual row index.\n     */\n\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {number}\n     */\n\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8; // eslint-disable-line max-len\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {string} value The value to sanitize.\n     * @returns {string}\n     */\n\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {string[]} values The value to sanitize.\n     * @returns {string[]}\n     */\n\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {number} keyCode The keyboard keycode.\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n\n      return allowed;\n    }\n    /**\n     * OnBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event The keyboard event object.\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }], [{\n    key: \"EDITOR_TYPE\",\n    get: function get() {\n      return EDITOR_TYPE;\n    }\n  }]);\n\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param {*} value The selected value.\n * @param {string[]} choices The list of available choices.\n * @param {boolean} caseSensitive Indicates if it's sorted by case.\n * @returns {number[]} Array of indexes in original choices array.\n */\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var result = [];\n  var valueLength = value.length;\n  var choicesCount = choices.length;\n  var charsLeft;\n  var currentItem;\n  var i;\n  var valueIndex;\n\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n\n    return result;\n  }\n\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n\n    if (a.index === -1) {\n      return 1;\n    }\n\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n\n    return 0;\n  });\n\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n\n  return result;\n};","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/handsontable/editors/autocompleteEditor/autocompleteEditor.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","value","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","HandsontableEditor","arrayMap","pivot","addClass","getCaretPosition","getScrollbarWidth","getSelectionEndPosition","getTrimmingContainer","offset","outerHeight","outerWidth","setCaretPosition","isDefined","stringify","stripTags","KEY_CODES","isPrintableChar","textRenderer","privatePool","WeakMap","EDITOR_TYPE","AutocompleteEditor","_HandsontableEditor","_super","_this","query","strippedChoices","rawChoices","set","skipOne","isMacOS","hot","rootWindow","navigator","platform","indexOf","getValue","_this2","selectedValue","find","strippedValue","stripValueIfNeeded","TEXTAREA","createElements","htContainer","open","_this3","priv","choicesListHot","htEditor","getInstance","trimDropdown","cellProperties","showEditableElement","focus","scrollbarWidth","updateSettings","colWidths","width","renderer","TD","row","col","prop","_this3$cellProperties","filteringCaseSensitive","allowHtml","cellValue","indexOfMatch","match","toLowerCase","substr","replace","concat","innerHTML","autoColumnSize","_registerTimeout","queryChoices","close","removeHooksByKey","discardEditor","view","render","_this4","source","choices","updateChoicesList","stripValuesIfNeeded","Array","isArray","choicesList","pos","endPos","sortByRelevanceSetting","sortByRelevance","filterSetting","filter","orderByRelevance","highlightIndex","orderByRelevanceLength","sorted","choicesCount","push","loadData","updateDropdownHeight","flipDropdownIfNeeded","strict","highlightBestMatchingChoice","listen","textareaOffset","textareaHeight","dropdownHeight","getDropdownHeight","trimmingContainer","wt","wtTable","TABLE","trimmingContainerScrollTop","scrollTop","headersHeight","THEAD","containerOffset","spaceAbove","top","spaceBelow","scrollHeight","flipNeeded","flipDropdown","unflipDropdown","limitDropdownIfNeeded","spaceAvailable","tempHeight","lastRowHeight","height","getRowHeight","wtSettings","settings","defaultRowHeight","flipped","rootElement","style","parseInt","setDropdownHeight","dropdownStyle","position","currentDropdownWidth","getColWidth","rootDocument","alignOverlaysWithTrimmingContainer","index","selectCell","deselectCell","firstRowHeight","visibleRows","values","stringifiedValues","strippedValues","allowKeyEventPropagation","keyCode","selectedRange","getSelectedRangeLast","selected","from","allowed","ARROW_DOWN","countRows","ARROW_UP","onBeforeKeyDown","event","_this5","BACKSPACE","DELETE","INSERT","timeOffset","C","ctrlKey","metaKey","isOpened","caseSensitive","choicesRelevance","valueLength","charsLeft","currentItem","valueIndex","baseIndex","sort","a","b"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.weak-map.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.object.set-prototype-of.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport { HandsontableEditor } from \"../handsontableEditor/index.mjs\";\nimport { arrayMap, pivot } from \"../../helpers/array.mjs\";\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, getTrimmingContainer, offset, outerHeight, outerWidth, setCaretPosition } from \"../../helpers/dom/element.mjs\";\nimport { isDefined, stringify } from \"../../helpers/mixed.mjs\";\nimport { stripTags } from \"../../helpers/string.mjs\";\nimport { KEY_CODES, isPrintableChar } from \"../../helpers/unicode.mjs\";\nimport { textRenderer } from \"../../renderers/textRenderer/index.mjs\";\nvar privatePool = new WeakMap();\nexport var EDITOR_TYPE = 'autocomplete';\n/**\n * @private\n * @class AutocompleteEditor\n */\n\nexport var AutocompleteEditor = /*#__PURE__*/function (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n\n  var _super = _createSuper(AutocompleteEditor);\n\n  function AutocompleteEditor(instance) {\n    var _this;\n\n    _classCallCheck(this, AutocompleteEditor);\n\n    _this = _super.call(this, instance);\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {string}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {string[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false,\n      isMacOS: _this.hot.rootWindow.navigator.platform.indexOf('Mac') > -1\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {string}\n   */\n\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n\n      var priv = privatePool.get(this);\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth();\n\n      if (scrollbarWidth === 0 && priv.isMacOS) {\n        scrollbarWidth += 15; // default scroll bar width if scroll bars are visible only when scrolling\n      }\n\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth : void 0,\n        renderer: function renderer(instance, TD, row, col, prop, value, cellProperties) {\n          textRenderer(instance, TD, row, col, prop, value, cellProperties);\n          var _this3$cellProperties = _this3.cellProperties,\n              filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n              allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true\n      });\n\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes.\n     *\n     * @param {boolean|undefined} result If `false` and the cell using allowInvalid option,\n     *                                   then an editor won't be closed until validation is passed.\n     */\n\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {string} query The query.\n     */\n\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n\n      var source = this.cellProperties.source;\n      this.query = query;\n\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList The choices list to process.\n     */\n\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n\n        highlightIndex = 0;\n        choices = sorted;\n      }\n\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n\n      this.hot.listen();\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {number} spaceAvailable The free space as height definded in px available for dropdown list.\n     * @param {number} dropdownHeight The dropdown height.\n     */\n\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n\n        height = tempHeight - lastRowHeight;\n\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\"); // eslint-disable-line max-len\n        }\n\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {number} dropdownHeight The dropdown height.\n     */\n\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {number} height The new dropdown height.\n     */\n\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {number|undefined} index The visual row index.\n     */\n\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {number}\n     */\n\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8; // eslint-disable-line max-len\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {string} value The value to sanitize.\n     * @returns {string}\n     */\n\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {string[]} values The value to sanitize.\n     * @returns {string[]}\n     */\n\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {number} keyCode The keyboard keycode.\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n\n      return allowed;\n    }\n    /**\n     * OnBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event The keyboard event object.\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }], [{\n    key: \"EDITOR_TYPE\",\n    get: function get() {\n      return EDITOR_TYPE;\n    }\n  }]);\n\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param {*} value The selected value.\n * @param {string[]} choices The list of available choices.\n * @param {boolean} caseSensitive Indicates if it's sorted by case.\n * @returns {number[]} Array of indexes in original choices array.\n */\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var result = [];\n  var valueLength = value.length;\n  var choicesCount = choices.length;\n  var charsLeft;\n  var currentItem;\n  var i;\n  var valueIndex;\n\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n\n    return result;\n  }\n\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n\n    if (a.index === -1) {\n      return 1;\n    }\n\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n\n    return 0;\n  });\n\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n\n  return result;\n};"]},"metadata":{},"sourceType":"module"}