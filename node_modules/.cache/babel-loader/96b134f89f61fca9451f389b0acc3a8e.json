{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\isotracker-dev\\\\isotracker-react\\\\src\\\\components\\\\elecExcel\\\\elecExcel.js\";\nimport React from 'react';\nimport 'antd/dist/antd.css';\nimport { HotTable } from '@handsontable/react';\nimport 'handsontable/dist/handsontable.full.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass ElecExcel extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      searchText: '',\n      searchedColumn: '',\n      typesData: [],\n      stepsData: [],\n      progressData: [],\n      tab: this.props.currentTab,\n      selectedRows: [],\n      selectedRowsKeys: [],\n      updateData: this.props.updateData,\n      username: \"\",\n      acronyms: null,\n      steps: []\n    };\n  }\n\n  async componentDidMount() {\n    const options = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/electrical/types\", options).then(response => response.json()).then(json => {\n      var rows = [];\n      var row = null;\n      rows.push({\n        \"Code\": \"Code\",\n        \"Name\": \"Name\",\n        \"Weight\": \"Weight\"\n      });\n\n      for (let i = 0; i < json.rows.length; i++) {\n        row = {\n          \"Code\": json.rows[i].code,\n          \"Name\": json.rows[i].name,\n          \"Weight\": json.rows[i].weight\n        };\n\n        for (let j = 0; j < this.state.steps.length; j++) {\n          let currentStep = this.state.steps[j].toString();\n          row[currentStep] = json.rows[i][currentStep];\n        }\n\n        rows.push(row);\n      }\n\n      this.setState({\n        typesData: rows,\n        selectedRows: []\n      });\n    });\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/electrical/steps\", options).then(response => response.json()).then(json => {\n      var rows = [];\n      var row = null;\n      rows.push({\n        \"Name\": \"Name\",\n        \"Percentage\": \"Percentage\"\n      });\n\n      for (let i = 0; i < json.steps.length; i++) {\n        row = {\n          \"Name\": json.names[i].name,\n          \"Percentage\": json.steps[i].percentage\n        };\n        rows.push(row);\n      }\n\n      this.setState({\n        stepsData: rows,\n        selectedRows: []\n      });\n    });\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/gelecs\", options).then(response => response.json()).then(json => {\n      var rows = [];\n      var row = null;\n      rows.push({\n        \"Week\": \"Week\",\n        \"Estimated\": \"Estimated\"\n      });\n\n      for (let i = 0; i < json.rows.length; i++) {\n        row = {\n          \"Week\": json.rows[i].week,\n          \"Estimated\": json.rows[i].estimated\n        };\n        rows.push(row);\n      }\n\n      this.setState({\n        progressData: rows,\n        selectedRows: []\n      });\n    });\n  }\n\n  addRowTypes() {\n    let rows = this.state.typesData;\n    rows.push({\n      \"Code\": \"\",\n      \"Name\": \"\",\n      \"Weight\": \"\"\n    });\n    this.setState({\n      typesData: rows\n    });\n  }\n\n  submitChangesTypes() {\n    const body = {\n      rows: this.state.typesData\n    };\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    };\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/submit/electrical/types\", options).then(response => response.json()).then(json => {\n      if (json.error) {\n        console.log(\"error\");\n      } else {\n        console.log(\"success\");\n      }\n    });\n  }\n\n  addRowSteps() {\n    let rows = this.state.stepsData;\n    rows.push({\n      \"Name\": \"\",\n      \"Percentage\": \"\"\n    });\n    this.setState({\n      stepsData: rows\n    });\n  }\n\n  submitChangesSteps() {\n    const body = {\n      rows: this.state.stepsData\n    };\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    };\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/submit/electrical/steps\", options).then(response => response.json()).then(json => {\n      if (json.error) {\n        console.log(\"error\");\n      } else {\n        console.log(\"success\");\n      }\n    });\n  }\n\n  addRowProgress() {\n    let rows = this.state.progressData;\n    rows.push({\n      \"Week\": \"\",\n      \"Estimated\": \"\"\n    });\n    this.setState({\n      progressData: rows\n    });\n  }\n\n  submitChangesProgress() {\n    const body = {\n      rows: this.state.progressData\n    };\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    };\n    fetch(\"http://\" + process.env.REACT_APP_SERVER + \":\" + process.env.REACT_APP_NODE_PORT + \"/submit/electrical/progress\", options).then(response => response.json()).then(json => {\n      if (json.error) {\n        console.log(\"error\");\n      } else {\n        console.log(\"success\");\n      }\n    });\n  }\n\n  render() {\n    const typesSettings = {\n      licenseKey: 'non-commercial-and-evaluation',\n      colWidths: 200 //... other options\n\n    };\n    const stepsSettings = {\n      licenseKey: 'non-commercial-and-evaluation',\n      colWidths: 200 //... other options\n\n    };\n    const progressSettings = {\n      licenseKey: 'non-commercial-and-evaluation',\n      colWidths: 195 //... other options\n\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      style: {\n        float: \"left\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"column\",\n        style: {\n          marginLeft: \"20px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"hot-app\",\n          children: [/*#__PURE__*/_jsxDEV(HotTable, {\n            data: this.state.stepsData,\n            colHeaders: true,\n            rowHeaders: true,\n            width: \"473\",\n            height: \"500\",\n            settings: stepsSettings,\n            manualColumnResize: true,\n            manualRowResize: true,\n            columns: [{\n              data: \"Name\"\n            }, {\n              data: \"Percentage\",\n              type: \"numeric\"\n            }]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-info\",\n              onClick: () => this.addRowSteps(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Add\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-success\",\n              onClick: () => this.submitChangesSteps(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 12\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"column\",\n        style: {\n          marginLeft: \"19px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"hot-app\",\n          children: [/*#__PURE__*/_jsxDEV(HotTable, {\n            data: this.state.typesData,\n            colHeaders: true,\n            rowHeaders: true,\n            width: \"675\",\n            height: \"500\",\n            settings: typesSettings,\n            manualColumnResize: true,\n            manualRowResize: true,\n            columns: [{\n              data: \"Code\"\n            }, {\n              data: \"Name\"\n            }, {\n              data: \"Weight\",\n              type: \"numeric\"\n            }]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-info\",\n              onClick: () => this.addRowTypes(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Add\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-success\",\n              onClick: () => this.submitChangesTypes(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"column\",\n        style: {\n          marginLeft: \"20px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"hot-app\",\n          children: [/*#__PURE__*/_jsxDEV(HotTable, {\n            data: this.state.progressData,\n            colHeaders: true,\n            rowHeaders: true,\n            width: \"465\",\n            height: \"500\",\n            settings: progressSettings,\n            manualColumnResize: true,\n            manualRowResize: true,\n            columns: [{\n              data: \"Week\",\n              type: \"numeric\"\n            }, {\n              data: \"Estimated\",\n              type: \"numeric\"\n            }]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-info\",\n              onClick: () => this.addRowProgress(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Add\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-sm btn-success\",\n              onClick: () => this.submitChangesProgress(),\n              style: {\n                marginRight: \"5px\",\n                fontSize: \"16px\",\n                width: \"60px\"\n              },\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this);\n  }\n\n}\n\nexport default ElecExcel;","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/src/components/elecExcel/elecExcel.js"],"names":["React","HotTable","ElecExcel","Component","state","searchText","searchedColumn","typesData","stepsData","progressData","tab","props","currentTab","selectedRows","selectedRowsKeys","updateData","username","acronyms","steps","componentDidMount","options","method","headers","fetch","process","env","REACT_APP_SERVER","REACT_APP_NODE_PORT","then","response","json","rows","row","push","i","length","code","name","weight","j","currentStep","toString","setState","names","percentage","week","estimated","addRowTypes","submitChangesTypes","body","JSON","stringify","error","console","log","addRowSteps","submitChangesSteps","addRowProgress","submitChangesProgress","render","typesSettings","licenseKey","colWidths","stepsSettings","progressSettings","float","marginLeft","data","type","marginRight","fontSize","width"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport { HotTable } from '@handsontable/react';\r\nimport 'handsontable/dist/handsontable.full.css';\r\n\r\nclass ElecExcel extends React.Component{\r\n  state = {\r\n    searchText: '',\r\n    searchedColumn: '',\r\n    typesData: [],\r\n    stepsData: [],\r\n    progressData: [],\r\n    tab: this.props.currentTab,\r\n    selectedRows: [],\r\n    selectedRowsKeys: [],\r\n    updateData: this.props.updateData,\r\n    username: \"\",\r\n    acronyms : null,\r\n    steps: []\r\n  };\r\n\r\n  async componentDidMount(){\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n    }\r\n\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/electrical/types\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Code\": \"Code\", \"Name\": \"Name\", \"Weight\": \"Weight\"})\r\n      for(let i = 0; i < json.rows.length; i++){\r\n\r\n          row = {\"Code\": json.rows[i].code, \"Name\": json.rows[i].name, \"Weight\": json.rows[i].weight}\r\n\r\n          for(let j = 0; j < this.state.steps.length; j++){\r\n            let currentStep = this.state.steps[j].toString()\r\n            row[currentStep] = json.rows[i][currentStep]\r\n          }\r\n          rows.push(row)\r\n      }\r\n      this.setState({typesData : rows, selectedRows: []});\r\n\r\n  }) \r\n\r\n  fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/electrical/steps\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Name\":\"Name\", \"Percentage\":\"Percentage\"})\r\n      for(let i = 0; i < json.steps.length; i++){\r\n          row = {\"Name\": json.names[i].name, \"Percentage\": json.steps[i].percentage}\r\n\r\n          rows.push(row)\r\n      }\r\n      this.setState({stepsData : rows, selectedRows: []});\r\n\r\n  })\r\n\r\n  fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/gelecs\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Week\": \"Week\", \"Estimated\": \"Estimated\"})\r\n      for(let i = 0; i < json.rows.length; i++){\r\n          row = {\"Week\": json.rows[i].week, \"Estimated\": json.rows[i].estimated}\r\n\r\n          rows.push(row)\r\n      }\r\n      this.setState({progressData : rows, selectedRows: []});\r\n\r\n  })\r\n  }\r\n\r\n  addRowTypes(){\r\n    let rows = this.state.typesData\r\n    rows.push({\"Code\": \"\", \"Name\":\"\", \"Weight\": \"\"})\r\n    this.setState({typesData: rows})\r\n  }\r\n  \r\n  submitChangesTypes(){\r\n    const body = {\r\n      rows: this.state.typesData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/electrical/types\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n      if(json.error){\r\n        console.log(\"error\")\r\n      }else{\r\n        console.log(\"success\")\r\n      }\r\n    })\r\n  }\r\n\r\n  addRowSteps(){\r\n    let rows = this.state.stepsData\r\n    rows.push({\"Name\": \"\", \"Percentage\":\"\"})\r\n    this.setState({stepsData: rows})\r\n  }\r\n\r\n  submitChangesSteps(){\r\n    const body = {\r\n      rows: this.state.stepsData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/electrical/steps\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n      if(json.error){\r\n        console.log(\"error\")\r\n      }else{\r\n        console.log(\"success\")\r\n      }\r\n    })\r\n  }\r\n\r\n  addRowProgress(){\r\n    let rows = this.state.progressData\r\n    rows.push({\"Week\": \"\", \"Estimated\": \"\"})\r\n    this.setState({progressData: rows})\r\n  }\r\n\r\n  submitChangesProgress(){\r\n    const body = {\r\n      rows: this.state.progressData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/electrical/progress\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n      if(json.error){\r\n        console.log(\"error\")\r\n      }else{\r\n        console.log(\"success\")\r\n      }\r\n    })\r\n  }\r\n\r\n  \r\n\r\n \r\n\r\n  render() {\r\n\r\n    const typesSettings = {\r\n        licenseKey: 'non-commercial-and-evaluation',\r\n        colWidths: 200,\r\n        //... other options\r\n      }\r\n  \r\n      const stepsSettings = {\r\n        licenseKey: 'non-commercial-and-evaluation',\r\n        colWidths: 200,\r\n        //... other options\r\n      }\r\n  \r\n      const progressSettings = {\r\n        licenseKey: 'non-commercial-and-evaluation',\r\n        colWidths: 195,\r\n        //... other options\r\n      }\r\n\r\n      return (\r\n        <div className=\"row\" style={{float:\"left\"}}>\r\n           <div className=\"column\" style={{marginLeft:\"20px\"}}>\r\n            <div id=\"hot-app\">\r\n              <HotTable\r\n                data={this.state.stepsData}\r\n                colHeaders={true}\r\n                rowHeaders={true}\r\n                width=\"473\"\r\n                height=\"500\"\r\n                settings={stepsSettings} \r\n                manualColumnResize={true}\r\n                manualRowResize={true}\r\n                columns= {[{ data: \"Name\"}, {data: \"Percentage\", type:\"numeric\"}]}\r\n              />\r\n              <br></br>\r\n              <center>\r\n                  <button class=\"btn btn-sm btn-info\" onClick={() => this.addRowSteps()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\"}}>Add</button>\r\n                  <button class=\"btn btn-sm btn-success\" onClick={() => this.submitChangesSteps()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\"}}>Save</button>\r\n              </center>\r\n            </div>\r\n          </div>\r\n          <div className=\"column\" style={{marginLeft:\"19px\"}}>\r\n\r\n            <div id=\"hot-app\">\r\n              <HotTable\r\n                data={this.state.typesData}\r\n                colHeaders={true}\r\n                rowHeaders={true}\r\n                width=\"675\"\r\n                height=\"500\"\r\n                settings={typesSettings} \r\n                manualColumnResize={true}\r\n                manualRowResize={true}\r\n                columns= {[{ data: \"Code\"}, { data: \"Name\"}, {data: \"Weight\", type:\"numeric\"}]}\r\n              />\r\n              <br></br>\r\n              <center>\r\n                  <button class=\"btn btn-sm btn-info\" onClick={() => this.addRowTypes()} style={{marginRight:\"5px\", fontSize:\"16px\",width:\"60px\"}}>Add</button>\r\n                  <button class=\"btn btn-sm btn-success\" onClick={() => this.submitChangesTypes()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\"}}>Save</button>\r\n              </center>\r\n            </div>\r\n          </div>\r\n         \r\n          <div className=\"column\" style={{marginLeft:\"20px\"}}>\r\n            <div id=\"hot-app\">\r\n              <HotTable\r\n                data={this.state.progressData}\r\n                colHeaders={true}\r\n                rowHeaders={true}\r\n                width=\"465\"\r\n                height=\"500\"\r\n                settings={progressSettings} \r\n                manualColumnResize={true}\r\n                manualRowResize={true}\r\n                columns= {[{ data: \"Week\", type:\"numeric\"}, {data: \"Estimated\", type:\"numeric\"}]}\r\n              />\r\n              <br></br>\r\n              <center>\r\n                  <button class=\"btn btn-sm btn-info\" onClick={() => this.addRowProgress()} style={{marginRight:\"5px\", fontSize:\"16px\",width:\"60px\"}}>Add</button>\r\n                  <button class=\"btn btn-sm btn-success\" onClick={() => this.submitChangesProgress()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\"}}>Save</button>\r\n              </center>\r\n            </div>\r\n          </div>\r\n      </div>\r\n      );\r\n  }\r\n}\r\n\r\nexport default ElecExcel;"]},"metadata":{},"sourceType":"module"}