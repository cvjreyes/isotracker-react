{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nimport Cursor from \"./cursor.mjs\";\nimport { SEPARATOR, NO_ITEMS, predefinedItems } from \"./predefinedItems.mjs\";\nimport { filterSeparators, hasSubMenu, isDisabled, isItemHidden, isSeparator, isSelectionDisabled, normalizeSelection } from \"./utils.mjs\";\nimport Core from \"../../core.mjs\";\nimport EventManager from \"../../eventManager.mjs\";\nimport { arrayEach, arrayFilter, arrayReduce } from \"../../helpers/array.mjs\";\nimport { isWindowsOS, isMobileBrowser, isIpadOS } from \"../../helpers/browser.mjs\";\nimport { addClass, empty, fastInnerHTML, getScrollbarWidth, isChildOf, isInput, removeClass, getParentWindow, hasClass } from \"../../helpers/dom/element.mjs\";\nimport { stopImmediatePropagation, isRightClick } from \"../../helpers/dom/event.mjs\";\nimport { debounce, isFunction } from \"../../helpers/function.mjs\";\nimport { isUndefined, isDefined } from \"../../helpers/mixed.mjs\";\nimport { mixin, hasOwnProperty } from \"../../helpers/object.mjs\";\nimport { KEY_CODES } from \"../../helpers/unicode.mjs\";\nimport localHooks from \"../../mixins/localHooks.mjs\";\nvar MIN_WIDTH = 215;\n/**\r\n * @class Menu\r\n * @plugin ContextMenu\r\n */\n\nvar Menu = /*#__PURE__*/function () {\n  function Menu(hotInstance, options) {\n    _classCallCheck(this, Menu);\n\n    this.hot = hotInstance;\n    this.options = options || {\n      parent: null,\n      name: null,\n      className: '',\n      keepInViewport: true,\n      standalone: false,\n      minWidth: MIN_WIDTH,\n      container: this.hot.rootDocument.documentElement\n    };\n    this.eventManager = new EventManager(this);\n    this.container = this.createContainer(this.options.name);\n    this.hotMenu = null;\n    this.hotSubMenus = {};\n    this.parentMenu = this.options.parent || null;\n    this.menuItems = null;\n    this.origOutsideClickDeselects = null;\n    this.keyEvent = false;\n    this.offset = {\n      above: 0,\n      below: 0,\n      left: 0,\n      right: 0\n    };\n    this._afterScrollCallback = null;\n    this.registerEvents();\n  }\n  /**\r\n   * Register event listeners.\r\n   *\r\n   * @private\r\n   */\n\n\n  _createClass(Menu, [{\n    key: \"registerEvents\",\n    value: function registerEvents() {\n      var _this = this;\n\n      var frame = this.hot.rootWindow;\n\n      while (frame) {\n        this.eventManager.addEventListener(frame.document, 'mousedown', function (event) {\n          return _this.onDocumentMouseDown(event);\n        });\n        this.eventManager.addEventListener(frame.document, 'contextmenu', function (event) {\n          return _this.onDocumentContextMenu(event);\n        });\n        frame = getParentWindow(frame);\n      }\n    }\n    /**\r\n     * Set array of objects which defines menu items.\r\n     *\r\n     * @param {Array} menuItems Menu items to display.\r\n     */\n\n  }, {\n    key: \"setMenuItems\",\n    value: function setMenuItems(menuItems) {\n      this.menuItems = menuItems;\n    }\n    /**\r\n     * Returns currently selected menu item. Returns `null` if no item was selected.\r\n     *\r\n     * @returns {object|null}\r\n     */\n\n  }, {\n    key: \"getSelectedItem\",\n    value: function getSelectedItem() {\n      return this.hasSelectedItem() ? this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]) : null;\n    }\n    /**\r\n     * Checks if the menu has selected (highlighted) any item from the menu list.\r\n     *\r\n     * @returns {boolean}\r\n     */\n\n  }, {\n    key: \"hasSelectedItem\",\n    value: function hasSelectedItem() {\n      return Array.isArray(this.hotMenu.getSelectedLast());\n    }\n    /**\r\n     * Set offset menu position for specified area (`above`, `below`, `left` or `right`).\r\n     *\r\n     * @param {string} area Specified area name (`above`, `below`, `left` or `right`).\r\n     * @param {number} offset Offset value.\r\n     */\n\n  }, {\n    key: \"setOffset\",\n    value: function setOffset(area) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.offset[area] = offset;\n    }\n    /**\r\n     * Check if menu is using as sub-menu.\r\n     *\r\n     * @returns {boolean}\r\n     */\n\n  }, {\n    key: \"isSubMenu\",\n    value: function isSubMenu() {\n      return this.parentMenu !== null;\n    }\n    /**\r\n     * Open menu.\r\n     *\r\n     * @fires Hooks#beforeContextMenuShow\r\n     * @fires Hooks#afterContextMenuShow\r\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this2 = this;\n\n      this.runLocalHooks('beforeOpen');\n      this.container.removeAttribute('style');\n      this.container.style.display = 'block';\n      var delayedOpenSubMenu = debounce(function (row) {\n        return _this2.openSubMenu(row);\n      }, 300);\n      var minWidthOfMenu = this.options.minWidth || MIN_WIDTH;\n      var noItemsDefined = false;\n      var filteredItems = arrayFilter(this.menuItems, function (item) {\n        if (item.key === NO_ITEMS) {\n          noItemsDefined = true;\n        }\n\n        return isItemHidden(item, _this2.hot);\n      });\n\n      if (filteredItems.length < 1 && !noItemsDefined) {\n        filteredItems.push(predefinedItems()[NO_ITEMS]);\n      } else if (filteredItems.length === 0) {\n        return;\n      }\n\n      filteredItems = filterSeparators(filteredItems, SEPARATOR);\n      var shouldAutoCloseMenu = false;\n      var settings = {\n        data: filteredItems,\n        colHeaders: false,\n        autoColumnSize: true,\n        autoWrapRow: false,\n        modifyColWidth: function modifyColWidth(width) {\n          if (isDefined(width) && width < minWidthOfMenu) {\n            return minWidthOfMenu;\n          }\n\n          return width;\n        },\n        autoRowSize: false,\n        readOnly: true,\n        editor: false,\n        copyPaste: false,\n        maxCols: 1,\n        columns: [{\n          data: 'name',\n          renderer: function renderer(hot, TD, row, col, prop, value) {\n            return _this2.menuItemRenderer(hot, TD, row, col, prop, value);\n          }\n        }],\n        renderAllRows: true,\n        fragmentSelection: false,\n        outsideClickDeselects: false,\n        disableVisualSelection: 'area',\n        beforeKeyDown: function beforeKeyDown(event) {\n          return _this2.onBeforeKeyDown(event);\n        },\n        afterOnCellMouseOver: function afterOnCellMouseOver(event, coords) {\n          if (_this2.isAllSubMenusClosed()) {\n            delayedOpenSubMenu(coords.row);\n          } else {\n            _this2.openSubMenu(coords.row);\n          }\n        },\n        rowHeights: function rowHeights(row) {\n          return filteredItems[row].name === SEPARATOR ? 1 : 23;\n        },\n        afterOnCellContextMenu: function afterOnCellContextMenu(event) {\n          event.preventDefault(); // On the Windows platform, the \"contextmenu\" is triggered after the \"mouseup\" so that's\n          // why the closing menu is here. (#6507#issuecomment-582392301).\n\n          if (isWindowsOS() && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            _this2.close(true);\n          }\n        },\n        beforeOnCellMouseUp: function beforeOnCellMouseUp(event) {\n          if (_this2.hasSelectedItem()) {\n            shouldAutoCloseMenu = !_this2.isCommandPassive(_this2.getSelectedItem());\n\n            _this2.executeCommand(event);\n          }\n        },\n        afterOnCellMouseUp: function afterOnCellMouseUp(event) {\n          // If the code runs on the other platform than Windows, the \"mouseup\" is triggered\n          // after the \"contextmenu\". So then \"mouseup\" closes the menu. Otherwise, the closing\n          // menu responsibility is forwarded to \"afterOnCellContextMenu\" callback (#6507#issuecomment-582392301).\n          if ((!isWindowsOS() || !isRightClick(event)) && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            // The timeout is necessary only for mobile devices. For desktop, the click event that is fired\n            // right after the mouseup event gets the event element target the same as the mouseup event.\n            // For mobile devices, the click event is triggered with native delay (~300ms), so when the mouseup\n            // event hides the tapped element, the click event grabs the element below. As a result, the filter\n            // by condition menu is closed and immediately open on tapping the \"None\" item.\n            if (isMobileBrowser() || isIpadOS()) {\n              setTimeout(function () {\n                return _this2.close(true);\n              }, 325);\n            } else {\n              _this2.close(true);\n            }\n          }\n        },\n        afterUnlisten: function afterUnlisten() {\n          // Restore menu focus, fix for `this.instance.unlisten();` call in the tableView.js@260 file.\n          // This prevents losing table responsiveness for keyboard events when filter select menu is closed (#6497).\n          if (!_this2.hasSelectedItem() && _this2.isOpened()) {\n            _this2.hotMenu.listen();\n          }\n        }\n      };\n      this.origOutsideClickDeselects = this.hot.getSettings().outsideClickDeselects;\n      this.hot.getSettings().outsideClickDeselects = false;\n      this.hotMenu = new Core(this.container, settings);\n      this.hotMenu.addHook('afterInit', function () {\n        return _this2.onAfterInit();\n      });\n      this.hotMenu.addHook('afterSelection', function () {\n        return _this2.onAfterSelection.apply(_this2, arguments);\n      });\n      this.hotMenu.init();\n      this.hotMenu.listen();\n      this.blockMainTableCallbacks();\n      this.runLocalHooks('afterOpen');\n    }\n    /**\r\n     * Close menu.\r\n     *\r\n     * @param {boolean} [closeParent=false] If `true` try to close parent menu if exists.\r\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      var closeParent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isOpened()) {\n        return;\n      }\n\n      if (closeParent && this.parentMenu) {\n        this.parentMenu.close();\n      } else {\n        this.closeAllSubMenus();\n        this.container.style.display = 'none';\n        this.releaseMainTableCallbacks();\n        this.hotMenu.destroy();\n        this.hotMenu = null;\n        this.hot.getSettings().outsideClickDeselects = this.origOutsideClickDeselects;\n        this.runLocalHooks('afterClose');\n\n        if (this.parentMenu) {\n          this.parentMenu.hotMenu.listen();\n        }\n      }\n    }\n    /**\r\n     * Open sub menu at the provided row index.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @returns {Menu|boolean} Returns created menu or `false` if no one menu was created.\r\n     */\n\n  }, {\n    key: \"openSubMenu\",\n    value: function openSubMenu(row) {\n      if (!this.hotMenu) {\n        return false;\n      }\n\n      var cell = this.hotMenu.getCell(row, 0);\n      this.closeAllSubMenus();\n\n      if (!cell || !hasSubMenu(cell)) {\n        return false;\n      }\n\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var subMenu = new Menu(this.hot, {\n        parent: this,\n        name: dataItem.name,\n        className: this.options.className,\n        keepInViewport: true,\n        container: this.options.container\n      });\n      subMenu.setMenuItems(dataItem.submenu.items);\n      subMenu.open();\n      subMenu.setPosition(cell.getBoundingClientRect());\n      this.hotSubMenus[dataItem.key] = subMenu;\n      return subMenu;\n    }\n    /**\r\n     * Close sub menu at row index.\r\n     *\r\n     * @param {number} row Row index.\r\n     */\n\n  }, {\n    key: \"closeSubMenu\",\n    value: function closeSubMenu(row) {\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var menus = this.hotSubMenus[dataItem.key];\n\n      if (menus) {\n        menus.destroy();\n        delete this.hotSubMenus[dataItem.key];\n      }\n    }\n    /**\r\n     * Close all opened sub menus.\r\n     */\n\n  }, {\n    key: \"closeAllSubMenus\",\n    value: function closeAllSubMenus() {\n      var _this3 = this;\n\n      arrayEach(this.hotMenu.getData(), function (value, row) {\n        return _this3.closeSubMenu(row);\n      });\n    }\n    /**\r\n     * Checks if all created and opened sub menus are closed.\r\n     *\r\n     * @returns {boolean}\r\n     */\n\n  }, {\n    key: \"isAllSubMenusClosed\",\n    value: function isAllSubMenusClosed() {\n      return Object.keys(this.hotSubMenus).length === 0;\n    }\n    /**\r\n     * Destroy instance.\r\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var menuContainerParentElement = this.container.parentNode;\n      this.clearLocalHooks();\n      this.close();\n      this.parentMenu = null;\n      this.eventManager.destroy();\n\n      if (menuContainerParentElement) {\n        menuContainerParentElement.removeChild(this.container);\n      }\n    }\n    /**\r\n     * Checks if menu was opened.\r\n     *\r\n     * @returns {boolean} Returns `true` if menu was opened.\r\n     */\n\n  }, {\n    key: \"isOpened\",\n    value: function isOpened() {\n      return this.hotMenu !== null;\n    }\n    /**\r\n     * Execute menu command.\r\n     *\r\n     * @param {Event} [event] The mouse event object.\r\n     */\n\n  }, {\n    key: \"executeCommand\",\n    value: function executeCommand(event) {\n      if (!this.isOpened() || !this.hasSelectedItem()) {\n        return;\n      }\n\n      var selectedItem = this.getSelectedItem();\n      this.runLocalHooks('select', selectedItem, event);\n\n      if (this.isCommandPassive(selectedItem)) {\n        return;\n      }\n\n      var selRanges = this.hot.getSelectedRange();\n      var normalizedSelection = selRanges ? normalizeSelection(selRanges) : [];\n      this.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n\n      if (this.isSubMenu()) {\n        this.parentMenu.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n      }\n    }\n    /**\r\n     * Checks if the passed command is passive or not. The command is passive when it's marked as\r\n     * disabled, the descriptor object contains `isCommand` property set to `false`, command\r\n     * is a separator, or the item is recognized as submenu. For passive items the menu is not\r\n     * closed automatically after the user trigger the command through the UI.\r\n     *\r\n     * @param {object} commandDescriptor Selected menu item from the menu data source.\r\n     * @returns {boolean}\r\n     */\n\n  }, {\n    key: \"isCommandPassive\",\n    value: function isCommandPassive(commandDescriptor) {\n      var isCommand = commandDescriptor.isCommand,\n          commandName = commandDescriptor.name,\n          disabled = commandDescriptor.disabled,\n          submenu = commandDescriptor.submenu;\n      var isItemDisabled = disabled === true || typeof disabled === 'function' && disabled.call(this.hot) === true;\n      return isCommand === false || commandName === SEPARATOR || isItemDisabled === true || submenu;\n    }\n    /**\r\n     * Set menu position based on dom event or based on literal object.\r\n     *\r\n     * @param {Event|object} coords Event or literal Object with coordinates.\r\n     */\n\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(coords) {\n      var cursor = new Cursor(coords, this.container.ownerDocument.defaultView);\n\n      if (this.options.keepInViewport) {\n        if (cursor.fitsBelow(this.container)) {\n          this.setPositionBelowCursor(cursor);\n        } else if (cursor.fitsAbove(this.container)) {\n          this.setPositionAboveCursor(cursor);\n        } else {\n          this.setPositionBelowCursor(cursor);\n        }\n\n        if (cursor.fitsOnRight(this.container)) {\n          this.setPositionOnRightOfCursor(cursor);\n        } else {\n          this.setPositionOnLeftOfCursor(cursor);\n        }\n      } else {\n        this.setPositionBelowCursor(cursor);\n        this.setPositionOnRightOfCursor(cursor);\n      }\n    }\n    /**\r\n     * Set menu position above cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\n\n  }, {\n    key: \"setPositionAboveCursor\",\n    value: function setPositionAboveCursor(cursor) {\n      var top = this.offset.above + cursor.top - this.container.offsetHeight;\n\n      if (this.isSubMenu()) {\n        top = cursor.top + cursor.cellHeight - this.container.offsetHeight + 3;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\r\n     * Set menu position below cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\n\n  }, {\n    key: \"setPositionBelowCursor\",\n    value: function setPositionBelowCursor(cursor) {\n      var top = this.offset.below + cursor.top + 1;\n\n      if (this.isSubMenu()) {\n        top = cursor.top - 1;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\r\n     * Set menu position on the right of cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\n\n  }, {\n    key: \"setPositionOnRightOfCursor\",\n    value: function setPositionOnRightOfCursor(cursor) {\n      var left;\n\n      if (this.isSubMenu()) {\n        left = 1 + cursor.left + cursor.cellWidth;\n      } else {\n        left = this.offset.right + 1 + cursor.left;\n      }\n\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\r\n     * Set menu position on the left of cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\n\n  }, {\n    key: \"setPositionOnLeftOfCursor\",\n    value: function setPositionOnLeftOfCursor(cursor) {\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\n      var left = this.offset.left + cursor.left - this.container.offsetWidth + scrollbarWidth + 4;\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\r\n     * Select first cell in opened menu.\r\n     */\n\n  }, {\n    key: \"selectFirstCell\",\n    value: function selectFirstCell() {\n      var cell = this.hotMenu.getCell(0, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(0, 0);\n      } else {\n        this.hotMenu.selectCell(0, 0);\n      }\n    }\n    /**\r\n     * Select last cell in opened menu.\r\n     */\n\n  }, {\n    key: \"selectLastCell\",\n    value: function selectLastCell() {\n      var lastRow = this.hotMenu.countRows() - 1;\n      var cell = this.hotMenu.getCell(lastRow, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(lastRow, 0);\n      } else {\n        this.hotMenu.selectCell(lastRow, 0);\n      }\n    }\n    /**\r\n     * Select next cell in opened menu.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @param {number} col Column index.\r\n     */\n\n  }, {\n    key: \"selectNextCell\",\n    value: function selectNextCell(row, col) {\n      var nextRow = row + 1;\n      var cell = nextRow < this.hotMenu.countRows() ? this.hotMenu.getCell(nextRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(nextRow, col);\n      } else {\n        this.hotMenu.selectCell(nextRow, col);\n      }\n    }\n    /**\r\n     * Select previous cell in opened menu.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @param {number} col Column index.\r\n     */\n\n  }, {\n    key: \"selectPrevCell\",\n    value: function selectPrevCell(row, col) {\n      var prevRow = row - 1;\n      var cell = prevRow >= 0 ? this.hotMenu.getCell(prevRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(prevRow, col);\n      } else {\n        this.hotMenu.selectCell(prevRow, col);\n      }\n    }\n    /**\r\n     * Menu item renderer.\r\n     *\r\n     * @private\r\n     * @param {Core} hot The Handsontable instance.\r\n     * @param {HTMLCellElement} TD The rendered cell element.\r\n     * @param {number} row The visual index.\r\n     * @param {number} col The visual index.\r\n     * @param {string} prop The column property if used.\r\n     * @param {string} value The cell value.\r\n     */\n\n  }, {\n    key: \"menuItemRenderer\",\n    value: function menuItemRenderer(hot, TD, row, col, prop, value) {\n      var _this4 = this;\n\n      var item = hot.getSourceDataAtRow(row);\n      var wrapper = this.hot.rootDocument.createElement('div');\n\n      var isSubMenu = function isSubMenu(itemToTest) {\n        return hasOwnProperty(itemToTest, 'submenu');\n      };\n\n      var itemIsSeparator = function itemIsSeparator(itemToTest) {\n        return new RegExp(SEPARATOR, 'i').test(itemToTest.name);\n      };\n\n      var itemIsDisabled = function itemIsDisabled(itemToTest) {\n        return itemToTest.disabled === true || typeof itemToTest.disabled === 'function' && itemToTest.disabled.call(_this4.hot) === true;\n      };\n\n      var itemIsSelectionDisabled = function itemIsSelectionDisabled(itemToTest) {\n        return itemToTest.disableSelection;\n      };\n\n      var itemValue = value;\n\n      if (typeof itemValue === 'function') {\n        itemValue = itemValue.call(this.hot);\n      }\n\n      empty(TD);\n      addClass(wrapper, 'htItemWrapper');\n      TD.appendChild(wrapper);\n\n      if (itemIsSeparator(item)) {\n        addClass(TD, 'htSeparator');\n      } else if (typeof item.renderer === 'function') {\n        addClass(TD, 'htCustomMenuRenderer');\n        TD.appendChild(item.renderer(hot, wrapper, row, col, prop, itemValue));\n      } else {\n        fastInnerHTML(wrapper, itemValue);\n      }\n\n      if (itemIsDisabled(item)) {\n        addClass(TD, 'htDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (itemIsSelectionDisabled(item)) {\n        addClass(TD, 'htSelectionDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (isSubMenu(item)) {\n        addClass(TD, 'htSubmenu');\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      } else {\n        removeClass(TD, ['htSubmenu', 'htDisabled']);\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      }\n    }\n    /**\r\n     * Create container/wrapper for handsontable.\r\n     *\r\n     * @private\r\n     * @param {string} [name] Class name.\r\n     * @returns {HTMLElement}\r\n     */\n\n  }, {\n    key: \"createContainer\",\n    value: function createContainer() {\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var doc = this.options.container.ownerDocument;\n      var className = name;\n      var container;\n\n      if (className) {\n        if (isFunction(className)) {\n          className = className.call(this.hot);\n\n          if (className === null || isUndefined(className)) {\n            className = '';\n          } else {\n            className = className.toString();\n          }\n        }\n\n        className = className.replace(/[^A-z0-9]/g, '_');\n        className = \"\".concat(this.options.className, \"Sub_\").concat(className);\n        container = doc.querySelector(\".\".concat(this.options.className, \".\").concat(className));\n      }\n\n      if (!container) {\n        container = doc.createElement('div');\n        addClass(container, \"htMenu \".concat(this.options.className));\n\n        if (className) {\n          addClass(container, className);\n        }\n\n        this.options.container.appendChild(container);\n      }\n\n      return container;\n    }\n    /**\r\n     * @private\r\n     */\n\n  }, {\n    key: \"blockMainTableCallbacks\",\n    value: function blockMainTableCallbacks() {\n      this._afterScrollCallback = function () {};\n\n      this.hot.addHook('afterScrollVertically', this._afterScrollCallback);\n      this.hot.addHook('afterScrollHorizontally', this._afterScrollCallback);\n    }\n    /**\r\n     * @private\r\n     */\n\n  }, {\n    key: \"releaseMainTableCallbacks\",\n    value: function releaseMainTableCallbacks() {\n      if (this._afterScrollCallback) {\n        this.hot.removeHook('afterScrollVertically', this._afterScrollCallback);\n        this.hot.removeHook('afterScrollHorizontally', this._afterScrollCallback);\n        this._afterScrollCallback = null;\n      }\n    }\n    /**\r\n     * On before key down listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event The keyaboard event object.\r\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      // For input elements, prevent event propagation. It allows entering text into an input\n      // element freely - without steeling the key events from the menu module (#6506, #6549).\n      if (isInput(event.target) && this.container.contains(event.target)) {\n        stopImmediatePropagation(event);\n        return;\n      }\n\n      var selection = this.hotMenu.getSelectedLast();\n      var stopEvent = false;\n      this.keyEvent = true;\n\n      switch (event.keyCode) {\n        case KEY_CODES.ESCAPE:\n          this.close();\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ENTER:\n          if (selection) {\n            if (this.hotMenu.getSourceDataAtRow(selection[0]).submenu) {\n              stopEvent = true;\n            } else {\n              this.executeCommand(event);\n              this.close(true);\n            }\n          }\n\n          break;\n\n        case KEY_CODES.ARROW_DOWN:\n          if (selection) {\n            this.selectNextCell(selection[0], selection[1]);\n          } else {\n            this.selectFirstCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_UP:\n          if (selection) {\n            this.selectPrevCell(selection[0], selection[1]);\n          } else {\n            this.selectLastCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_RIGHT:\n          if (selection) {\n            var menu = this.openSubMenu(selection[0]);\n\n            if (menu) {\n              menu.selectFirstCell();\n            }\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_LEFT:\n          if (selection && this.isSubMenu()) {\n            this.close();\n\n            if (this.parentMenu) {\n              this.parentMenu.hotMenu.listen();\n            }\n\n            stopEvent = true;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n      if (stopEvent) {\n        event.preventDefault();\n        stopImmediatePropagation(event);\n      }\n\n      this.keyEvent = false;\n    }\n    /**\r\n     * On after init listener.\r\n     *\r\n     * @private\r\n     */\n\n  }, {\n    key: \"onAfterInit\",\n    value: function onAfterInit() {\n      var wtTable = this.hotMenu.view.wt.wtTable;\n      var data = this.hotMenu.getSettings().data;\n      var hiderStyle = wtTable.hider.style;\n      var holderStyle = wtTable.holder.style;\n      var currentHiderWidth = parseInt(hiderStyle.width, 10);\n      var realHeight = arrayReduce(data, function (accumulator, value) {\n        return accumulator + (value.name === SEPARATOR ? 1 : 26);\n      }, 0); // Additional 3px to menu's size because of additional border around its `table.htCore`.\n\n      holderStyle.width = \"\".concat(currentHiderWidth + 3, \"px\");\n      holderStyle.height = \"\".concat(realHeight + 3, \"px\");\n      hiderStyle.height = holderStyle.height;\n    }\n    /**\r\n     * On after selection listener.\r\n     *\r\n     * @param {number} r Selection start row index.\r\n     * @param {number} c Selection start column index.\r\n     * @param {number} r2 Selection end row index.\r\n     * @param {number} c2 Selection end column index.\r\n     * @param {object} preventScrolling Object with `value` property where its value change will be observed.\r\n     */\n\n  }, {\n    key: \"onAfterSelection\",\n    value: function onAfterSelection(r, c, r2, c2, preventScrolling) {\n      if (this.keyEvent === false) {\n        preventScrolling.value = true;\n      }\n    }\n    /**\r\n     * Document mouse down listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event The mouse event object.\r\n     */\n\n  }, {\n    key: \"onDocumentMouseDown\",\n    value: function onDocumentMouseDown(event) {\n      if (!this.isOpened()) {\n        return;\n      } // Close menu when clicked element is not belongs to menu itself\n\n\n      if (this.options.standalone && this.hotMenu && !isChildOf(event.target, this.hotMenu.rootElement)) {\n        this.close(true); // Automatically close menu when clicked element is not belongs to menu or submenu (not necessarily to itself)\n      } else if ((this.isAllSubMenusClosed() || this.isSubMenu()) && !isChildOf(event.target, '.htMenu') && (isChildOf(event.target, this.container.ownerDocument) || isChildOf(event.target, this.hot.rootDocument))) {\n        this.close(true);\n      }\n    }\n    /**\r\n     * Document's contextmenu listener.\r\n     *\r\n     * @private\r\n     * @param {MouseEvent} event The mouse event object.\r\n     */\n\n  }, {\n    key: \"onDocumentContextMenu\",\n    value: function onDocumentContextMenu(event) {\n      if (!this.isOpened()) {\n        return;\n      }\n\n      if (hasClass(event.target, 'htCore') && isChildOf(event.target, this.hotMenu.rootElement)) {\n        event.preventDefault();\n      }\n    }\n  }]);\n\n  return Menu;\n}();\n\nmixin(Menu, localHooks);\nexport default Menu;","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/handsontable/plugins/contextMenu/menu.mjs"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","Cursor","SEPARATOR","NO_ITEMS","predefinedItems","filterSeparators","hasSubMenu","isDisabled","isItemHidden","isSeparator","isSelectionDisabled","normalizeSelection","Core","EventManager","arrayEach","arrayFilter","arrayReduce","isWindowsOS","isMobileBrowser","isIpadOS","addClass","empty","fastInnerHTML","getScrollbarWidth","isChildOf","isInput","removeClass","getParentWindow","hasClass","stopImmediatePropagation","isRightClick","debounce","isFunction","isUndefined","isDefined","mixin","hasOwnProperty","KEY_CODES","localHooks","MIN_WIDTH","Menu","hotInstance","options","hot","parent","name","className","keepInViewport","standalone","minWidth","container","rootDocument","documentElement","eventManager","createContainer","hotMenu","hotSubMenus","parentMenu","menuItems","origOutsideClickDeselects","keyEvent","offset","above","below","left","right","_afterScrollCallback","registerEvents","value","_this","frame","rootWindow","addEventListener","document","event","onDocumentMouseDown","onDocumentContextMenu","setMenuItems","getSelectedItem","hasSelectedItem","getSourceDataAtRow","getSelectedLast","Array","isArray","setOffset","area","arguments","undefined","isSubMenu","open","_this2","runLocalHooks","removeAttribute","style","display","delayedOpenSubMenu","row","openSubMenu","minWidthOfMenu","noItemsDefined","filteredItems","item","push","shouldAutoCloseMenu","settings","data","colHeaders","autoColumnSize","autoWrapRow","modifyColWidth","width","autoRowSize","readOnly","editor","copyPaste","maxCols","columns","renderer","TD","col","prop","menuItemRenderer","renderAllRows","fragmentSelection","outsideClickDeselects","disableVisualSelection","beforeKeyDown","onBeforeKeyDown","afterOnCellMouseOver","coords","isAllSubMenusClosed","rowHeights","afterOnCellContextMenu","preventDefault","close","beforeOnCellMouseUp","isCommandPassive","executeCommand","afterOnCellMouseUp","setTimeout","afterUnlisten","isOpened","listen","getSettings","addHook","onAfterInit","onAfterSelection","apply","init","blockMainTableCallbacks","closeParent","closeAllSubMenus","releaseMainTableCallbacks","destroy","cell","getCell","dataItem","subMenu","submenu","items","setPosition","getBoundingClientRect","closeSubMenu","menus","_this3","getData","keys","menuContainerParentElement","parentNode","clearLocalHooks","removeChild","selectedItem","selRanges","getSelectedRange","normalizedSelection","commandDescriptor","isCommand","commandName","disabled","isItemDisabled","call","cursor","ownerDocument","defaultView","fitsBelow","setPositionBelowCursor","fitsAbove","setPositionAboveCursor","fitsOnRight","setPositionOnRightOfCursor","setPositionOnLeftOfCursor","top","offsetHeight","cellHeight","concat","cellWidth","scrollbarWidth","offsetWidth","selectFirstCell","selectNextCell","selectCell","selectLastCell","lastRow","countRows","selectPrevCell","nextRow","prevRow","_this4","wrapper","createElement","itemToTest","itemIsSeparator","RegExp","test","itemIsDisabled","itemIsSelectionDisabled","disableSelection","itemValue","appendChild","deselectCell","doc","toString","replace","querySelector","removeHook","contains","selection","stopEvent","keyCode","ESCAPE","ENTER","ARROW_DOWN","ARROW_UP","ARROW_RIGHT","menu","ARROW_LEFT","wtTable","view","wt","hiderStyle","hider","holderStyle","holder","currentHiderWidth","parseInt","realHeight","accumulator","height","r","c","r2","c2","preventScrolling","rootElement"],"mappings":"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","sourcesContent":["import \"core-js/modules/es.function.name.js\";\r\nimport \"core-js/modules/web.timers.js\";\r\nimport \"core-js/modules/es.object.keys.js\";\r\nimport \"core-js/modules/es.regexp.constructor.js\";\r\nimport \"core-js/modules/es.regexp.exec.js\";\r\nimport \"core-js/modules/es.regexp.to-string.js\";\r\nimport \"core-js/modules/es.object.to-string.js\";\r\nimport \"core-js/modules/es.string.replace.js\";\r\nimport \"core-js/modules/es.array.concat.js\";\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\r\n\r\nimport Cursor from \"./cursor.mjs\";\r\nimport { SEPARATOR, NO_ITEMS, predefinedItems } from \"./predefinedItems.mjs\";\r\nimport { filterSeparators, hasSubMenu, isDisabled, isItemHidden, isSeparator, isSelectionDisabled, normalizeSelection } from \"./utils.mjs\";\r\nimport Core from \"../../core.mjs\";\r\nimport EventManager from \"../../eventManager.mjs\";\r\nimport { arrayEach, arrayFilter, arrayReduce } from \"../../helpers/array.mjs\";\r\nimport { isWindowsOS, isMobileBrowser, isIpadOS } from \"../../helpers/browser.mjs\";\r\nimport { addClass, empty, fastInnerHTML, getScrollbarWidth, isChildOf, isInput, removeClass, getParentWindow, hasClass } from \"../../helpers/dom/element.mjs\";\r\nimport { stopImmediatePropagation, isRightClick } from \"../../helpers/dom/event.mjs\";\r\nimport { debounce, isFunction } from \"../../helpers/function.mjs\";\r\nimport { isUndefined, isDefined } from \"../../helpers/mixed.mjs\";\r\nimport { mixin, hasOwnProperty } from \"../../helpers/object.mjs\";\r\nimport { KEY_CODES } from \"../../helpers/unicode.mjs\";\r\nimport localHooks from \"../../mixins/localHooks.mjs\";\r\nvar MIN_WIDTH = 215;\r\n/**\r\n * @class Menu\r\n * @plugin ContextMenu\r\n */\r\n\r\nvar Menu = /*#__PURE__*/function () {\r\n  function Menu(hotInstance, options) {\r\n    _classCallCheck(this, Menu);\r\n\r\n    this.hot = hotInstance;\r\n    this.options = options || {\r\n      parent: null,\r\n      name: null,\r\n      className: '',\r\n      keepInViewport: true,\r\n      standalone: false,\r\n      minWidth: MIN_WIDTH,\r\n      container: this.hot.rootDocument.documentElement\r\n    };\r\n    this.eventManager = new EventManager(this);\r\n    this.container = this.createContainer(this.options.name);\r\n    this.hotMenu = null;\r\n    this.hotSubMenus = {};\r\n    this.parentMenu = this.options.parent || null;\r\n    this.menuItems = null;\r\n    this.origOutsideClickDeselects = null;\r\n    this.keyEvent = false;\r\n    this.offset = {\r\n      above: 0,\r\n      below: 0,\r\n      left: 0,\r\n      right: 0\r\n    };\r\n    this._afterScrollCallback = null;\r\n    this.registerEvents();\r\n  }\r\n  /**\r\n   * Register event listeners.\r\n   *\r\n   * @private\r\n   */\r\n\r\n\r\n  _createClass(Menu, [{\r\n    key: \"registerEvents\",\r\n    value: function registerEvents() {\r\n      var _this = this;\r\n\r\n      var frame = this.hot.rootWindow;\r\n\r\n      while (frame) {\r\n        this.eventManager.addEventListener(frame.document, 'mousedown', function (event) {\r\n          return _this.onDocumentMouseDown(event);\r\n        });\r\n        this.eventManager.addEventListener(frame.document, 'contextmenu', function (event) {\r\n          return _this.onDocumentContextMenu(event);\r\n        });\r\n        frame = getParentWindow(frame);\r\n      }\r\n    }\r\n    /**\r\n     * Set array of objects which defines menu items.\r\n     *\r\n     * @param {Array} menuItems Menu items to display.\r\n     */\r\n\r\n  }, {\r\n    key: \"setMenuItems\",\r\n    value: function setMenuItems(menuItems) {\r\n      this.menuItems = menuItems;\r\n    }\r\n    /**\r\n     * Returns currently selected menu item. Returns `null` if no item was selected.\r\n     *\r\n     * @returns {object|null}\r\n     */\r\n\r\n  }, {\r\n    key: \"getSelectedItem\",\r\n    value: function getSelectedItem() {\r\n      return this.hasSelectedItem() ? this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]) : null;\r\n    }\r\n    /**\r\n     * Checks if the menu has selected (highlighted) any item from the menu list.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n\r\n  }, {\r\n    key: \"hasSelectedItem\",\r\n    value: function hasSelectedItem() {\r\n      return Array.isArray(this.hotMenu.getSelectedLast());\r\n    }\r\n    /**\r\n     * Set offset menu position for specified area (`above`, `below`, `left` or `right`).\r\n     *\r\n     * @param {string} area Specified area name (`above`, `below`, `left` or `right`).\r\n     * @param {number} offset Offset value.\r\n     */\r\n\r\n  }, {\r\n    key: \"setOffset\",\r\n    value: function setOffset(area) {\r\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\r\n      this.offset[area] = offset;\r\n    }\r\n    /**\r\n     * Check if menu is using as sub-menu.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n\r\n  }, {\r\n    key: \"isSubMenu\",\r\n    value: function isSubMenu() {\r\n      return this.parentMenu !== null;\r\n    }\r\n    /**\r\n     * Open menu.\r\n     *\r\n     * @fires Hooks#beforeContextMenuShow\r\n     * @fires Hooks#afterContextMenuShow\r\n     */\r\n\r\n  }, {\r\n    key: \"open\",\r\n    value: function open() {\r\n      var _this2 = this;\r\n\r\n      this.runLocalHooks('beforeOpen');\r\n      this.container.removeAttribute('style');\r\n      this.container.style.display = 'block';\r\n      var delayedOpenSubMenu = debounce(function (row) {\r\n        return _this2.openSubMenu(row);\r\n      }, 300);\r\n      var minWidthOfMenu = this.options.minWidth || MIN_WIDTH;\r\n      var noItemsDefined = false;\r\n      var filteredItems = arrayFilter(this.menuItems, function (item) {\r\n        if (item.key === NO_ITEMS) {\r\n          noItemsDefined = true;\r\n        }\r\n\r\n        return isItemHidden(item, _this2.hot);\r\n      });\r\n\r\n      if (filteredItems.length < 1 && !noItemsDefined) {\r\n        filteredItems.push(predefinedItems()[NO_ITEMS]);\r\n      } else if (filteredItems.length === 0) {\r\n        return;\r\n      }\r\n\r\n      filteredItems = filterSeparators(filteredItems, SEPARATOR);\r\n      var shouldAutoCloseMenu = false;\r\n      var settings = {\r\n        data: filteredItems,\r\n        colHeaders: false,\r\n        autoColumnSize: true,\r\n        autoWrapRow: false,\r\n        modifyColWidth: function modifyColWidth(width) {\r\n          if (isDefined(width) && width < minWidthOfMenu) {\r\n            return minWidthOfMenu;\r\n          }\r\n\r\n          return width;\r\n        },\r\n        autoRowSize: false,\r\n        readOnly: true,\r\n        editor: false,\r\n        copyPaste: false,\r\n        maxCols: 1,\r\n        columns: [{\r\n          data: 'name',\r\n          renderer: function renderer(hot, TD, row, col, prop, value) {\r\n            return _this2.menuItemRenderer(hot, TD, row, col, prop, value);\r\n          }\r\n        }],\r\n        renderAllRows: true,\r\n        fragmentSelection: false,\r\n        outsideClickDeselects: false,\r\n        disableVisualSelection: 'area',\r\n        beforeKeyDown: function beforeKeyDown(event) {\r\n          return _this2.onBeforeKeyDown(event);\r\n        },\r\n        afterOnCellMouseOver: function afterOnCellMouseOver(event, coords) {\r\n          if (_this2.isAllSubMenusClosed()) {\r\n            delayedOpenSubMenu(coords.row);\r\n          } else {\r\n            _this2.openSubMenu(coords.row);\r\n          }\r\n        },\r\n        rowHeights: function rowHeights(row) {\r\n          return filteredItems[row].name === SEPARATOR ? 1 : 23;\r\n        },\r\n        afterOnCellContextMenu: function afterOnCellContextMenu(event) {\r\n          event.preventDefault(); // On the Windows platform, the \"contextmenu\" is triggered after the \"mouseup\" so that's\r\n          // why the closing menu is here. (#6507#issuecomment-582392301).\r\n\r\n          if (isWindowsOS() && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\r\n            _this2.close(true);\r\n          }\r\n        },\r\n        beforeOnCellMouseUp: function beforeOnCellMouseUp(event) {\r\n          if (_this2.hasSelectedItem()) {\r\n            shouldAutoCloseMenu = !_this2.isCommandPassive(_this2.getSelectedItem());\r\n\r\n            _this2.executeCommand(event);\r\n          }\r\n        },\r\n        afterOnCellMouseUp: function afterOnCellMouseUp(event) {\r\n          // If the code runs on the other platform than Windows, the \"mouseup\" is triggered\r\n          // after the \"contextmenu\". So then \"mouseup\" closes the menu. Otherwise, the closing\r\n          // menu responsibility is forwarded to \"afterOnCellContextMenu\" callback (#6507#issuecomment-582392301).\r\n          if ((!isWindowsOS() || !isRightClick(event)) && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\r\n            // The timeout is necessary only for mobile devices. For desktop, the click event that is fired\r\n            // right after the mouseup event gets the event element target the same as the mouseup event.\r\n            // For mobile devices, the click event is triggered with native delay (~300ms), so when the mouseup\r\n            // event hides the tapped element, the click event grabs the element below. As a result, the filter\r\n            // by condition menu is closed and immediately open on tapping the \"None\" item.\r\n            if (isMobileBrowser() || isIpadOS()) {\r\n              setTimeout(function () {\r\n                return _this2.close(true);\r\n              }, 325);\r\n            } else {\r\n              _this2.close(true);\r\n            }\r\n          }\r\n        },\r\n        afterUnlisten: function afterUnlisten() {\r\n          // Restore menu focus, fix for `this.instance.unlisten();` call in the tableView.js@260 file.\r\n          // This prevents losing table responsiveness for keyboard events when filter select menu is closed (#6497).\r\n          if (!_this2.hasSelectedItem() && _this2.isOpened()) {\r\n            _this2.hotMenu.listen();\r\n          }\r\n        }\r\n      };\r\n      this.origOutsideClickDeselects = this.hot.getSettings().outsideClickDeselects;\r\n      this.hot.getSettings().outsideClickDeselects = false;\r\n      this.hotMenu = new Core(this.container, settings);\r\n      this.hotMenu.addHook('afterInit', function () {\r\n        return _this2.onAfterInit();\r\n      });\r\n      this.hotMenu.addHook('afterSelection', function () {\r\n        return _this2.onAfterSelection.apply(_this2, arguments);\r\n      });\r\n      this.hotMenu.init();\r\n      this.hotMenu.listen();\r\n      this.blockMainTableCallbacks();\r\n      this.runLocalHooks('afterOpen');\r\n    }\r\n    /**\r\n     * Close menu.\r\n     *\r\n     * @param {boolean} [closeParent=false] If `true` try to close parent menu if exists.\r\n     */\r\n\r\n  }, {\r\n    key: \"close\",\r\n    value: function close() {\r\n      var closeParent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\r\n\r\n      if (!this.isOpened()) {\r\n        return;\r\n      }\r\n\r\n      if (closeParent && this.parentMenu) {\r\n        this.parentMenu.close();\r\n      } else {\r\n        this.closeAllSubMenus();\r\n        this.container.style.display = 'none';\r\n        this.releaseMainTableCallbacks();\r\n        this.hotMenu.destroy();\r\n        this.hotMenu = null;\r\n        this.hot.getSettings().outsideClickDeselects = this.origOutsideClickDeselects;\r\n        this.runLocalHooks('afterClose');\r\n\r\n        if (this.parentMenu) {\r\n          this.parentMenu.hotMenu.listen();\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Open sub menu at the provided row index.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @returns {Menu|boolean} Returns created menu or `false` if no one menu was created.\r\n     */\r\n\r\n  }, {\r\n    key: \"openSubMenu\",\r\n    value: function openSubMenu(row) {\r\n      if (!this.hotMenu) {\r\n        return false;\r\n      }\r\n\r\n      var cell = this.hotMenu.getCell(row, 0);\r\n      this.closeAllSubMenus();\r\n\r\n      if (!cell || !hasSubMenu(cell)) {\r\n        return false;\r\n      }\r\n\r\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\r\n      var subMenu = new Menu(this.hot, {\r\n        parent: this,\r\n        name: dataItem.name,\r\n        className: this.options.className,\r\n        keepInViewport: true,\r\n        container: this.options.container\r\n      });\r\n      subMenu.setMenuItems(dataItem.submenu.items);\r\n      subMenu.open();\r\n      subMenu.setPosition(cell.getBoundingClientRect());\r\n      this.hotSubMenus[dataItem.key] = subMenu;\r\n      return subMenu;\r\n    }\r\n    /**\r\n     * Close sub menu at row index.\r\n     *\r\n     * @param {number} row Row index.\r\n     */\r\n\r\n  }, {\r\n    key: \"closeSubMenu\",\r\n    value: function closeSubMenu(row) {\r\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\r\n      var menus = this.hotSubMenus[dataItem.key];\r\n\r\n      if (menus) {\r\n        menus.destroy();\r\n        delete this.hotSubMenus[dataItem.key];\r\n      }\r\n    }\r\n    /**\r\n     * Close all opened sub menus.\r\n     */\r\n\r\n  }, {\r\n    key: \"closeAllSubMenus\",\r\n    value: function closeAllSubMenus() {\r\n      var _this3 = this;\r\n\r\n      arrayEach(this.hotMenu.getData(), function (value, row) {\r\n        return _this3.closeSubMenu(row);\r\n      });\r\n    }\r\n    /**\r\n     * Checks if all created and opened sub menus are closed.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n\r\n  }, {\r\n    key: \"isAllSubMenusClosed\",\r\n    value: function isAllSubMenusClosed() {\r\n      return Object.keys(this.hotSubMenus).length === 0;\r\n    }\r\n    /**\r\n     * Destroy instance.\r\n     */\r\n\r\n  }, {\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      var menuContainerParentElement = this.container.parentNode;\r\n      this.clearLocalHooks();\r\n      this.close();\r\n      this.parentMenu = null;\r\n      this.eventManager.destroy();\r\n\r\n      if (menuContainerParentElement) {\r\n        menuContainerParentElement.removeChild(this.container);\r\n      }\r\n    }\r\n    /**\r\n     * Checks if menu was opened.\r\n     *\r\n     * @returns {boolean} Returns `true` if menu was opened.\r\n     */\r\n\r\n  }, {\r\n    key: \"isOpened\",\r\n    value: function isOpened() {\r\n      return this.hotMenu !== null;\r\n    }\r\n    /**\r\n     * Execute menu command.\r\n     *\r\n     * @param {Event} [event] The mouse event object.\r\n     */\r\n\r\n  }, {\r\n    key: \"executeCommand\",\r\n    value: function executeCommand(event) {\r\n      if (!this.isOpened() || !this.hasSelectedItem()) {\r\n        return;\r\n      }\r\n\r\n      var selectedItem = this.getSelectedItem();\r\n      this.runLocalHooks('select', selectedItem, event);\r\n\r\n      if (this.isCommandPassive(selectedItem)) {\r\n        return;\r\n      }\r\n\r\n      var selRanges = this.hot.getSelectedRange();\r\n      var normalizedSelection = selRanges ? normalizeSelection(selRanges) : [];\r\n      this.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\r\n\r\n      if (this.isSubMenu()) {\r\n        this.parentMenu.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\r\n      }\r\n    }\r\n    /**\r\n     * Checks if the passed command is passive or not. The command is passive when it's marked as\r\n     * disabled, the descriptor object contains `isCommand` property set to `false`, command\r\n     * is a separator, or the item is recognized as submenu. For passive items the menu is not\r\n     * closed automatically after the user trigger the command through the UI.\r\n     *\r\n     * @param {object} commandDescriptor Selected menu item from the menu data source.\r\n     * @returns {boolean}\r\n     */\r\n\r\n  }, {\r\n    key: \"isCommandPassive\",\r\n    value: function isCommandPassive(commandDescriptor) {\r\n      var isCommand = commandDescriptor.isCommand,\r\n          commandName = commandDescriptor.name,\r\n          disabled = commandDescriptor.disabled,\r\n          submenu = commandDescriptor.submenu;\r\n      var isItemDisabled = disabled === true || typeof disabled === 'function' && disabled.call(this.hot) === true;\r\n      return isCommand === false || commandName === SEPARATOR || isItemDisabled === true || submenu;\r\n    }\r\n    /**\r\n     * Set menu position based on dom event or based on literal object.\r\n     *\r\n     * @param {Event|object} coords Event or literal Object with coordinates.\r\n     */\r\n\r\n  }, {\r\n    key: \"setPosition\",\r\n    value: function setPosition(coords) {\r\n      var cursor = new Cursor(coords, this.container.ownerDocument.defaultView);\r\n\r\n      if (this.options.keepInViewport) {\r\n        if (cursor.fitsBelow(this.container)) {\r\n          this.setPositionBelowCursor(cursor);\r\n        } else if (cursor.fitsAbove(this.container)) {\r\n          this.setPositionAboveCursor(cursor);\r\n        } else {\r\n          this.setPositionBelowCursor(cursor);\r\n        }\r\n\r\n        if (cursor.fitsOnRight(this.container)) {\r\n          this.setPositionOnRightOfCursor(cursor);\r\n        } else {\r\n          this.setPositionOnLeftOfCursor(cursor);\r\n        }\r\n      } else {\r\n        this.setPositionBelowCursor(cursor);\r\n        this.setPositionOnRightOfCursor(cursor);\r\n      }\r\n    }\r\n    /**\r\n     * Set menu position above cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\r\n\r\n  }, {\r\n    key: \"setPositionAboveCursor\",\r\n    value: function setPositionAboveCursor(cursor) {\r\n      var top = this.offset.above + cursor.top - this.container.offsetHeight;\r\n\r\n      if (this.isSubMenu()) {\r\n        top = cursor.top + cursor.cellHeight - this.container.offsetHeight + 3;\r\n      }\r\n\r\n      this.container.style.top = \"\".concat(top, \"px\");\r\n    }\r\n    /**\r\n     * Set menu position below cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\r\n\r\n  }, {\r\n    key: \"setPositionBelowCursor\",\r\n    value: function setPositionBelowCursor(cursor) {\r\n      var top = this.offset.below + cursor.top + 1;\r\n\r\n      if (this.isSubMenu()) {\r\n        top = cursor.top - 1;\r\n      }\r\n\r\n      this.container.style.top = \"\".concat(top, \"px\");\r\n    }\r\n    /**\r\n     * Set menu position on the right of cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\r\n\r\n  }, {\r\n    key: \"setPositionOnRightOfCursor\",\r\n    value: function setPositionOnRightOfCursor(cursor) {\r\n      var left;\r\n\r\n      if (this.isSubMenu()) {\r\n        left = 1 + cursor.left + cursor.cellWidth;\r\n      } else {\r\n        left = this.offset.right + 1 + cursor.left;\r\n      }\r\n\r\n      this.container.style.left = \"\".concat(left, \"px\");\r\n    }\r\n    /**\r\n     * Set menu position on the left of cursor object.\r\n     *\r\n     * @param {Cursor} cursor `Cursor` object.\r\n     */\r\n\r\n  }, {\r\n    key: \"setPositionOnLeftOfCursor\",\r\n    value: function setPositionOnLeftOfCursor(cursor) {\r\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\r\n      var left = this.offset.left + cursor.left - this.container.offsetWidth + scrollbarWidth + 4;\r\n      this.container.style.left = \"\".concat(left, \"px\");\r\n    }\r\n    /**\r\n     * Select first cell in opened menu.\r\n     */\r\n\r\n  }, {\r\n    key: \"selectFirstCell\",\r\n    value: function selectFirstCell() {\r\n      var cell = this.hotMenu.getCell(0, 0);\r\n\r\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\r\n        this.selectNextCell(0, 0);\r\n      } else {\r\n        this.hotMenu.selectCell(0, 0);\r\n      }\r\n    }\r\n    /**\r\n     * Select last cell in opened menu.\r\n     */\r\n\r\n  }, {\r\n    key: \"selectLastCell\",\r\n    value: function selectLastCell() {\r\n      var lastRow = this.hotMenu.countRows() - 1;\r\n      var cell = this.hotMenu.getCell(lastRow, 0);\r\n\r\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\r\n        this.selectPrevCell(lastRow, 0);\r\n      } else {\r\n        this.hotMenu.selectCell(lastRow, 0);\r\n      }\r\n    }\r\n    /**\r\n     * Select next cell in opened menu.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @param {number} col Column index.\r\n     */\r\n\r\n  }, {\r\n    key: \"selectNextCell\",\r\n    value: function selectNextCell(row, col) {\r\n      var nextRow = row + 1;\r\n      var cell = nextRow < this.hotMenu.countRows() ? this.hotMenu.getCell(nextRow, col) : null;\r\n\r\n      if (!cell) {\r\n        return;\r\n      }\r\n\r\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\r\n        this.selectNextCell(nextRow, col);\r\n      } else {\r\n        this.hotMenu.selectCell(nextRow, col);\r\n      }\r\n    }\r\n    /**\r\n     * Select previous cell in opened menu.\r\n     *\r\n     * @param {number} row Row index.\r\n     * @param {number} col Column index.\r\n     */\r\n\r\n  }, {\r\n    key: \"selectPrevCell\",\r\n    value: function selectPrevCell(row, col) {\r\n      var prevRow = row - 1;\r\n      var cell = prevRow >= 0 ? this.hotMenu.getCell(prevRow, col) : null;\r\n\r\n      if (!cell) {\r\n        return;\r\n      }\r\n\r\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\r\n        this.selectPrevCell(prevRow, col);\r\n      } else {\r\n        this.hotMenu.selectCell(prevRow, col);\r\n      }\r\n    }\r\n    /**\r\n     * Menu item renderer.\r\n     *\r\n     * @private\r\n     * @param {Core} hot The Handsontable instance.\r\n     * @param {HTMLCellElement} TD The rendered cell element.\r\n     * @param {number} row The visual index.\r\n     * @param {number} col The visual index.\r\n     * @param {string} prop The column property if used.\r\n     * @param {string} value The cell value.\r\n     */\r\n\r\n  }, {\r\n    key: \"menuItemRenderer\",\r\n    value: function menuItemRenderer(hot, TD, row, col, prop, value) {\r\n      var _this4 = this;\r\n\r\n      var item = hot.getSourceDataAtRow(row);\r\n      var wrapper = this.hot.rootDocument.createElement('div');\r\n\r\n      var isSubMenu = function isSubMenu(itemToTest) {\r\n        return hasOwnProperty(itemToTest, 'submenu');\r\n      };\r\n\r\n      var itemIsSeparator = function itemIsSeparator(itemToTest) {\r\n        return new RegExp(SEPARATOR, 'i').test(itemToTest.name);\r\n      };\r\n\r\n      var itemIsDisabled = function itemIsDisabled(itemToTest) {\r\n        return itemToTest.disabled === true || typeof itemToTest.disabled === 'function' && itemToTest.disabled.call(_this4.hot) === true;\r\n      };\r\n\r\n      var itemIsSelectionDisabled = function itemIsSelectionDisabled(itemToTest) {\r\n        return itemToTest.disableSelection;\r\n      };\r\n\r\n      var itemValue = value;\r\n\r\n      if (typeof itemValue === 'function') {\r\n        itemValue = itemValue.call(this.hot);\r\n      }\r\n\r\n      empty(TD);\r\n      addClass(wrapper, 'htItemWrapper');\r\n      TD.appendChild(wrapper);\r\n\r\n      if (itemIsSeparator(item)) {\r\n        addClass(TD, 'htSeparator');\r\n      } else if (typeof item.renderer === 'function') {\r\n        addClass(TD, 'htCustomMenuRenderer');\r\n        TD.appendChild(item.renderer(hot, wrapper, row, col, prop, itemValue));\r\n      } else {\r\n        fastInnerHTML(wrapper, itemValue);\r\n      }\r\n\r\n      if (itemIsDisabled(item)) {\r\n        addClass(TD, 'htDisabled');\r\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n          return hot.deselectCell();\r\n        });\r\n      } else if (itemIsSelectionDisabled(item)) {\r\n        addClass(TD, 'htSelectionDisabled');\r\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n          return hot.deselectCell();\r\n        });\r\n      } else if (isSubMenu(item)) {\r\n        addClass(TD, 'htSubmenu');\r\n\r\n        if (itemIsSelectionDisabled(item)) {\r\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n            return hot.deselectCell();\r\n          });\r\n        } else {\r\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n            return hot.selectCell(row, col, void 0, void 0, false, false);\r\n          });\r\n        }\r\n      } else {\r\n        removeClass(TD, ['htSubmenu', 'htDisabled']);\r\n\r\n        if (itemIsSelectionDisabled(item)) {\r\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n            return hot.deselectCell();\r\n          });\r\n        } else {\r\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\r\n            return hot.selectCell(row, col, void 0, void 0, false, false);\r\n          });\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Create container/wrapper for handsontable.\r\n     *\r\n     * @private\r\n     * @param {string} [name] Class name.\r\n     * @returns {HTMLElement}\r\n     */\r\n\r\n  }, {\r\n    key: \"createContainer\",\r\n    value: function createContainer() {\r\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\r\n      var doc = this.options.container.ownerDocument;\r\n      var className = name;\r\n      var container;\r\n\r\n      if (className) {\r\n        if (isFunction(className)) {\r\n          className = className.call(this.hot);\r\n\r\n          if (className === null || isUndefined(className)) {\r\n            className = '';\r\n          } else {\r\n            className = className.toString();\r\n          }\r\n        }\r\n\r\n        className = className.replace(/[^A-z0-9]/g, '_');\r\n        className = \"\".concat(this.options.className, \"Sub_\").concat(className);\r\n        container = doc.querySelector(\".\".concat(this.options.className, \".\").concat(className));\r\n      }\r\n\r\n      if (!container) {\r\n        container = doc.createElement('div');\r\n        addClass(container, \"htMenu \".concat(this.options.className));\r\n\r\n        if (className) {\r\n          addClass(container, className);\r\n        }\r\n\r\n        this.options.container.appendChild(container);\r\n      }\r\n\r\n      return container;\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"blockMainTableCallbacks\",\r\n    value: function blockMainTableCallbacks() {\r\n      this._afterScrollCallback = function () {};\r\n\r\n      this.hot.addHook('afterScrollVertically', this._afterScrollCallback);\r\n      this.hot.addHook('afterScrollHorizontally', this._afterScrollCallback);\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"releaseMainTableCallbacks\",\r\n    value: function releaseMainTableCallbacks() {\r\n      if (this._afterScrollCallback) {\r\n        this.hot.removeHook('afterScrollVertically', this._afterScrollCallback);\r\n        this.hot.removeHook('afterScrollHorizontally', this._afterScrollCallback);\r\n        this._afterScrollCallback = null;\r\n      }\r\n    }\r\n    /**\r\n     * On before key down listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event The keyaboard event object.\r\n     */\r\n\r\n  }, {\r\n    key: \"onBeforeKeyDown\",\r\n    value: function onBeforeKeyDown(event) {\r\n      // For input elements, prevent event propagation. It allows entering text into an input\r\n      // element freely - without steeling the key events from the menu module (#6506, #6549).\r\n      if (isInput(event.target) && this.container.contains(event.target)) {\r\n        stopImmediatePropagation(event);\r\n        return;\r\n      }\r\n\r\n      var selection = this.hotMenu.getSelectedLast();\r\n      var stopEvent = false;\r\n      this.keyEvent = true;\r\n\r\n      switch (event.keyCode) {\r\n        case KEY_CODES.ESCAPE:\r\n          this.close();\r\n          stopEvent = true;\r\n          break;\r\n\r\n        case KEY_CODES.ENTER:\r\n          if (selection) {\r\n            if (this.hotMenu.getSourceDataAtRow(selection[0]).submenu) {\r\n              stopEvent = true;\r\n            } else {\r\n              this.executeCommand(event);\r\n              this.close(true);\r\n            }\r\n          }\r\n\r\n          break;\r\n\r\n        case KEY_CODES.ARROW_DOWN:\r\n          if (selection) {\r\n            this.selectNextCell(selection[0], selection[1]);\r\n          } else {\r\n            this.selectFirstCell();\r\n          }\r\n\r\n          stopEvent = true;\r\n          break;\r\n\r\n        case KEY_CODES.ARROW_UP:\r\n          if (selection) {\r\n            this.selectPrevCell(selection[0], selection[1]);\r\n          } else {\r\n            this.selectLastCell();\r\n          }\r\n\r\n          stopEvent = true;\r\n          break;\r\n\r\n        case KEY_CODES.ARROW_RIGHT:\r\n          if (selection) {\r\n            var menu = this.openSubMenu(selection[0]);\r\n\r\n            if (menu) {\r\n              menu.selectFirstCell();\r\n            }\r\n          }\r\n\r\n          stopEvent = true;\r\n          break;\r\n\r\n        case KEY_CODES.ARROW_LEFT:\r\n          if (selection && this.isSubMenu()) {\r\n            this.close();\r\n\r\n            if (this.parentMenu) {\r\n              this.parentMenu.hotMenu.listen();\r\n            }\r\n\r\n            stopEvent = true;\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n      if (stopEvent) {\r\n        event.preventDefault();\r\n        stopImmediatePropagation(event);\r\n      }\r\n\r\n      this.keyEvent = false;\r\n    }\r\n    /**\r\n     * On after init listener.\r\n     *\r\n     * @private\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterInit\",\r\n    value: function onAfterInit() {\r\n      var wtTable = this.hotMenu.view.wt.wtTable;\r\n      var data = this.hotMenu.getSettings().data;\r\n      var hiderStyle = wtTable.hider.style;\r\n      var holderStyle = wtTable.holder.style;\r\n      var currentHiderWidth = parseInt(hiderStyle.width, 10);\r\n      var realHeight = arrayReduce(data, function (accumulator, value) {\r\n        return accumulator + (value.name === SEPARATOR ? 1 : 26);\r\n      }, 0); // Additional 3px to menu's size because of additional border around its `table.htCore`.\r\n\r\n      holderStyle.width = \"\".concat(currentHiderWidth + 3, \"px\");\r\n      holderStyle.height = \"\".concat(realHeight + 3, \"px\");\r\n      hiderStyle.height = holderStyle.height;\r\n    }\r\n    /**\r\n     * On after selection listener.\r\n     *\r\n     * @param {number} r Selection start row index.\r\n     * @param {number} c Selection start column index.\r\n     * @param {number} r2 Selection end row index.\r\n     * @param {number} c2 Selection end column index.\r\n     * @param {object} preventScrolling Object with `value` property where its value change will be observed.\r\n     */\r\n\r\n  }, {\r\n    key: \"onAfterSelection\",\r\n    value: function onAfterSelection(r, c, r2, c2, preventScrolling) {\r\n      if (this.keyEvent === false) {\r\n        preventScrolling.value = true;\r\n      }\r\n    }\r\n    /**\r\n     * Document mouse down listener.\r\n     *\r\n     * @private\r\n     * @param {Event} event The mouse event object.\r\n     */\r\n\r\n  }, {\r\n    key: \"onDocumentMouseDown\",\r\n    value: function onDocumentMouseDown(event) {\r\n      if (!this.isOpened()) {\r\n        return;\r\n      } // Close menu when clicked element is not belongs to menu itself\r\n\r\n\r\n      if (this.options.standalone && this.hotMenu && !isChildOf(event.target, this.hotMenu.rootElement)) {\r\n        this.close(true); // Automatically close menu when clicked element is not belongs to menu or submenu (not necessarily to itself)\r\n      } else if ((this.isAllSubMenusClosed() || this.isSubMenu()) && !isChildOf(event.target, '.htMenu') && (isChildOf(event.target, this.container.ownerDocument) || isChildOf(event.target, this.hot.rootDocument))) {\r\n        this.close(true);\r\n      }\r\n    }\r\n    /**\r\n     * Document's contextmenu listener.\r\n     *\r\n     * @private\r\n     * @param {MouseEvent} event The mouse event object.\r\n     */\r\n\r\n  }, {\r\n    key: \"onDocumentContextMenu\",\r\n    value: function onDocumentContextMenu(event) {\r\n      if (!this.isOpened()) {\r\n        return;\r\n      }\r\n\r\n      if (hasClass(event.target, 'htCore') && isChildOf(event.target, this.hotMenu.rootElement)) {\r\n        event.preventDefault();\r\n      }\r\n    }\r\n  }]);\r\n\r\n  return Menu;\r\n}();\r\n\r\nmixin(Menu, localHooks);\r\nexport default Menu;"]},"metadata":{},"sourceType":"module"}