{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'antd/dist/antd.css';import{HotTable}from'@handsontable/react';import'handsontable/dist/handsontable.full.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InstExcel=/*#__PURE__*/function(_React$Component){_inherits(InstExcel,_React$Component);var _super=_createSuper(InstExcel);function InstExcel(){var _this;_classCallCheck(this,InstExcel);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={searchText:'',searchedColumn:'',typesData:[],stepsData:[],progressData:[],tab:_this.props.currentTab,selectedRows:[],selectedRowsKeys:[],updateData:_this.props.updateData,username:\"\",acronyms:null,steps:[]};return _this;}_createClass(InstExcel,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var options;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:options={method:\"GET\",headers:{\"Content-Type\":\"application/json\"}};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrumentation/types\",options).then(function(response){return response.json();}).then(function(json){var rows=[];var row=null;rows.push({\"Code\":\"Code\",\"Name\":\"Name\",\"Weight\":\"Weight\"});for(var i=0;i<json.rows.length;i++){row={\"Code\":json.rows[i].code,\"Name\":json.rows[i].name,\"Weight\":json.rows[i].weight,id:json.rows[i].id};for(var j=0;j<_this2.state.steps.length;j++){var currentStep=_this2.state.steps[j].toString();row[currentStep]=json.rows[i][currentStep];}rows.push(row);}_this2.setState({typesData:rows,selectedRows:[]});});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrumentation/steps\",options).then(function(response){return response.json();}).then(function(json){var rows=[];var row=null;rows.push({\"Name\":\"Name\",\"Percentage\":\"Percentage\"});for(var i=0;i<json.rows.length;i++){row={\"Name\":json.rows[i].name,\"Percentage\":json.rows[i].percentage,id:json.rows[i].id};rows.push(row);}_this2.setState({stepsData:rows,selectedRows:[]});});fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/ginsts\",options).then(function(response){return response.json();}).then(function(json){var rows=[];var row=null;rows.push({\"Week\":\"Week\",\"Estimated\":\"Estimated\"});for(var i=0;i<json.rows.length;i++){row={\"Week\":json.rows[i].week,\"Estimated\":json.rows[i].estimated,id:json.rows[i].id};rows.push(row);}_this2.setState({progressData:rows,selectedRows:[]});});case 4:case\"end\":return _context.stop();}}},_callee);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"addRowTypes\",value:function addRowTypes(){var rows=this.state.typesData;rows.push({\"Code\":\"\",\"Name\":\"\",\"Weight\":\"\"});this.setState({typesData:rows});}},{key:\"submitChangesTypes\",value:function submitChangesTypes(){var body={rows:this.state.typesData};var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/types\",options).then(function(response){return response.json();}).then(function(json){});this.props.success();}},{key:\"addRowSteps\",value:function addRowSteps(){var rows=this.state.stepsData;rows.push({\"Name\":\"\",\"Percentage\":\"\"});this.setState({stepsData:rows});}},{key:\"submitChangesSteps\",value:function submitChangesSteps(){var body={rows:this.state.stepsData};var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/steps\",options).then(function(response){return response.json();}).then(function(json){});this.props.success();}},{key:\"addRowProgress\",value:function addRowProgress(){var rows=this.state.progressData;rows.push({\"Week\":\"\",\"Estimated\":\"\"});this.setState({progressData:rows});}},{key:\"submitChangesProgress\",value:function submitChangesProgress(){var body={rows:this.state.progressData};var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)};fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/progress\",options).then(function(response){return response.json();}).then(function(json){});this.props.success();}},{key:\"render\",value:function render(){var _this3=this;var typesSettings={licenseKey:'non-commercial-and-evaluation',colWidths:200//... other options\n};var progressSettings={licenseKey:'non-commercial-and-evaluation',colWidths:195//... other options\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{float:\"left\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"column\",style:{marginLeft:\"300px\"},children:/*#__PURE__*/_jsxs(\"div\",{id:\"hot-app\",children:[/*#__PURE__*/_jsx(HotTable,{data:this.state.typesData,colHeaders:true,rowHeaders:true,width:\"675\",height:\"500\",settings:typesSettings,manualColumnResize:true,manualRowResize:true,columns:[{data:\"Code\"},{data:\"Name\"},{data:\"Weight\",type:\"numeric\"}],filters:true,dropdownMenu:['make_read_only','---------','alignment','---------','filter_by_condition','---------','filter_operators','---------','filter_by_condition2','---------','filter_by_value','---------','filter_action_bar']}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-info\",onClick:function onClick(){return _this3.addRowTypes();},style:{marginRight:\"5px\",fontSize:\"16px\",width:\"60px\",borderRadius:\"10px\"},children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-success\",onClick:function onClick(){return _this3.submitChangesTypes();},style:{marginRight:\"5px\",fontSize:\"16px\",width:\"60px\",borderRadius:\"10px\"},children:\"Save\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"column\",style:{marginLeft:\"20px\"},children:/*#__PURE__*/_jsxs(\"div\",{id:\"hot-app\",children:[/*#__PURE__*/_jsx(HotTable,{data:this.state.progressData,colHeaders:true,rowHeaders:true,width:\"465\",height:\"500\",settings:progressSettings,manualColumnResize:true,manualRowResize:true,columns:[{data:\"Week\",type:\"numeric\"},{data:\"Estimated\",type:\"numeric\"}],filters:true,dropdownMenu:['make_read_only','---------','alignment','---------','filter_by_condition','---------','filter_operators','---------','filter_by_condition2','---------','filter_by_value','---------','filter_action_bar']}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-info\",onClick:function onClick(){return _this3.addRowProgress();},style:{marginRight:\"5px\",fontSize:\"16px\",width:\"60px\",borderRadius:\"10px\"},children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-sm btn-success\",onClick:function onClick(){return _this3.submitChangesProgress();},style:{marginRight:\"5px\",fontSize:\"16px\",width:\"60px\",borderRadius:\"10px\"},children:\"Save\"})]}),/*#__PURE__*/_jsx(\"br\",{})]})})]});}}]);return InstExcel;}(React.Component);export default InstExcel;","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/src/components/instExcel/instExcel.js"],"names":["React","HotTable","InstExcel","state","searchText","searchedColumn","typesData","stepsData","progressData","tab","props","currentTab","selectedRows","selectedRowsKeys","updateData","username","acronyms","steps","options","method","headers","fetch","process","env","REACT_APP_SERVER","REACT_APP_NODE_PORT","then","response","json","rows","row","push","i","length","code","name","weight","id","j","currentStep","toString","setState","percentage","week","estimated","body","JSON","stringify","success","typesSettings","licenseKey","colWidths","progressSettings","float","marginLeft","data","type","addRowTypes","marginRight","fontSize","width","borderRadius","submitChangesTypes","addRowProgress","submitChangesProgress","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport { HotTable } from '@handsontable/react';\r\nimport 'handsontable/dist/handsontable.full.css';\r\n\r\nclass InstExcel extends React.Component{\r\n  state = {\r\n    searchText: '',\r\n    searchedColumn: '',\r\n    typesData: [],\r\n    stepsData: [],\r\n    progressData: [],\r\n    tab: this.props.currentTab,\r\n    selectedRows: [],\r\n    selectedRowsKeys: [],\r\n    updateData: this.props.updateData,\r\n    username: \"\",\r\n    acronyms : null,\r\n    steps: []\r\n  };\r\n\r\n  async componentDidMount(){\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n    }\r\n\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrumentation/types\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Code\": \"Code\", \"Name\": \"Name\", \"Weight\": \"Weight\"})\r\n      for(let i = 0; i < json.rows.length; i++){\r\n\r\n          row = {\"Code\": json.rows[i].code, \"Name\": json.rows[i].name, \"Weight\": json.rows[i].weight, id: json.rows[i].id}\r\n\r\n          for(let j = 0; j < this.state.steps.length; j++){\r\n            let currentStep = this.state.steps[j].toString()\r\n            row[currentStep] = json.rows[i][currentStep]\r\n          }\r\n          rows.push(row)\r\n      }\r\n      this.setState({typesData : rows, selectedRows: []});\r\n\r\n  }) \r\n\r\n  fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/instrumentation/steps\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Name\":\"Name\", \"Percentage\":\"Percentage\"})\r\n      for(let i = 0; i < json.rows.length; i++){\r\n          row = {\"Name\": json.rows[i].name, \"Percentage\": json.rows[i].percentage, id: json.rows[i].id}\r\n\r\n          rows.push(row)\r\n      }\r\n      this.setState({stepsData : rows, selectedRows: []});\r\n\r\n  })\r\n\r\n  fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/ginsts\", options)\r\n    .then(response => response.json())\r\n    .then(json => {\r\n      var rows = []\r\n      var row = null\r\n      rows.push({\"Week\": \"Week\", \"Estimated\": \"Estimated\"})\r\n      for(let i = 0; i < json.rows.length; i++){\r\n          row = {\"Week\": json.rows[i].week, \"Estimated\": json.rows[i].estimated, id: json.rows[i].id}\r\n\r\n          rows.push(row)\r\n      }\r\n      this.setState({progressData : rows, selectedRows: []});\r\n\r\n  })\r\n  }\r\n\r\n  addRowTypes(){\r\n    let rows = this.state.typesData\r\n    rows.push({\"Code\": \"\", \"Name\":\"\", \"Weight\": \"\"})\r\n    this.setState({typesData: rows})\r\n  }\r\n  \r\n  submitChangesTypes(){\r\n    const body = {\r\n      rows: this.state.typesData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/types\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n\r\n    })\r\n    this.props.success()\r\n  }\r\n\r\n  addRowSteps(){\r\n    let rows = this.state.stepsData\r\n    rows.push({\"Name\": \"\", \"Percentage\":\"\"})\r\n    this.setState({stepsData: rows})\r\n  }\r\n\r\n  submitChangesSteps(){\r\n    const body = {\r\n      rows: this.state.stepsData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/steps\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n\r\n    })\r\n    this.props.success()\r\n  }\r\n\r\n  addRowProgress(){\r\n    let rows = this.state.progressData\r\n    rows.push({\"Week\": \"\", \"Estimated\": \"\"})\r\n    this.setState({progressData: rows})\r\n  }\r\n\r\n  submitChangesProgress(){\r\n    const body = {\r\n      rows: this.state.progressData,\r\n    }\r\n    const options = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body)\r\n    }\r\n    fetch(\"http://\"+process.env.REACT_APP_SERVER+\":\"+process.env.REACT_APP_NODE_PORT+\"/submit/instrumentation/progress\", options)\r\n    .then(response => response.json())\r\n    .then(json =>{\r\n\r\n    })\r\n    this.props.success()\r\n  }\r\n\r\n  \r\n\r\n \r\n\r\n  render() {\r\n\r\n    const typesSettings = {\r\n        licenseKey: 'non-commercial-and-evaluation',\r\n        colWidths: 200,\r\n        //... other options\r\n    }\r\n  \r\n      const progressSettings = {\r\n        licenseKey: 'non-commercial-and-evaluation',\r\n        colWidths: 195,\r\n        //... other options\r\n      }\r\n\r\n      return (\r\n        <div className=\"row\" style={{float:\"left\"}}>\r\n           \r\n          <div className=\"column\" style={{marginLeft:\"300px\"}}>\r\n\r\n            <div id=\"hot-app\">\r\n              <HotTable\r\n                data={this.state.typesData}\r\n                colHeaders={true}\r\n                rowHeaders={true}\r\n                width=\"675\"\r\n                height=\"500\"\r\n                settings={typesSettings} \r\n                manualColumnResize={true}\r\n                manualRowResize={true}\r\n                columns= {[{ data: \"Code\"}, { data: \"Name\"}, {data: \"Weight\", type:\"numeric\"}]}\r\n                filters={true}\r\n                dropdownMenu= {[\r\n                    'make_read_only',\r\n                    '---------',\r\n                    'alignment',\r\n                    '---------',\r\n                    'filter_by_condition',\r\n                    '---------',\r\n                    'filter_operators',\r\n                    '---------',\r\n                    'filter_by_condition2',\r\n                    '---------',\r\n                    'filter_by_value',\r\n                    '---------',\r\n                    'filter_action_bar',\r\n                  ]}\r\n              />\r\n              <br></br>\r\n              <center>\r\n                  <button class=\"btn btn-sm btn-info\" onClick={() => this.addRowTypes()} style={{marginRight:\"5px\", fontSize:\"16px\",width:\"60px\", borderRadius:\"10px\"}}>Add</button>\r\n                  <button class=\"btn btn-sm btn-success\" onClick={() => this.submitChangesTypes()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\", borderRadius:\"10px\"}}>Save</button>\r\n              </center>\r\n            </div>\r\n          </div>\r\n         \r\n          <div className=\"column\" style={{marginLeft:\"20px\"}}>\r\n            <div id=\"hot-app\">\r\n              <HotTable\r\n                data={this.state.progressData}\r\n                colHeaders={true}\r\n                rowHeaders={true}\r\n                width=\"465\"\r\n                height=\"500\"\r\n                settings={progressSettings} \r\n                manualColumnResize={true}\r\n                manualRowResize={true}\r\n                columns= {[{ data: \"Week\", type:\"numeric\"}, {data: \"Estimated\", type:\"numeric\"}]}\r\n                filters={true}\r\n                dropdownMenu= {[\r\n                    'make_read_only',\r\n                    '---------',\r\n                    'alignment',\r\n                    '---------',\r\n                    'filter_by_condition',\r\n                    '---------',\r\n                    'filter_operators',\r\n                    '---------',\r\n                    'filter_by_condition2',\r\n                    '---------',\r\n                    'filter_by_value',\r\n                    '---------',\r\n                    'filter_action_bar',\r\n                  ]}\r\n              />\r\n              <br></br>\r\n              <center>\r\n                  <button class=\"btn btn-sm btn-info\" onClick={() => this.addRowProgress()} style={{marginRight:\"5px\", fontSize:\"16px\",width:\"60px\", borderRadius:\"10px\"}}>Add</button>\r\n                  <button class=\"btn btn-sm btn-success\" onClick={() => this.submitChangesProgress()} style={{marginRight:\"5px\", fontSize:\"16px\", width:\"60px\", borderRadius:\"10px\"}}>Save</button>\r\n              </center>\r\n              <br></br>\r\n            </div>\r\n          </div>\r\n      </div>\r\n      );\r\n  }\r\n}\r\n\r\nexport default InstExcel;"]},"metadata":{},"sourceType":"module"}