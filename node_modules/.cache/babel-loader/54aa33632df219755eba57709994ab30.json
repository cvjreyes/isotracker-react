{"ast":null,"code":"function _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nimport { isEmpty } from \"./../helpers/mixed.mjs\";\nvar ESCAPED_HTML_CHARS = {\n  '&nbsp;': '\\x20',\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>'\n};\nvar regEscapedChars = new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(function (key) {\n  return \"(\".concat(key, \")\");\n}).join('|'), 'gi');\n/**\r\n * Verifies if node is an HTMLTable element.\r\n *\r\n * @param {Node} element Node to verify if it's an HTMLTable.\r\n * @returns {boolean}\r\n */\n\nfunction isHTMLTable(element) {\n  return (element && element.nodeName || '') === 'TABLE';\n}\n/**\r\n * Converts Handsontable into HTMLTableElement.\r\n *\r\n * @param {Core} instance The Handsontable instance.\r\n * @returns {string} OuterHTML of the HTMLTableElement.\r\n */\n\n\nexport function instanceToHTML(instance) {\n  var hasColumnHeaders = instance.hasColHeaders();\n  var hasRowHeaders = instance.hasRowHeaders();\n  var coords = [hasColumnHeaders ? -1 : 0, hasRowHeaders ? -1 : 0, instance.countRows() - 1, instance.countCols() - 1];\n  var data = instance.getData.apply(instance, coords);\n  var countRows = data.length;\n  var countCols = countRows > 0 ? data[0].length : 0;\n  var TABLE = ['<table>', '</table>'];\n  var THEAD = hasColumnHeaders ? ['<thead>', '</thead>'] : [];\n  var TBODY = ['<tbody>', '</tbody>'];\n  var rowModifier = hasRowHeaders ? 1 : 0;\n  var columnModifier = hasColumnHeaders ? 1 : 0;\n\n  for (var row = 0; row < countRows; row += 1) {\n    var isColumnHeadersRow = hasColumnHeaders && row === 0;\n    var CELLS = [];\n\n    for (var column = 0; column < countCols; column += 1) {\n      var isRowHeadersColumn = !isColumnHeadersRow && hasRowHeaders && column === 0;\n      var cell = '';\n\n      if (isColumnHeadersRow) {\n        cell = \"<th>\".concat(instance.getColHeader(column - rowModifier), \"</th>\");\n      } else if (isRowHeadersColumn) {\n        cell = \"<th>\".concat(instance.getRowHeader(row - columnModifier), \"</th>\");\n      } else {\n        var cellData = data[row][column];\n\n        var _instance$getCellMeta = instance.getCellMeta(row - rowModifier, column - columnModifier),\n            hidden = _instance$getCellMeta.hidden,\n            rowspan = _instance$getCellMeta.rowspan,\n            colspan = _instance$getCellMeta.colspan;\n\n        if (!hidden) {\n          var attrs = [];\n\n          if (rowspan) {\n            attrs.push(\"rowspan=\\\"\".concat(rowspan, \"\\\"\"));\n          }\n\n          if (colspan) {\n            attrs.push(\"colspan=\\\"\".concat(colspan, \"\\\"\"));\n          }\n\n          if (isEmpty(cellData)) {\n            cell = \"<td \".concat(attrs.join(' '), \"></td>\");\n          } else {\n            var value = cellData.toString().replace('<', '&lt;').replace('>', '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n            cell = \"<td \".concat(attrs.join(' '), \">\").concat(value, \"</td>\");\n          }\n        }\n      }\n\n      CELLS.push(cell);\n    }\n\n    var TR = ['<tr>'].concat(CELLS, ['</tr>']).join('');\n\n    if (isColumnHeadersRow) {\n      THEAD.splice(1, 0, TR);\n    } else {\n      TBODY.splice(-1, 0, TR);\n    }\n  }\n\n  TABLE.splice(1, 0, THEAD.join(''), TBODY.join(''));\n  return TABLE.join('');\n}\n/**\r\n * Converts 2D array into HTMLTableElement.\r\n *\r\n * @param {Array} input Input array which will be converted to HTMLTable.\r\n * @returns {string} OuterHTML of the HTMLTableElement.\r\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function _dataToHTML(input) {\n  var inputLen = input.length;\n  var result = ['<table>'];\n\n  for (var row = 0; row < inputLen; row += 1) {\n    var rowData = input[row];\n    var columnsLen = rowData.length;\n    var columnsResult = [];\n\n    if (row === 0) {\n      result.push('<tbody>');\n    }\n\n    for (var column = 0; column < columnsLen; column += 1) {\n      var cellData = rowData[column];\n      var parsedCellData = isEmpty(cellData) ? '' : cellData.toString().replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n      columnsResult.push(\"<td>\".concat(parsedCellData, \"</td>\"));\n    }\n\n    result.push.apply(result, ['<tr>'].concat(columnsResult, ['</tr>']));\n\n    if (row + 1 === inputLen) {\n      result.push('</tbody>');\n    }\n  }\n\n  result.push('</table>');\n  return result.join('');\n}\n/**\r\n * Converts HTMLTable or string into Handsontable configuration object.\r\n *\r\n * @param {Element|string} element Node element which should contain `<table>...</table>`.\r\n * @param {Document} [rootDocument] The document window owner.\r\n * @returns {object} Return configuration object. Contains keys as DefaultSettings.\r\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function htmlToGridSettings(element) {\n  var rootDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n  var settingsObj = {};\n  var fragment = rootDocument.createDocumentFragment();\n  var tempElem = rootDocument.createElement('div');\n  fragment.appendChild(tempElem);\n  var checkElement = element;\n\n  if (typeof checkElement === 'string') {\n    var escapedAdjacentHTML = checkElement.replace(/<td\\b[^>]*?>([\\s\\S]*?)<\\/\\s*td>/g, function (cellFragment) {\n      var openingTag = cellFragment.match(/<td\\b[^>]*?>/g)[0];\n      var cellValue = cellFragment.substring(openingTag.length, cellFragment.lastIndexOf('<')).replace(/(<(?!br)([^>]+)>)/gi, '');\n      var closingTag = '</td>';\n      return \"\".concat(openingTag).concat(cellValue).concat(closingTag);\n    });\n    tempElem.insertAdjacentHTML('afterbegin', \"\".concat(escapedAdjacentHTML));\n    checkElement = tempElem.querySelector('table');\n  }\n\n  if (!checkElement || !isHTMLTable(checkElement)) {\n    return;\n  }\n\n  var generator = tempElem.querySelector('meta[name$=\"enerator\"]');\n  var hasRowHeaders = checkElement.querySelector('tbody th') !== null;\n  var trElement = checkElement.querySelector('tr');\n  var countCols = !trElement ? 0 : Array.from(trElement.cells).reduce(function (cols, cell) {\n    return cols + cell.colSpan;\n  }, 0) - (hasRowHeaders ? 1 : 0);\n  var fixedRowsBottom = checkElement.tFoot && Array.from(checkElement.tFoot.rows) || [];\n  var fixedRowsTop = [];\n  var hasColHeaders = false;\n  var thRowsLen = 0;\n  var countRows = 0;\n\n  if (checkElement.tHead) {\n    var thRows = Array.from(checkElement.tHead.rows).filter(function (tr) {\n      var isDataRow = tr.querySelector('td') !== null;\n\n      if (isDataRow) {\n        fixedRowsTop.push(tr);\n      }\n\n      return !isDataRow;\n    });\n    thRowsLen = thRows.length;\n    hasColHeaders = thRowsLen > 0;\n\n    if (thRowsLen > 1) {\n      settingsObj.nestedHeaders = Array.from(thRows).reduce(function (rows, row) {\n        var headersRow = Array.from(row.cells).reduce(function (headers, header, currentIndex) {\n          if (hasRowHeaders && currentIndex === 0) {\n            return headers;\n          }\n\n          var colspan = header.colSpan,\n              innerHTML = header.innerHTML;\n          var nextHeader = colspan > 1 ? {\n            label: innerHTML,\n            colspan: colspan\n          } : innerHTML;\n          headers.push(nextHeader);\n          return headers;\n        }, []);\n        rows.push(headersRow);\n        return rows;\n      }, []);\n    } else if (hasColHeaders) {\n      settingsObj.colHeaders = Array.from(thRows[0].children).reduce(function (headers, header, index) {\n        if (hasRowHeaders && index === 0) {\n          return headers;\n        }\n\n        headers.push(header.innerHTML);\n        return headers;\n      }, []);\n    }\n  }\n\n  if (fixedRowsTop.length) {\n    settingsObj.fixedRowsTop = fixedRowsTop.length;\n  }\n\n  if (fixedRowsBottom.length) {\n    settingsObj.fixedRowsBottom = fixedRowsBottom.length;\n  }\n\n  var dataRows = [].concat(fixedRowsTop, _toConsumableArray(Array.from(checkElement.tBodies).reduce(function (sections, section) {\n    sections.push.apply(sections, _toConsumableArray(Array.from(section.rows)));\n    return sections;\n  }, [])), _toConsumableArray(fixedRowsBottom));\n  countRows = dataRows.length;\n  var dataArr = new Array(countRows);\n\n  for (var r = 0; r < countRows; r++) {\n    dataArr[r] = new Array(countCols);\n  }\n\n  var mergeCells = [];\n  var rowHeaders = [];\n\n  for (var row = 0; row < countRows; row++) {\n    var tr = dataRows[row];\n    var cells = Array.from(tr.cells);\n    var cellsLen = cells.length;\n\n    for (var cellId = 0; cellId < cellsLen; cellId++) {\n      var cell = cells[cellId];\n      var nodeName = cell.nodeName,\n          innerHTML = cell.innerHTML,\n          rowspan = cell.rowSpan,\n          colspan = cell.colSpan;\n      var col = dataArr[row].findIndex(function (value) {\n        return value === void 0;\n      });\n\n      if (nodeName === 'TD') {\n        if (rowspan > 1 || colspan > 1) {\n          for (var rstart = row; rstart < row + rowspan; rstart++) {\n            if (rstart < countRows) {\n              for (var cstart = col; cstart < col + colspan; cstart++) {\n                dataArr[rstart][cstart] = null;\n              }\n            }\n          }\n\n          var styleAttr = cell.getAttribute('style');\n          var ignoreMerge = styleAttr && styleAttr.includes('mso-ignore:colspan');\n\n          if (!ignoreMerge) {\n            mergeCells.push({\n              col: col,\n              row: row,\n              rowspan: rowspan,\n              colspan: colspan\n            });\n          }\n        }\n\n        var cellValue = '';\n\n        if (generator && /excel/gi.test(generator.content)) {\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/g, '\\x20').replace(/<br(\\s*|\\/)>[\\r\\n]?[\\x20]{0,3}/gim, '\\r\\n');\n        } else {\n          cellValue = innerHTML.replace(/<br(\\s*|\\/)>[\\r\\n]?/gim, '\\r\\n');\n        }\n\n        dataArr[row][col] = cellValue.replace(regEscapedChars, function (match) {\n          return ESCAPED_HTML_CHARS[match];\n        });\n      } else {\n        rowHeaders.push(innerHTML);\n      }\n    }\n  }\n\n  if (mergeCells.length) {\n    settingsObj.mergeCells = mergeCells;\n  }\n\n  if (rowHeaders.length) {\n    settingsObj.rowHeaders = rowHeaders;\n  }\n\n  if (dataArr.length) {\n    settingsObj.data = dataArr;\n  }\n\n  return settingsObj;\n}","map":{"version":3,"sources":["C:/xampp/htdocs/isotracker-dev/isotracker-react/node_modules/handsontable/utils/parseTable.mjs"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","isEmpty","ESCAPED_HTML_CHARS","regEscapedChars","RegExp","keys","map","key","concat","join","isHTMLTable","element","nodeName","instanceToHTML","instance","hasColumnHeaders","hasColHeaders","hasRowHeaders","coords","countRows","countCols","data","getData","apply","TABLE","THEAD","TBODY","rowModifier","columnModifier","row","isColumnHeadersRow","CELLS","column","isRowHeadersColumn","cell","getColHeader","getRowHeader","cellData","_instance$getCellMeta","getCellMeta","hidden","rowspan","colspan","attrs","push","value","replace","TR","splice","_dataToHTML","input","inputLen","result","rowData","columnsLen","columnsResult","parsedCellData","htmlToGridSettings","rootDocument","arguments","undefined","document","settingsObj","fragment","createDocumentFragment","tempElem","createElement","appendChild","checkElement","escapedAdjacentHTML","cellFragment","openingTag","match","cellValue","substring","lastIndexOf","closingTag","insertAdjacentHTML","querySelector","generator","trElement","cells","reduce","cols","colSpan","fixedRowsBottom","tFoot","rows","fixedRowsTop","thRowsLen","tHead","thRows","filter","tr","isDataRow","nestedHeaders","headersRow","headers","header","currentIndex","innerHTML","nextHeader","label","colHeaders","children","index","dataRows","tBodies","sections","section","dataArr","r","mergeCells","rowHeaders","cellsLen","cellId","rowSpan","col","findIndex","rstart","cstart","styleAttr","getAttribute","ignoreMerge","includes","content"],"mappings":"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","sourcesContent":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\r\n\r\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\r\n\r\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\r\n\r\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\r\n\r\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nimport \"core-js/modules/es.regexp.constructor.js\";\r\nimport \"core-js/modules/es.regexp.exec.js\";\r\nimport \"core-js/modules/es.regexp.to-string.js\";\r\nimport \"core-js/modules/es.array.join.js\";\r\nimport \"core-js/modules/es.array.map.js\";\r\nimport \"core-js/modules/es.object.keys.js\";\r\nimport \"core-js/modules/es.string.replace.js\";\r\nimport \"core-js/modules/es.object.to-string.js\";\r\nimport \"core-js/modules/es.array.concat.js\";\r\nimport \"core-js/modules/es.array.splice.js\";\r\nimport \"core-js/modules/es.string.match.js\";\r\nimport \"core-js/modules/es.array.last-index-of.js\";\r\nimport \"core-js/modules/es.array.reduce.js\";\r\nimport \"core-js/modules/es.array.from.js\";\r\nimport \"core-js/modules/es.string.iterator.js\";\r\nimport \"core-js/modules/es.array.filter.js\";\r\nimport \"core-js/modules/es.array.find-index.js\";\r\nimport \"core-js/modules/es.array.includes.js\";\r\nimport \"core-js/modules/es.string.includes.js\";\r\nimport \"core-js/modules/es.symbol.js\";\r\nimport \"core-js/modules/es.symbol.description.js\";\r\nimport \"core-js/modules/es.symbol.iterator.js\";\r\nimport \"core-js/modules/es.array.iterator.js\";\r\nimport \"core-js/modules/web.dom-collections.iterator.js\";\r\nimport \"core-js/modules/es.array.slice.js\";\r\nimport \"core-js/modules/es.function.name.js\";\r\nimport { isEmpty } from \"./../helpers/mixed.mjs\";\r\nvar ESCAPED_HTML_CHARS = {\r\n  '&nbsp;': '\\x20',\r\n  '&amp;': '&',\r\n  '&lt;': '<',\r\n  '&gt;': '>'\r\n};\r\nvar regEscapedChars = new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(function (key) {\r\n  return \"(\".concat(key, \")\");\r\n}).join('|'), 'gi');\r\n/**\r\n * Verifies if node is an HTMLTable element.\r\n *\r\n * @param {Node} element Node to verify if it's an HTMLTable.\r\n * @returns {boolean}\r\n */\r\n\r\nfunction isHTMLTable(element) {\r\n  return (element && element.nodeName || '') === 'TABLE';\r\n}\r\n/**\r\n * Converts Handsontable into HTMLTableElement.\r\n *\r\n * @param {Core} instance The Handsontable instance.\r\n * @returns {string} OuterHTML of the HTMLTableElement.\r\n */\r\n\r\n\r\nexport function instanceToHTML(instance) {\r\n  var hasColumnHeaders = instance.hasColHeaders();\r\n  var hasRowHeaders = instance.hasRowHeaders();\r\n  var coords = [hasColumnHeaders ? -1 : 0, hasRowHeaders ? -1 : 0, instance.countRows() - 1, instance.countCols() - 1];\r\n  var data = instance.getData.apply(instance, coords);\r\n  var countRows = data.length;\r\n  var countCols = countRows > 0 ? data[0].length : 0;\r\n  var TABLE = ['<table>', '</table>'];\r\n  var THEAD = hasColumnHeaders ? ['<thead>', '</thead>'] : [];\r\n  var TBODY = ['<tbody>', '</tbody>'];\r\n  var rowModifier = hasRowHeaders ? 1 : 0;\r\n  var columnModifier = hasColumnHeaders ? 1 : 0;\r\n\r\n  for (var row = 0; row < countRows; row += 1) {\r\n    var isColumnHeadersRow = hasColumnHeaders && row === 0;\r\n    var CELLS = [];\r\n\r\n    for (var column = 0; column < countCols; column += 1) {\r\n      var isRowHeadersColumn = !isColumnHeadersRow && hasRowHeaders && column === 0;\r\n      var cell = '';\r\n\r\n      if (isColumnHeadersRow) {\r\n        cell = \"<th>\".concat(instance.getColHeader(column - rowModifier), \"</th>\");\r\n      } else if (isRowHeadersColumn) {\r\n        cell = \"<th>\".concat(instance.getRowHeader(row - columnModifier), \"</th>\");\r\n      } else {\r\n        var cellData = data[row][column];\r\n\r\n        var _instance$getCellMeta = instance.getCellMeta(row - rowModifier, column - columnModifier),\r\n            hidden = _instance$getCellMeta.hidden,\r\n            rowspan = _instance$getCellMeta.rowspan,\r\n            colspan = _instance$getCellMeta.colspan;\r\n\r\n        if (!hidden) {\r\n          var attrs = [];\r\n\r\n          if (rowspan) {\r\n            attrs.push(\"rowspan=\\\"\".concat(rowspan, \"\\\"\"));\r\n          }\r\n\r\n          if (colspan) {\r\n            attrs.push(\"colspan=\\\"\".concat(colspan, \"\\\"\"));\r\n          }\r\n\r\n          if (isEmpty(cellData)) {\r\n            cell = \"<td \".concat(attrs.join(' '), \"></td>\");\r\n          } else {\r\n            var value = cellData.toString().replace('<', '&lt;').replace('>', '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\r\n            cell = \"<td \".concat(attrs.join(' '), \">\").concat(value, \"</td>\");\r\n          }\r\n        }\r\n      }\r\n\r\n      CELLS.push(cell);\r\n    }\r\n\r\n    var TR = ['<tr>'].concat(CELLS, ['</tr>']).join('');\r\n\r\n    if (isColumnHeadersRow) {\r\n      THEAD.splice(1, 0, TR);\r\n    } else {\r\n      TBODY.splice(-1, 0, TR);\r\n    }\r\n  }\r\n\r\n  TABLE.splice(1, 0, THEAD.join(''), TBODY.join(''));\r\n  return TABLE.join('');\r\n}\r\n/**\r\n * Converts 2D array into HTMLTableElement.\r\n *\r\n * @param {Array} input Input array which will be converted to HTMLTable.\r\n * @returns {string} OuterHTML of the HTMLTableElement.\r\n */\r\n// eslint-disable-next-line no-restricted-globals\r\n\r\nexport function _dataToHTML(input) {\r\n  var inputLen = input.length;\r\n  var result = ['<table>'];\r\n\r\n  for (var row = 0; row < inputLen; row += 1) {\r\n    var rowData = input[row];\r\n    var columnsLen = rowData.length;\r\n    var columnsResult = [];\r\n\r\n    if (row === 0) {\r\n      result.push('<tbody>');\r\n    }\r\n\r\n    for (var column = 0; column < columnsLen; column += 1) {\r\n      var cellData = rowData[column];\r\n      var parsedCellData = isEmpty(cellData) ? '' : cellData.toString().replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\r\n      columnsResult.push(\"<td>\".concat(parsedCellData, \"</td>\"));\r\n    }\r\n\r\n    result.push.apply(result, ['<tr>'].concat(columnsResult, ['</tr>']));\r\n\r\n    if (row + 1 === inputLen) {\r\n      result.push('</tbody>');\r\n    }\r\n  }\r\n\r\n  result.push('</table>');\r\n  return result.join('');\r\n}\r\n/**\r\n * Converts HTMLTable or string into Handsontable configuration object.\r\n *\r\n * @param {Element|string} element Node element which should contain `<table>...</table>`.\r\n * @param {Document} [rootDocument] The document window owner.\r\n * @returns {object} Return configuration object. Contains keys as DefaultSettings.\r\n */\r\n// eslint-disable-next-line no-restricted-globals\r\n\r\nexport function htmlToGridSettings(element) {\r\n  var rootDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\r\n  var settingsObj = {};\r\n  var fragment = rootDocument.createDocumentFragment();\r\n  var tempElem = rootDocument.createElement('div');\r\n  fragment.appendChild(tempElem);\r\n  var checkElement = element;\r\n\r\n  if (typeof checkElement === 'string') {\r\n    var escapedAdjacentHTML = checkElement.replace(/<td\\b[^>]*?>([\\s\\S]*?)<\\/\\s*td>/g, function (cellFragment) {\r\n      var openingTag = cellFragment.match(/<td\\b[^>]*?>/g)[0];\r\n      var cellValue = cellFragment.substring(openingTag.length, cellFragment.lastIndexOf('<')).replace(/(<(?!br)([^>]+)>)/gi, '');\r\n      var closingTag = '</td>';\r\n      return \"\".concat(openingTag).concat(cellValue).concat(closingTag);\r\n    });\r\n    tempElem.insertAdjacentHTML('afterbegin', \"\".concat(escapedAdjacentHTML));\r\n    checkElement = tempElem.querySelector('table');\r\n  }\r\n\r\n  if (!checkElement || !isHTMLTable(checkElement)) {\r\n    return;\r\n  }\r\n\r\n  var generator = tempElem.querySelector('meta[name$=\"enerator\"]');\r\n  var hasRowHeaders = checkElement.querySelector('tbody th') !== null;\r\n  var trElement = checkElement.querySelector('tr');\r\n  var countCols = !trElement ? 0 : Array.from(trElement.cells).reduce(function (cols, cell) {\r\n    return cols + cell.colSpan;\r\n  }, 0) - (hasRowHeaders ? 1 : 0);\r\n  var fixedRowsBottom = checkElement.tFoot && Array.from(checkElement.tFoot.rows) || [];\r\n  var fixedRowsTop = [];\r\n  var hasColHeaders = false;\r\n  var thRowsLen = 0;\r\n  var countRows = 0;\r\n\r\n  if (checkElement.tHead) {\r\n    var thRows = Array.from(checkElement.tHead.rows).filter(function (tr) {\r\n      var isDataRow = tr.querySelector('td') !== null;\r\n\r\n      if (isDataRow) {\r\n        fixedRowsTop.push(tr);\r\n      }\r\n\r\n      return !isDataRow;\r\n    });\r\n    thRowsLen = thRows.length;\r\n    hasColHeaders = thRowsLen > 0;\r\n\r\n    if (thRowsLen > 1) {\r\n      settingsObj.nestedHeaders = Array.from(thRows).reduce(function (rows, row) {\r\n        var headersRow = Array.from(row.cells).reduce(function (headers, header, currentIndex) {\r\n          if (hasRowHeaders && currentIndex === 0) {\r\n            return headers;\r\n          }\r\n\r\n          var colspan = header.colSpan,\r\n              innerHTML = header.innerHTML;\r\n          var nextHeader = colspan > 1 ? {\r\n            label: innerHTML,\r\n            colspan: colspan\r\n          } : innerHTML;\r\n          headers.push(nextHeader);\r\n          return headers;\r\n        }, []);\r\n        rows.push(headersRow);\r\n        return rows;\r\n      }, []);\r\n    } else if (hasColHeaders) {\r\n      settingsObj.colHeaders = Array.from(thRows[0].children).reduce(function (headers, header, index) {\r\n        if (hasRowHeaders && index === 0) {\r\n          return headers;\r\n        }\r\n\r\n        headers.push(header.innerHTML);\r\n        return headers;\r\n      }, []);\r\n    }\r\n  }\r\n\r\n  if (fixedRowsTop.length) {\r\n    settingsObj.fixedRowsTop = fixedRowsTop.length;\r\n  }\r\n\r\n  if (fixedRowsBottom.length) {\r\n    settingsObj.fixedRowsBottom = fixedRowsBottom.length;\r\n  }\r\n\r\n  var dataRows = [].concat(fixedRowsTop, _toConsumableArray(Array.from(checkElement.tBodies).reduce(function (sections, section) {\r\n    sections.push.apply(sections, _toConsumableArray(Array.from(section.rows)));\r\n    return sections;\r\n  }, [])), _toConsumableArray(fixedRowsBottom));\r\n  countRows = dataRows.length;\r\n  var dataArr = new Array(countRows);\r\n\r\n  for (var r = 0; r < countRows; r++) {\r\n    dataArr[r] = new Array(countCols);\r\n  }\r\n\r\n  var mergeCells = [];\r\n  var rowHeaders = [];\r\n\r\n  for (var row = 0; row < countRows; row++) {\r\n    var tr = dataRows[row];\r\n    var cells = Array.from(tr.cells);\r\n    var cellsLen = cells.length;\r\n\r\n    for (var cellId = 0; cellId < cellsLen; cellId++) {\r\n      var cell = cells[cellId];\r\n      var nodeName = cell.nodeName,\r\n          innerHTML = cell.innerHTML,\r\n          rowspan = cell.rowSpan,\r\n          colspan = cell.colSpan;\r\n      var col = dataArr[row].findIndex(function (value) {\r\n        return value === void 0;\r\n      });\r\n\r\n      if (nodeName === 'TD') {\r\n        if (rowspan > 1 || colspan > 1) {\r\n          for (var rstart = row; rstart < row + rowspan; rstart++) {\r\n            if (rstart < countRows) {\r\n              for (var cstart = col; cstart < col + colspan; cstart++) {\r\n                dataArr[rstart][cstart] = null;\r\n              }\r\n            }\r\n          }\r\n\r\n          var styleAttr = cell.getAttribute('style');\r\n          var ignoreMerge = styleAttr && styleAttr.includes('mso-ignore:colspan');\r\n\r\n          if (!ignoreMerge) {\r\n            mergeCells.push({\r\n              col: col,\r\n              row: row,\r\n              rowspan: rowspan,\r\n              colspan: colspan\r\n            });\r\n          }\r\n        }\r\n\r\n        var cellValue = '';\r\n\r\n        if (generator && /excel/gi.test(generator.content)) {\r\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/g, '\\x20').replace(/<br(\\s*|\\/)>[\\r\\n]?[\\x20]{0,3}/gim, '\\r\\n');\r\n        } else {\r\n          cellValue = innerHTML.replace(/<br(\\s*|\\/)>[\\r\\n]?/gim, '\\r\\n');\r\n        }\r\n\r\n        dataArr[row][col] = cellValue.replace(regEscapedChars, function (match) {\r\n          return ESCAPED_HTML_CHARS[match];\r\n        });\r\n      } else {\r\n        rowHeaders.push(innerHTML);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (mergeCells.length) {\r\n    settingsObj.mergeCells = mergeCells;\r\n  }\r\n\r\n  if (rowHeaders.length) {\r\n    settingsObj.rowHeaders = rowHeaders;\r\n  }\r\n\r\n  if (dataArr.length) {\r\n    settingsObj.data = dataArr;\r\n  }\r\n\r\n  return settingsObj;\r\n}"]},"metadata":{},"sourceType":"module"}